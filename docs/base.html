<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 3 Le basi | Un viaggio nell’ambiente R</title>
  <meta name="description" content="Capitolo 3 Le basi | Un viaggio nell’ambiente R" />
  <meta name="generator" content="bookdown 0.21.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 3 Le basi | Un viaggio nell’ambiente R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 3 Le basi | Un viaggio nell’ambiente R" />
  
  
  



<meta name="date" content="2021-04-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Autori.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prefazione</a></li>
<li class="chapter" data-level="2" data-path="Autori.html"><a href="Autori.html"><i class="fa fa-check"></i><b>2</b> Gli autori</a></li>
<li class="chapter" data-level="3" data-path="base.html"><a href="base.html"><i class="fa fa-check"></i><b>3</b> Le basi</a><ul>
<li class="chapter" data-level="3.1" data-path="base.html"><a href="base.html#R"><i class="fa fa-check"></i><b>3.1</b> Che cosa è l’ambiente R</a></li>
<li class="chapter" data-level="3.2" data-path="base.html"><a href="base.html#Russo"><i class="fa fa-check"></i><b>3.2</b> A cosa serve/non serve R</a></li>
<li class="chapter" data-level="3.3" data-path="base.html"><a href="base.html#WYSIWYM"><i class="fa fa-check"></i><b>3.3</b> “What You See Is What You Mean”: dallo Script al terminale (e viceversa)</a></li>
<li class="chapter" data-level="3.4" data-path="base.html"><a href="base.html#Espressioni"><i class="fa fa-check"></i><b>3.4</b> Le Espressioni</a></li>
<li class="chapter" data-level="3.5" data-path="base.html"><a href="base.html#Assegnazioni"><i class="fa fa-check"></i><b>3.5</b> Le Assegnazioni</a></li>
<li class="chapter" data-level="3.6" data-path="base.html"><a href="base.html#SintassiI"><i class="fa fa-check"></i><b>3.6</b> Sintassi di base (I): l’uso delle parentesi</a><ul>
<li class="chapter" data-level="3.6.1" data-path="base.html"><a href="base.html#le-parentesi-tonde"><i class="fa fa-check"></i><b>3.6.1</b> Le parentesi <strong>tonde</strong></a></li>
<li class="chapter" data-level="3.6.2" data-path="base.html"><a href="base.html#le-parentesi-quadre"><i class="fa fa-check"></i><b>3.6.2</b> Le parentesi <strong>quadre</strong></a></li>
<li class="chapter" data-level="3.6.3" data-path="base.html"><a href="base.html#le-parentesi-graffe"><i class="fa fa-check"></i><b>3.6.3</b> Le parentesi <strong>graffe</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="base.html"><a href="base.html#TipiDati"><i class="fa fa-check"></i><b>3.7</b> Tipologie di dati: gli attributi e le classi</a></li>
<li class="chapter" data-level="3.8" data-path="base.html"><a href="base.html#StruttureDati"><i class="fa fa-check"></i><b>3.8</b> Strutture di dati</a><ul>
<li class="chapter" data-level="3.8.1" data-path="base.html"><a href="base.html#vettori"><i class="fa fa-check"></i><b>3.8.1</b> Vettori</a></li>
<li class="chapter" data-level="3.8.2" data-path="base.html"><a href="base.html#matrici-e-array"><i class="fa fa-check"></i><b>3.8.2</b> Matrici (e Array)</a></li>
<li class="chapter" data-level="3.8.3" data-path="base.html"><a href="base.html#liste"><i class="fa fa-check"></i><b>3.8.3</b> Liste</a></li>
<li class="chapter" data-level="3.8.4" data-path="base.html"><a href="base.html#data-frame"><i class="fa fa-check"></i><b>3.8.4</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="base.html"><a href="base.html#Funzioni"><i class="fa fa-check"></i><b>3.9</b> Sintassi di base (II): le funzioni</a></li>
<li class="chapter" data-level="3.10" data-path="base.html"><a href="base.html#Calcolo"><i class="fa fa-check"></i><b>3.10</b> La frontiera del calcolo: NA e NaN</a></li>
<li class="chapter" data-level="3.11" data-path="base.html"><a href="base.html#Boole"><i class="fa fa-check"></i><b>3.11</b> Operatori relazionali e algebra di Boole</a></li>
<li class="chapter" data-level="3.12" data-path="base.html"><a href="base.html#luso-dellhelp"><i class="fa fa-check"></i><b>3.12</b> L’uso dell’Help</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un viaggio nell’ambiente R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="base" class="section level1">
<h1><span class="header-section-number">Capitolo 3</span> Le basi</h1>
<div id="R" class="section level2">
<h2><span class="header-section-number">3.1</span> Che cosa è l’ambiente R</h2>
<p>R è un ambiente di programmazione. Parafrasando Morpheus che sfida Neo nella palestra virtuale di “Struttura”, diremo che l’ambiente R ha le sue (poche) regole, e che conoscerle rappresenta il primo passo per impadronirsi di questo strumento (e aggirare o infrangere le sue regole).
In questa sezione saranno introdotte alcune nozioni generali che, spesso, sono date per scontate e quindi non chiaramente delineate. Nella nostra esperienza, dare per scontati questi concetti rende ostica il primo impatto con R e la prima fase dell’apprendimento, durante la quale la comprensione della sintassi e delle strutture è ancora faticoso per il nuovo utente.
Al contrario, se resi comprensibili e chiari, i capisaldi della sintassi possono essere dei punti di riferimento quando guardiamo un codice scritto da altri o da noi stessi un pò di tempo fa… E dunque questa parte del testo è concepita per illustrare le poche, chiare e strutture (simboli e oggetti) e regole generali che sono alla base delle procedure nell’ambiente R.<br />
Dunque impareremo la differenza sostanziale tra una <strong>espressione</strong> ed una <strong>assegnazione</strong>, l’utilizzo delle <strong>parentesi</strong> e le diverse tipologie di <strong>oggetti</strong> di base.<br />
Successivamente, imparemo a comporre dei semplici codici per apprendere come espressioni, assegnazioni, e oggetti possono interagire. Nel farlo, cercheremo subito di introdurre delle <strong>norme di stile</strong> e delle <strong>buone pratiche</strong> che ci aiuteranno a essere più ordinati, efficienti ed efficaci.</p>
<p>R è un ambiente per <em>Object-oriented programming</em>, cioè uno stile di programmazione diventato molto popolare negli ultimi anni. Questo stile si basa sull’utilizzo (la manipolazione mediante comandi) di <strong>oggetti</strong>, un approccio che rende molto semplice accedere (leggere e scrivere) ai dati in memoria e combinarli in strutture molto complesse.
Aspetti fondamentali dei lunguaggi <em>object-oriented</em> sono il concetto di <strong>classe</strong> e quello di <strong>metodo</strong>, sui quali torneremo in seguito in maniera approfondita.</p>
<p><strong>Classi</strong> e <strong>Metodi</strong> sono legati dal fatto che, in R, la computazione si basa sull’applicazione di specifici metodi a oggetti di specifiche classi. Non esiste una corrispondenza biunivoca tra classi e metodi, piuttosto molti metodi possono essere applicati a oggetti di classi diverse e viceversa. Tuttavia, metodi diversi sono generalmente specializzati per essere applicati su specifiche classi di oggetti. Questa associazione metodi-classi è spesso molto intuitiva, ma esistono funzioni generiche per determinare di che classe sia un dato oggetto e quali siano i metodi su di esso applicabili.</p>
<p>Un altro aspetto importante dei lunguaggi <em>object-oriented</em> è quello di <em>inheritance</em> (eredità). Questo aspetto può essere sintetizzato come la capacità degli oggetti generati durante l’esecuzione di un codice o di una procedura di calcolo di “portarsi appresso” le caratteristiche degli oggetti “genitori”, cioè quelli a partire dai quali sono stati generati. Un banalissimo esempio intuitivo è il seguente: se definisco due quantità numeriche <em>a</em> e <em>b</em> e le sommo, quello che ottengo (<em>c</em>) erediterà le caratteristiche dei genitori (numerici entrambi) e potrà essere trattato come tale. Questo aspetto semplifica enormemente il lavoro poichè, a differenza di quanto avviene in linguaggi di base, non è necessario pre-definire l’oggetto <em>c</em> indicandone esplicitamente le caratteristiche e poi riempirlo.</p>
<p>Continuando l’elenco dei grandi vantaggi di R, dobbiamo sicuramente menzionare la sua enorme <em>Community</em>. Secondo la compagnia di analisi del software <a href="https://www.tiobe.com/tiobe-index/">TIOBE</a>, l’ambiente R è attualemnte al 9° posto tra i linguaggi più popolari ma, soprattutto, è quello che continua a crescere al ritmo più sostenuto.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="base.html#cb1-1"></a>TIOBE &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Name =</span> <span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;Java&quot;</span>, <span class="st">&quot;Python&quot;</span>, <span class="st">&quot;C++&quot;</span>, <span class="st">&quot;C#&quot;</span>, <span class="st">&quot;Visual Basic&quot;</span>, <span class="st">&quot;Java Script&quot;</span>, <span class="st">&quot;R&quot;</span>,</span>
<span id="cb1-2"><a href="base.html#cb1-2"></a>                             <span class="st">&quot;PHP&quot;</span>, <span class="st">&quot;SQL&quot;</span>, <span class="st">&quot;Go&quot;</span>, <span class="st">&quot;Swift&quot;</span>, <span class="st">&quot;Pearl&quot;</span>, <span class="st">&quot;Assembly language&quot;</span>, <span class="st">&quot;Ruby&quot;</span>,</span>
<span id="cb1-3"><a href="base.html#cb1-3"></a>                             <span class="st">&quot;MATLAB&quot;</span>, <span class="st">&quot;Classic Visual Basic&quot;</span>, <span class="st">&quot;Groovy&quot;</span>, <span class="st">&quot;Objective-C&quot;</span>, <span class="st">&quot;Rust&quot;</span>),</span>
<span id="cb1-4"><a href="base.html#cb1-4"></a>                    <span class="dt">Ratings =</span> <span class="kw">c</span>(<span class="fl">16.98</span>, <span class="fl">14.43</span>, <span class="fl">9.69</span>, <span class="fl">6.84</span>, <span class="fl">4.68</span>, <span class="fl">4.66</span>, <span class="fl">2.87</span>, <span class="fl">2.79</span>, <span class="fl">2.24</span>, <span class="fl">1.46</span>, <span class="fl">1.43</span>, <span class="fl">1.42</span>, <span class="fl">1.11</span>, <span class="fl">1.04</span>, <span class="fl">1.03</span>, <span class="fl">0.86</span>, <span class="fl">0.82</span>, <span class="fl">0.77</span>, <span class="fl">0.76</span>, <span class="fl">0.74</span>),</span>
<span id="cb1-5"><a href="base.html#cb1-5"></a>                    <span class="dt">Change =</span> <span class="kw">c</span>(<span class="fl">1.83</span>, <span class="fl">-1.60</span>, <span class="fl">-0.33</span>, <span class="fl">0.78</span>, <span class="fl">0.83</span>, <span class="fl">0.97</span>, <span class="fl">0.62</span>, <span class="fl">1.97</span>, <span class="fl">0.17</span>, <span class="fl">-0.17</span>, <span class="fl">0.45</span>, <span class="fl">0.53</span>, <span class="fl">0.25</span>, <span class="fl">-0.07</span>, <span class="fl">-0.28</span>, <span class="fl">-0.41</span>, <span class="fl">-0.20</span>, <span class="fl">-0.46</span>, <span class="fl">-0.93</span>, <span class="fl">0.29</span>))</span>
<span id="cb1-6"><a href="base.html#cb1-6"></a></span>
<span id="cb1-7"><a href="base.html#cb1-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb1-8"><a href="base.html#cb1-8"></a>  <span class="kw">head</span>(TIOBE, <span class="kw">nrow</span>(TIOBE)), <span class="dt">caption =</span> <span class="st">&#39;TIOBE Index for August 2020&#39;</span>,</span>
<span id="cb1-9"><a href="base.html#cb1-9"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb1-10"><a href="base.html#cb1-10"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 3.1: </span>TIOBE Index for August 2020</caption>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="right">Ratings</th>
<th align="right">Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">C</td>
<td align="right">16.98</td>
<td align="right">1.83</td>
</tr>
<tr class="even">
<td align="left">Java</td>
<td align="right">14.43</td>
<td align="right">-1.60</td>
</tr>
<tr class="odd">
<td align="left">Python</td>
<td align="right">9.69</td>
<td align="right">-0.33</td>
</tr>
<tr class="even">
<td align="left">C++</td>
<td align="right">6.84</td>
<td align="right">0.78</td>
</tr>
<tr class="odd">
<td align="left">C#</td>
<td align="right">4.68</td>
<td align="right">0.83</td>
</tr>
<tr class="even">
<td align="left">Visual Basic</td>
<td align="right">4.66</td>
<td align="right">0.97</td>
</tr>
<tr class="odd">
<td align="left">Java Script</td>
<td align="right">2.87</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="right">2.79</td>
<td align="right">1.97</td>
</tr>
<tr class="odd">
<td align="left">PHP</td>
<td align="right">2.24</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">SQL</td>
<td align="right">1.46</td>
<td align="right">-0.17</td>
</tr>
<tr class="odd">
<td align="left">Go</td>
<td align="right">1.43</td>
<td align="right">0.45</td>
</tr>
<tr class="even">
<td align="left">Swift</td>
<td align="right">1.42</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">Pearl</td>
<td align="right">1.11</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">Assembly language</td>
<td align="right">1.04</td>
<td align="right">-0.07</td>
</tr>
<tr class="odd">
<td align="left">Ruby</td>
<td align="right">1.03</td>
<td align="right">-0.28</td>
</tr>
<tr class="even">
<td align="left">MATLAB</td>
<td align="right">0.86</td>
<td align="right">-0.41</td>
</tr>
<tr class="odd">
<td align="left">Classic Visual Basic</td>
<td align="right">0.82</td>
<td align="right">-0.20</td>
</tr>
<tr class="even">
<td align="left">Groovy</td>
<td align="right">0.77</td>
<td align="right">-0.46</td>
</tr>
<tr class="odd">
<td align="left">Objective-C</td>
<td align="right">0.76</td>
<td align="right">-0.93</td>
</tr>
<tr class="even">
<td align="left">Rust</td>
<td align="right">0.74</td>
<td align="right">0.29</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="base.html#cb2-1"></a><span class="kw">par</span>(<span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb2-2"><a href="base.html#cb2-2"></a><span class="kw">barplot</span>(TIOBE<span class="op">$</span>Ratings[<span class="kw">order</span>(TIOBE<span class="op">$</span>Ratings, <span class="dt">decreasing =</span> F)], </span>
<span id="cb2-3"><a href="base.html#cb2-3"></a>        <span class="dt">names.arg =</span> TIOBE<span class="op">$</span>Name[<span class="kw">order</span>(TIOBE<span class="op">$</span>Ratings, <span class="dt">decreasing =</span> F)], </span>
<span id="cb2-4"><a href="base.html#cb2-4"></a>        <span class="dt">xlab =</span> <span class="st">&quot;Ratings (%)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb2-5"><a href="base.html#cb2-5"></a>        <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;grey&quot;</span>,<span class="dv">12</span>),<span class="st">&quot;blue&quot;</span>,<span class="kw">rep</span>(<span class="st">&quot;grey&quot;</span>,<span class="dv">7</span>)), <span class="dt">horiz =</span> T)</span></code></pre></div>
<p><img src="01-base_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Questo dato è ancora più significativo se si considera che R non è esattamente un ambiente per produrre software compilato e quindi eseguibili (come avviene invece con i membri della famiglia <strong>C</strong>).
Perchè questo aspetto è così importante? Semplicemente perchè, essendo R un ambiente “libero”, ogni utente può attingere a una sterminata banca dati di dati, algoritmi, pacchetti e funzioni già sviluppati da altri utenti… e spesso può contare sull’aiuto diretto di altri utenti. In ambito scientifico, R ha avuto (e continua ad avere) una diffusione inarrestabile perchè incarna perfettamente alcuni ideali della ricerca: la possibilità di sviluppare metodologie completamente replicabili, chiare e ulteriormente implementabili.
Come ha giustamente argomentato <a href="https://ropensci.org/blog/2017/06/23/community/">qui</a> Shannon Ellis, una <em>community</em> ampia offre sviluppatori, esperti, collaboratori potenziali, estensori di documentazione, persone che mettono alla prova le nostre routine, “agitatori” (che sono sempre utili per tenere viva la <em>community</em>!) o semplicemente persone gentili che sono disposte ad aiutare i neofiti. Ma, soprattutto, qualsiasi sia la sfida con la quale siete alle prese, molto probabilmente qualcuno ci si è già cimentato e potrete ripartire dal suo lavoro. Non è forse, questo, un enorme vantaggio?
Shannon Ellis ha compilato una <a href="https://ropensci.org/blog/2017/06/23/community/">lista di siti/blog</a> che rappresentano i principali canali web della
<em>community</em> di R. I principali sono:</p>
<ul>
<li><a href="https://blog.revolutionanalytics.com/local-r-groups.html"><strong>(Revolution) Local R meetup groups</strong></a> - un motore di ricerca che aiuta a trovare riferimenti nella propria area di interesse (per salire sulla spalle dei giganti);</li>
<li><a href="https://rweekly.org/"><strong>Rweekly</strong></a> - un magazine settimanale di quello che succede nel mondo di R;</li>
<li><a href="https://www.r-bloggers.com/"><strong>R-bloggers</strong></a> - un archivio di post utili fatti tra utenti di R;</li>
<li><a href="https://stackoverflow.com/"><strong>Stack Overflow</strong></a> - dove cercare risposte alle nostre domande, spesso legate alle difficoltà dei neofiti (ma non solo)</li>
</ul>
<p>Una bella e completa descrizione di cosa sia R la trovate <a href="https://www.performancetrading.it/Documents/VrRAmbiente/VrR_software_R.htm">qui</a>. In sintesi:</p>
<ul>
<li>R è un ambiente integrato e coerente per l’analisi statistica;</li>
<li>R è contemporaneamente un linguaggio ed un software;</li>
<li>R è un potente strumento per la produzione di grafici (originali);</li>
<li>R è distribuito gratuitamente sotto i vincoli della <a href="https://it.wikipedia.org/wiki/GNU_General_Public_License"><strong>GPL - General Public License</strong></a> ed è disponibile per diverse architetture hardware e sistemi operativi: Unix, Linux, Windows, MacOS.</li>
<li>R è disponibile presso il sito <a href="http://www.r-project.org"><strong>The R Project for Statistical Computing</strong></a> dove è possibile scaricare, oltre che il programma base, anche una serie di moduli aggiuntivi e un’ampia manualistica (in lingua inglese) sull’ambiente che va dall’installazione del software al suo utilizzo nell’analisi dei dati;</li>
<li>il sorgente di R è scritto parte nel linguaggio C e parte nel linguaggio Fortran.</li>
</ul>
<hr />
</div>
<div id="Russo" class="section level2">
<h2><span class="header-section-number">3.2</span> A cosa serve/non serve R</h2>
<p>R non è una panacea, e anche gli appassionati di questo strumento devono essere a conoscenza dei suoi difetti quanto dei suoi pregi. Da una parte, R si comporta come gli smartphone (un nuovo tipo di <em>device</em> che, dalla sua comparsa sul mercato, ha completamente “assorbito” e messo fuori dal mercato altri <em>device</em> come i lettori mp3, le fotocamere, i navigatori satellitari). Infatti chi usa R può facilmente rinunciare a fogli di calcolo, software proprietari per la statistica, gestori di database, piattaforme per la geostatistica, software per l’analisi e la manipolazione di immagini, e la lista potrebbe continuare.
R può servire praticamente a tutto!
Un altro grande vantaggio di R è che, essendo un software opensource, si può accedere al codice sorgente e modificarlo (<a href="https://it.wikipedia.org/wiki/Linus_Torvalds">Linux Torvalds</a> docet).
R è praticamente gratuito e quindi di grande valore per particolari categorie di utenti che non possono permettersi costosi software per analisi statistiche come gli studenti oppure gli utilizzatori e i ricercatori dei Paesi in via di sviluppo.
R possiede un’ampia biblioteca di manuali e dispense (come questa!) accessibili gratuitamente in rete, oltre a pubblicazioni a pagamento.
L’installazione base di R può essere integrata con librerie di funzioni addizionali (il vero valore aggiunto per il mondo della ricerca) che ne ampliano a dismisura le capacità.
R offre un supporto tramite l’<a href="https://www.r-project.org/help.html">R Development Core Team</a>.
Infine, R sa “parlare” con altri linguaggi, da C a SQL a fortran e Python, per cui si possono integrare metodi e funzioni sviluppate in altri contesti.
Per essere proprio completi, è importante ricordare che.</p>
<ul>
<li>R ha una quantità veramente incredibile di funzioni grafiche che consentono di ottenere grafici estremamente efficaci dal punto di vista scientifico ma anche “belli”</li>
<li>R permette di essere creartivi ed efficienti, poichè consente di scrivere nuove funzioni o intere librerie in maniera molto semplice</li>
<li>La sua versione base è molto snella, ed essendo sviluppato secondo una logica vettoriale lavora molto bene su vettori e matrici</li>
</ul>
<p>E le brutte notizie?</p>
<p>Beh…</p>
<ul>
<li>R è brutto: la sua interfaccia non è pensata per essere bella e accattivante come gli OS ai quali siamo abituati. L’ interfaccia utente a carattere (CUI) di R è anche “ostico”, poichè ci costringe a cambiare modo di lavorare. E’ vero che è presente anche un’interfaccia GUI (Graphical User Interface), ma gli utenti esperti non la usano quasi mai;</li>
<li>R è un elefante: la sua velocità di calcolo è di gran lunga inferiore a quelle di ambienti e linguacci di livello più basso (come la famiglia C o Visual Basic). Questo, a volte, costringe gli utenti più esperti a compilare delle funzioni in C tutte le volte che le loro analisi diventano <em>computational and time demanding</em>;</li>
<li>Non tutte le funzioni di R sono ottimizzate per avere elevate prestazioni (un buon esempio sono le funzioni di ottimizzazione numerica). Se lavorate in un settore di frontiera della ricerca, potreste essere costretti a metterci del vostro per sviluppare funzioni nuove o più performanti;</li>
<li>Se sviluppate un’applicazione basata su R, è vostro onere tutto quello che rigarda il <em>debug</em> e il mantenimento: se salta fuori un problema, non potete prendervela con nessun altro!</li>
</ul>
<hr />
</div>
<div id="WYSIWYM" class="section level2">
<h2><span class="header-section-number">3.3</span> “What You See Is What You Mean”: dallo Script al terminale (e viceversa)</h2>
<p>Per affrontare la prima parte, dedicata a una carrellata degli aspetti base (concettuali e di sintassi) dell’ambiente R, è necessario assimilare alcuni termini (e strumenti):
Il <strong>terminale</strong> (detto <em>console</em> in inglese, così come è denominata la sua finestra nell’interfaccia di R studio), è l’ <strong>interfaccia</strong> attraverso il quale l’utente interagisce con R.</p>
<p><img src="Images/Sudo.png" /></p>
<p>Citando testualmente Wikipedia: “<em>In informatica una interfaccia a riga di comando[1] (dall’inglese command line interface, in acronimo CLI) o anche console, a volte detta semplicemente riga di comando e, impropriamente[senza fonte], prompt dei comandi, è un tipo di interfaccia utente caratterizzata da un’interazione testuale tra utente ed elaboratore (vedi shell): l’utente impartisce comandi testuali in input mediante tastiera alfanumerica e riceve risposte testuali in output dall’elaboratore mediante display o stampante alfanumerici. Nei sistemi operativi moderni usati nei personal computer, al posto della CLI, in buona parte, c’è l’interfaccia grafica con caratteristiche tipicamente user friendly</em>”.
Il primo (e forse principale) trauma al quale il neofita di R si trova di fronte è la necessità di rinunciare (possibilmente da subito e definitavamente) all’interazione tramite il mouse e quindi le interfacce a finestre e menù a tendina che tanto ci sono familiari e rispetto alle quali abbiamo sviluppato una certa dipendenza! Quando si comincia a usare R, bisogna accettare di inserire i comandi digitandoli direttamente nel terminale o predisponendoli in uno script (una sequenza di comandi annotata da qualche parte, generalmente in un editor di testo o in una apposita finestra di R studio).
Ci sono due motivi principali per questo:
1. Sarebbe impossibile codificare tutti i possibili comandi di R in un menù grafico o a tendina, senza considerare che questo limiterebbe comunque l’originalità degli utenti e renderebbe assai complesso combinare insieme varie funzioni;
2. Imparare a usare il terminale rende il lavoro estremamente più veloce (provare per credere). Questo secondo aspetto accomuna R a tanti altri ambienti di alto livello e persino a sistemi operativi come Ubuntu e Debian (due delle principali distribuzioni di Linux).
Per utilizzare il terminale, però, non basta conoscere la sintassi dei comandi: bisogna cambiare filosofia. Quando utilizziamo un elaboratore di testo, digitiamo i caratteri sapendo che esiste una precisa corrispondenza tra i tasti che premiamo e il risultato che apparirà sullo schermo.
Questo modo di operare viene denominaro What You See Is What You Get (“quello che vedi è quello che è” o “ottieni quanto vedi” - acronimo WYSIWYG). Utilizzare il terminale di un ambiente come R significa invece applicare la filosofia What You See Is What You Mean (letteralmente: quel che vedi è ciò che intendi; sinteticamente, vedi quanto intendi - acronimo WYSIWYM). In sostanza, le istruzioni che digitiamo non sono semplici parole sullo schermo ma implicano l’applicazione di funzioni anche complesse che, nelle intenzioni dell’utente, devono restituire un risultato di qualche tipo.
L’utilizzo di R si svolge tipicamente attraverso un continuo passaggio dall’editor di testo, dove si modica lo script, al terminale dove lo si esegue. Se poi si usano interfacce avanzate come <strong>R studio</strong><a href="https://rstudio.com/">TIOBE</a>, si può disporre di utili finestre accessorie (come quella dei grafici).
La figura seguente ci mostra una tipica schermata di <strong>R studio</strong></p>
<p><img src="Images/Rstudio.png" />
L’interfaccia di Rstudio contiene 4 finestre che sono spesso organizzate in questo modo (ma l’utente ha ampie possibilità di personalizzarle). Analizziamo questo esempio:</p>
<ul>
<li><p>In alto a sinistra c’è lo <strong>Script</strong> o gli <strong>Script</strong> se si vule gestire più procedure separate. Questa finestra è semplicemente un blocco note multipagina che consente di inviare i comandi direttamente al <strong>terminale</strong></p></li>
<li><p>In basso a sinistra ecco proprio lui, il <strong>terminale</strong>, ovvero il canale di collegamento in ingresso da noi verso R. In Rstudio, questa finestra si chiama <strong>Console</strong>. avete presente Ellen Ripley che comunica con Mother mediante un terminale? Ecco, il concetto è quello e… a volte penserete che R è antipatico quasi quanto Mother :-)</p></li>
</ul>
<p><img src="Images/mother.jpg" /></p>
<ul>
<li><p>In alto a destra c’è una finestra “composita” che racchiude <strong>Environment</strong>, all’interno del quale troveremo un elenco (con alcune caratteristiche essenziali) degli oggetti nella memoria della sessione, <strong>History</strong>, una cronologia dei comandi passati alla <strong>Console</strong>, e infine le tre sottofinestre <strong>Connections</strong>, <strong>Build</strong> e <strong>Tutorial</strong> sulle quali, per ora, possiamo sorvolare.</p></li>
<li><p>In basso a destra c’è un’altra finestra “composita” che racchiude <strong>Files</strong>, cioè l’elenco dei file nella cartella di lavoro (la directory del pc) scelta per la sessione, <strong>Plots</strong>, che conterrà le anteprime dei grafici realizzati, <strong>Packages</strong>, che è un prontuario di tutti gli help dei pacchetti installlati, <strong>Help</strong>, l’interfaccia minimale di aiuto che presto impareremo ad apprezzare, e <strong>Viewer</strong>, destinata a mostrare contenuto HTML come le applicazioni Shiny.</p></li>
</ul>
<p>Una tipica sessione di lavoro in R con Rstudio prevedere un utizzo semi-simultaneo di questi pannelli, e principalmente dello <strong>Script</strong> e del <strong>Terminale</strong> o <strong>Console</strong>.</p>
<hr />
</div>
<div id="Espressioni" class="section level2">
<h2><span class="header-section-number">3.4</span> Le Espressioni</h2>
<p>R è, prima di tutto, un ambiente per calcolo. In questo senso, possiamo vedere il terminale come una calcolatrice.
E’ possibile eseguire calcoli semplici o complessi direttamente mediante il terminale, digitando delle istruzioni analoghe alle formule algebriche, cioè utilizzando un insieme di quantità numeriche, simboli e operatori matematici, e poi premendo il tasto INVIO.
Come avviene per altri ambienti e linguaggi di programmazione, gli operatori matematici di base sono:</p>
<ul>
<li>La somma, codificata col simbolo +.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="base.html#cb3-1"></a><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<ul>
<li>La sottrazione, codificata col simbolo -.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="base.html#cb5-1"></a><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] -3</code></pre>
<ul>
<li>La moltiplicazione, codificata col simbolo *.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="base.html#cb7-1"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<ul>
<li>La divisione, codificata col simbolo /.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="base.html#cb9-1"></a><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 0.4</code></pre>
<ul>
<li>L’elevamento a potenza, codicato col simbolo ^ (ad esempio x^2 indica x elevato al quadrato).</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="base.html#cb11-1"></a><span class="dv">2</span><span class="op">^</span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<p>Esistono poi altre simbologie con un significato matematico definito, come ad esempio:</p>
<ul>
<li>Il simbolo : che serve a generare una sequenza ordinata di interi tra un minino ed un massimo definiti, come ad esempio</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="base.html#cb13-1"></a><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<ul>
<li>Il simbolo % che serve, ad esempio, per specificare il prodotto scalare invece che quello generico (vettoriale se utilizzato su vettori), come ad esempio</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="base.html#cb15-1"></a><span class="kw">c</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   85</code></pre>
<p>All’interno di R, l’utilizzo delle varie tipologie di parentesi è legato a funzionalità diverse (vedi più avanti). Per questo motivo, le parentesi ** tonde ** sono, di fatto, l’unica tipologia di parentesi che mantiene (anche) un significato matematico. Ad esempio</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="base.html#cb17-1"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Questo implica che, se esistono espressioni annidate, dovremo utilizzare sempre e solo le parentesi tonde (invece che passare alle quadre e poi alle graffe come ci hanno insegnato a scuola):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="base.html#cb19-1"></a>((<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))<span class="op">/</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 7.5</code></pre>
<p>E’ ovvio che l’utilzzo delle parentesi deve essere sempre “simmetrico” (una parentesi apre e una chiude) e coerente (i conti devono tornare e quindi ci devono essere tante parentesi aperte quanto quelle chiuse). Quando le espressioni diventano molto complesse, quindi, diventa complicato capire, a colpo d’occhio, quali sono le coppie di parentesi. Ad esempio:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="base.html#cb21-1"></a>(((<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="dv">1</span>))<span class="op">^</span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 243</code></pre>
<p>Comunque i più comuni editor per gli script, e quindi anche software più complessi e integrati come R studio, ci vengono in soccorso evidenziando le coppie di parentesi quando ci spostiamo lungo una espressione con le frecce destra e sinistra della tastiera (provare per credere!).
Le frecce in alto e in basso, invece, possono essere usate per scorrere nella cronologia dei comandi che abbiamo inserito tramite il terminale. Questo ci aiuta a non dover ri-digitare daccapo un’istruzione usata poco prima.
Possiamo digitare le espressioni, dunque, attraverso il terminale che, abbiamo già imparato, ci appare come il simbolo <strong>&gt;</strong>. Tuttavia, quando digitiamo un’espressione matematicamente incompleta (nella quale, ad esempio, manca una parentesi o un argomento legato ad un operatore), R non eseguirà il calcolo ma ci risponderà con l’operatore <strong>+</strong> che serve a farci capire che “manca qualcosa”.
E’ possibile (ma vedremo che è preferibile non farlo per non pasticciare il codice) inserire più espressioni, separate da <strong>;</strong> o <strong>.</strong> nella stessa linea di comando (prima di premere INVIO).
In ogni caso, le espressioni digitate direttamente nel terminale non vengono salvate in memoria e non possono essere usate per produrre risultati molto complessi. Tutte le volte che sono necessari più passaggi per arrivare dai dati di partenza ai risultati finali è necessario “prendere appunti”, cioè generare delle quantità intermedie e associare ad esse dei nomi. Questo è esattamente quello in cui consiste l’ <strong>assegnazione</strong>.</p>
<hr />
</div>
<div id="Assegnazioni" class="section level2">
<h2><span class="header-section-number">3.5</span> Le Assegnazioni</h2>
<p>Il risultato di una semplice espressione, come gli esempi del paragrafo precedente, viene stampato sullo schermo, cioè appare come risposta di R nel terminale, ma non viene memorizzato.
Per generare una costante, una variabile o un qualsiasi oggetto che contenga uno o più valori (che magari solo il risultato di espressioni matematiche) è necessario <strong>assegnare</strong> all’espressione un nome.
Questo è possibile farlo attraverso i comandi <strong>=</strong> e <strong>&lt;-</strong>. Ad esempio:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="base.html#cb23-1"></a>a =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb23-2"><a href="base.html#cb23-2"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span></code></pre></div>
<p>hanno lo stesso significato e producono il medesimo effetto: l’oggetto <strong>a</strong> sarà associato alla quantità 4. Perché questa ridondanza (2 simbologie per la stessa cosa)? In realtà, <strong>=</strong> e <strong>&lt;-</strong> non si comportano esattamente allo stesso modo. Per cogliere la differenza, proviamo a digitare la seguente espressione, basata sull’utilizzo della funzione <strong>sum</strong>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="base.html#cb24-1"></a><span class="kw">sum</span>(<span class="dt">a =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="base.html#cb26-1"></a>a</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Dopo che R ci avrà restituito il risultato 9, proviamo a “chiedergli” se ricorda quanto valgono a e b, ad esempio digitando <strong>a</strong> nel terminale e premendo invio. Scopriremo che R non ricorda quanto valga <strong>a</strong>!
Se invece provassimo a digitare l’espressione:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="base.html#cb28-1"></a><span class="kw">sum</span>(a &lt;-<span class="st"> </span><span class="dv">4</span>, b &lt;-<span class="st"> </span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="base.html#cb30-1"></a>a</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>e poi chiedessimo a R quanto vale <strong>a</strong> (oppure <strong>b</strong>) scopriremmo che R ha memorizzato i loro valori.
Il perchè di questa apparente stranezza sta nel fatto che l’ambiente di calcolo di R non è unico, bensì ogni funzione opera in un suo “spazio” secondario e solo le quantità assegnate con <strong>&lt;-</strong> trascendono dal sottospazio definito dalla funzione <em>sum</em> allo spazio generale attraverso il quale dialoghiamo.
Dunque, a seconda che vogliamo assegnare delle quantità “generali” o “locali” sceglieremo la simbologia corrispondente, tenendo presente che esistono delle “buona pratiche” che vedremo più avanti. Ovviamente una differenza sostanziale tra <strong>=</strong> e <strong>&lt;-</strong> sta anche nella complessità (e quindi nella velocità) delle due scritture: nel secondo caso, dovremo usare una combinazione due tasti (&lt; + -) invece che uno, e quindi l’assegnazione “generale” è più “faticosa”.
Un’ultima precisazione: le assegnazioni possono essere scritte anche da sinistra verso destra. Ad esempio le scritture:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="base.html#cb32-1"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb32-2"><a href="base.html#cb32-2"></a><span class="dv">4</span> -&gt;<span class="st"> </span>a</span></code></pre></div>
<p>sono funzionalmente equivalenti. Tuttavia si sconsiglia la seconda poichè, come chiunque può sperimentare, è molto più chiaro un algoritmo in cui gli oggetti generati nei diversi passaggi compaiono subito all’inizio di ogni riga.</p>
<hr />
</div>
<div id="SintassiI" class="section level2">
<h2><span class="header-section-number">3.6</span> Sintassi di base (I): l’uso delle parentesi</h2>
<p>Le parentesi sono dei simboli tipografici ampiamente usate sia nella lingua scritta che nella matematica. Esistono 3 tipi di parentesi, e per ognuno di essi esiste una versione di apertura delle parentesi ed una di chiusura: la prima è generalmente un’immagine dotata di convessità verso sinistra, mentre la seconda la possiede generalmente a destra. Nell’ambiente R, le parentesi sono delle strutture molto importanti usate per finalità ben precise. Per questo è fondamentale imparare ad usarle in modo appropriato ed imparare a riconoscerele all’interno di uno <em>script</em>, in modo da orientarsi in procedure complicate o istruzioni annidate.
All’interno di R, ognuna delle tre diverse tipologie di parentesi (tonde, quadre, graffe) è destinata a uno scopo preciso:</p>
<div id="le-parentesi-tonde" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Le parentesi <strong>tonde</strong></h3>
<p>Servono per specificare gli argomenti (ed eventualmente le opzioni) di una <strong>funzione</strong>. In sostanza, le parentesi tonde deliminato un micro-ambiente, parzialmente indipendente da quello generale, all’interno del quale entrano alcuni oggetti o valori (gli argomenti) e dal quale fuoriescono altri oggetti o valori (i risultati).
Può essere utile, a questo punto, fare un piccolo antipasto di come si usano le funzioni in R (torneremo estesamente più avanti sull’argomento). L’esempio seguente ci mostra il risultato dell’utilizzo della funzione <em>c</em>, una delle più semplici tra quelle di base.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="base.html#cb33-1"></a><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 5</code></pre>
<p>Il nome <em>c</em> sta per <em>concatenate</em> (concatena), e difatti questa funzione mette insieme gli <em>argomenti</em>, separati da virgole, in un singolo oggetto (in questo caso un vettore composto da 4 numeri). <strong>Le parentesi tonde seguono sempre il nome della funzione e racchiudono gli argomenti (e le opzioni, se ci sono) separati da virgole</strong>. In questo caso non abbiamo effettuato nessuna assegnazione, e il terminale di R esegue il comando restituendoci il vettore desiderato.
Un altro semplice esempio è:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="base.html#cb35-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb35-2"><a href="base.html#cb35-2"></a><span class="kw">sum</span>(a)</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>In questo caso, abbiamo generato un vettore denominato <em>a</em> e poi abbiamo applicato la funzione <em>sum</em> (somma) su di esso, ottenendo il risultato corrispondente alla somma degli elementi di <em>a</em>.
Gli argomenti di una funzione, dunque, sono i dati in ingresso, la materia prima per permettere alla funzione di lavorare e restituirci un risultato.</p>
<div class="figure">
<img src="Images/1parentesitonde.png" alt="" />
<p class="caption">Il concetto di annidamento mediante le tonde visto da <strong>Ciro Fanelli</strong></p>
</div>
</div>
<div id="le-parentesi-quadre" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Le parentesi <strong>quadre</strong></h3>
<p>Servono per <strong>indicizzare</strong> gli oggetti, cioè per identificare al loro interno delle sottoparti precise. Come all’interno di una griglia spaziale (immaginate di giocare una partita di battaglia navale), le parentesi quadre ci permettono di fare riferimento a pezzi specifici di oggetti complessi, permettendoci di manipolarli (estrarne delle parti, sostituirle, modificarle, ecc.).
Anche in questo caso si possono fare degli esempi preliminari.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="base.html#cb37-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">5</span>)</span>
<span id="cb37-2"><a href="base.html#cb37-2"></a>a[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>La scrittura precedente definisce un nuovo vettore <em>a</em> e poi, mediante l’uso delle parentesi quadre, ne identifica e isola il primo valore (in questo caso il numero 10). Naturalmente potremmo isolare, con la stessa logica, un altro elemento di <em>a</em>, per esempio il quarto.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="base.html#cb39-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">5</span>)</span>
<span id="cb39-2"><a href="base.html#cb39-2"></a>a[<span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Dovrebbe essere chiaro, quindi, che il numero che compare tra le parentesi quadre corrisponde alla posizione dell’elemento desiderato, e non al suo valore. Siccome un vettore di numeri è, per definizione, un oggetto unidimensionale, è sufficiente un singolo valore (la “posizione nella fila”) per indicare un singolo valore (come nella coda alle poste). Ma cosa accade quando abbiamo oggetti con più di una dimensione?
Per comprenderlo estendiamo gli esempi alle matrici (che sono oggetti a due dimensioni, righe e colonne). Vediamo un esempio:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="base.html#cb41-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb41-2"><a href="base.html#cb41-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="base.html#cb43-1"></a>m[<span class="dv">1</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 101</code></pre>
<p>Sorvoliamo sull’analisi degli argomenti della funzione <em>matrix</em> (i lettori più scaltri avranno intuito chela funzione la genera mettendo i valori da 101 a 109 in 3 righe e 3 colonne, come si vede dalla struttura che R stampa sullo schermo quando invochiamo <em>m</em>), e vediamo come, in questo caso, all’interno delle parentesi quadre abbiamo messo 2 numeri, 1 e 1, separati da una virgola.
R ci dice che <em>m[1,1]</em> corrisponde al numero 101, quello collocato nella prima riga e prima colonna della matrice.
Allo stesso modo potremmo identificare il numero 104 come quello nella prima riga e seconda colonna.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="base.html#cb45-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb45-2"><a href="base.html#cb45-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="base.html#cb47-1"></a>m[<span class="dv">1</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 104</code></pre>
<p>Insomma i due valori separati da virgola tra le quadre sono niente altro che le coordinate dei valori desiderati. Nel caso di un oggetto bidimensionale come una matrice, per indicare un elemento si deve ragionare come in una partita di battaglia navale!</p>
<p>Naturalmente possiamo voler isolare più di un elemento di un oggetto complesso, ad esempio:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="base.html#cb49-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb49-2"><a href="base.html#cb49-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="base.html#cb51-1"></a>n &lt;-<span class="st"> </span>m[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb51-2"><a href="base.html#cb51-2"></a>n</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  101  104
## [2,]  102  105</code></pre>
<p>In questo caso, abbiamo isolato un pezzo della matrice <em>m</em>, corrispondente alle prime 4 celle (quelle nelle prime due righe e prime due colonne) e lo abbiamo assegnato all’oggetto <em>n</em>.
Un ultimo esempio, la selezione di elementi non contingui:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="base.html#cb53-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb53-2"><a href="base.html#cb53-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="base.html#cb55-1"></a>n &lt;-<span class="st"> </span>m[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb55-2"><a href="base.html#cb55-2"></a>n</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  101  107
## [2,]  103  109</code></pre>
<p>Analizzando il codice dell’esempio, dovremmo poter capire che, all’interno delle quadre, abbiamo indicato due vettori generati con la funzione <em>c</em>. Ciascuno di essi corrisponde al vettore composto da due elementi, i numeri 1 e 3, e quindi il risultato complessivo sarà la creazione di un oggetto <em>n</em>, anch’esso una matrice, composto dagli elementi nella prima riga e terza colonna di <em>m</em>.
Torneremo sul concetto di indicizzazione, e sul suo utilizzo, man mano che prenderemo familiarietà con oggetti aventi struttura più complessa (come ad esempio le <em>liste</em> o gli <em>array</em>)</p>
<div class="figure">
<img src="Images/1parentesiquadra.png" alt="" />
<p class="caption">Il concetto di indicizzazione mediante le quadre visto da <strong>Ciro Fanelli</strong></p>
</div>
</div>
<div id="le-parentesi-graffe" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Le parentesi <strong>graffe</strong></h3>
<p>Servono principalmente a delimitare strutture precise come i <em>loop</em> (cicli). Dunque le vedremo comparire all’interno di un codice per generare e gestire delle strutture di controllo complesse come le scelte (il ciclo <em>if</em>, <em>else</em>) o iterazioni di blocchi di istruzioni (il ciclo <em>for</em>).
Un esempio è:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="base.html#cb57-1"></a>a &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-2"><a href="base.html#cb57-2"></a>b &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb57-3"><a href="base.html#cb57-3"></a>c &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb57-4"><a href="base.html#cb57-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>b){</span>
<span id="cb57-5"><a href="base.html#cb57-5"></a>  a &lt;-<span class="st"> </span>a  <span class="op">+</span><span class="st"> </span>c</span>
<span id="cb57-6"><a href="base.html#cb57-6"></a>}</span>
<span id="cb57-7"><a href="base.html#cb57-7"></a>a</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>In questo caso, abbiamo definito tre oggetti ( <em>a</em>, <em>b</em>, e <em>c</em>), e poi abbiamo usato la struttura di controllo <em>for</em> per iterare una semplice operazione: prendere <em>a</em> e sommargli <em>b</em> volte <em>c</em>.
Il risultato, intuitivo, è 10.
Le graffe servono per racchiudere il ciclo <em>for</em>.
E’ interessante notare che, manipolando i valori di <em>a</em>, <em>b</em> e <em>c</em>, si possono ottenere risultati diversi… il che è esattamente lo spirito di una struttura iterativa del genere.
Vedremo che le parentesi graffe servono anche a definire le funzioni, ma su questo torneremo più avanti.</p>
<div class="figure">
<img src="Images/1parentesigraffe.png" alt="" />
<p class="caption">Il concetto di gestione dei cicli mediante le graffe visto da <strong>Ciro Fanelli</strong></p>
</div>
<hr />
</div>
</div>
<div id="TipiDati" class="section level2">
<h2><span class="header-section-number">3.7</span> Tipologie di dati: gli attributi e le classi</h2>
<p>Tutti i linguaggi di programmazione a oggetti (ed R è uno di questi) sono basati sul fatto che blocchi di informazione detti <strong>oggetti</strong> (siano essi quantità, variabili, istruzioni, procedure complesse) siano utilizzati per accedere ad altrettanti blocchi di dati in memoria. Questa è una differenza sostaziale rispetto ad altri linguaggi come C che si basano sull’accesso <em>diretto</em> ai dati in memoria, cosa che R non consente. All’interno di R gli oggetti hanno un nome esclusivo e sono l’elemento di base su cui lavorare, qualsiasi sia la loro struttura.
Il modo in cui R immagazzina in memoria una dato oggetto è detta <strong>tipo</strong> dell’oggetto stesso.
Non è importante approfondire i diversi tipi di oggetti in R, per cui non ci dilungheremo sull’argomento.</p>
<p>Quello che, invece, è veramente importante sapere è che ogni tipo oggetto possiede una serie di <strong>attributi</strong>. Tra questi, quello che spicca per importante è la <strong>Classe</strong>.
Come abbiamo già detto in precedenza, le classi sono importanti poichè a seconda di essere variano i metodi che si possono applicare agli oggetti. A questo punto è utile chiarire che i metodi non sono altro che funzioni, e che quindi a ogni classe di oggetti possono essere applicate funzioni diverse, ovvero che una stessa funzione può avere comportamenti diversi a seconda della classe dei suoi
argomenti (cioè degli oggetti sui quali viene applicata).</p>
<p>All’interno di R è possibile operare con diverse tipologie di dati, per ognuna della quali esiste una <strong>classe</strong> predefinita. Sebbene ci siano molte classi già implementate ed altre possano essere definite dagli utenti esperti, esistono 5 classi principali di dati:</p>
<ul>
<li>La classe <strong>numeric</strong>, destinata a tutti i <strong>numeri reali</strong> (elementi dell’insieme R)</li>
<li>La classe <strong>integer</strong>, destinata a tutti i <strong>numeri interi</strong> (elementi dell’insieme N)</li>
<li>La classe <strong>character</strong>, destinata alle stringhe di testo o alle sequenze di caratteri</li>
<li>La classe <strong>logical</strong>, destinata alle espressioni nell’accezione dell’<strong>Algebra di Boole</strong></li>
<li>La classe <strong>factor</strong>, destinata a variabili o quantità qualitative o semi-quantitative</li>
</ul>
<p>E’ facile immaginare il senso delle prime due classi, poichè si riferiscono a insiemi ben noti della matematica. Anche la terza classe è intuitivamente familiare: chiunque abbia esperienza di programmazione sa cosa sono i caratteri. Per gli altri è sufficiente dire che il testo (formato da caratteri) è un tipo di informazione particolare per gli ambienti di calcolo (come R), poichè se ne possono valutare le caratteristiche (quanti caratteri ci sono in una stringa? Quante parole ci sono in un testo?) ma non ha senso applicare funzioni matematiche ai testi.
La quarta classe si riferisce agli oggetti (le espressioni, ma in un senso diverso da quello di cui abbiamo parlato in una sezione precedente a proposito di R) propri dell’Algebra di Boole, il grande matematico inglese che ha gettato le basi per la computazione elettorica.
L’ultima classe è pensata per permetterci di gestire valori semi-quantitativi o qualitativi. Si possono fare moltissimi esempi di “fattori” (<strong>variabili che possono assumere un numero finito di stati o valori</strong>): il sesso di ciascun individuo di una popolazione, il colore degli occhi di diversi individui, la classe di età (coorte) a cui appartengono, l’intensità di un trattamento farmacologico. La cosa importante da dire, in proposito, è che possono esserci fattori ordinabili e fattori non ordinabili. Un esempio del primo tipo sono il sesso o il colore degli occhi: non ha senso dire che maschio viene prima di femmina o che ci sia una scala ordinata di colori (o forse si?). Esempi di fattori ordinabili sono invece la classe di età (coorte) o l’intensità di un trattamento farmacologico: è possibile stabilire una sequenza continua di valori (es. classe di età 0, classe 1, classe 2 e così via).</p>
<p>Per ciascuna delle 5 classi esiste un comando (funzione) che serve a generare un oggetto appartenente alla classe voluta. I comandi in questione hanno lo stesso nome della classe, e quindi avremo le funzioni:</p>
<ul>
<li>numeric()</li>
<li>integer()</li>
<li>character()</li>
<li>logical()</li>
<li>factor()</li>
</ul>
<p>L’utilizzo di queste funzioni è abbastanza intuitivo. Ad esempio, la funzione <em>numeric</em> può essere utulizzata con un solo argomento ( <em>length</em>, ovvero lunghezza) per generare un vettore numerico pieno di zeri (0 è il valore di default) di dimensione desiderata.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="base.html#cb59-1"></a>a &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb59-2"><a href="base.html#cb59-2"></a>a</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<p>Lo stesso avviene per <em>integer</em>, <em>character</em>, e <em>logical</em></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="base.html#cb61-1"></a>a &lt;-<span class="st"> </span><span class="kw">integer</span>(<span class="dv">5</span>)</span>
<span id="cb61-2"><a href="base.html#cb61-2"></a>a</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<p>Nel caso di <em>integer</em> non c’è molto da dire.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="base.html#cb63-1"></a>a &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">5</span>)</span>
<span id="cb63-2"><a href="base.html#cb63-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<p>Nel caso di <em>character</em> otteniamo una sequenza di blocchi di testo vuoti.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="base.html#cb65-1"></a>a &lt;-<span class="st"> </span><span class="kw">logical</span>(<span class="dv">5</span>)</span>
<span id="cb65-2"><a href="base.html#cb65-2"></a>a</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Nel caso di <em>logical</em> otteniamo una sequenza di espressioni booleane, per definizione <em>false</em> (che è il corrispettivo di 0 nell’Algebra binaria di Boole, mentre 1 corrisponde a <em>true</em>). Una piccola trattazione dell’Algebra di Boole, così importante per la programmazione, ci aspetta più avanti.</p>
<p>Una cosa che merita di essere detta, inoltre, è che R è in grado di riconoscere automaticamente le caratteristiche di un oggetto e assegnarlo alla classe opportuna.
Proviamo a riprendere uno degli esempi precedenti e, dopo aver generato una variabile di nome <em>a</em> alla quale assegnamo valore 4, usiamo la funzione <strong>class()</strong> per chiedere a R che roba sia <em>a</em>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="base.html#cb67-1"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb67-2"><a href="base.html#cb67-2"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>In questo esempio, R ha correttamente dedotto che volessimo generare una quantità numerica. In effetti, avremmo potuto anche scegliere di assegnare <em>a</em> alla classe <em>integer</em>. Tuttavia R sceglierà sempre come default la classe <em>numeric</em> (che è un sinonimo di <em>double</em> per chi ha già familiarità con linguaggi di programmazione, e in effetti <em>double</em> è il tipo degli oggetti <em>numeric</em>, cioè il modo con cui viene archiviato in memoria) per tutti gli oggetti che contengono solo numeri.</p>
<p>E’ anche possibule definire un oggetto senza inserirne direttamente il valore, e l’esempio che segue ci permette anche di riprendere il concetto di <strong>eredità</strong> (<em>inheritance</em>).</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="base.html#cb69-1"></a>a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb69-2"><a href="base.html#cb69-2"></a>a</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="base.html#cb71-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>In questo esempio abbiamo definito la quantità <em>a</em> come la somma della radice quadrata di 9 (la funzione <em>sqrt</em> è appunto l’acronimo di square root) e del numero 2 elevato al quadrato.
Interrogato sul valore di <em>a</em> e sulla sua classe, R ci risponde che <em>a</em> vale 7 e che è un <em>numeric</em>.
R ha automaticamente calcolato il risultato e lo ha assegnato all’oggetto <em>a</em>. Inoltre, ha dedotto che <em>a</em> è un oggetto della classe <em>numeric</em>, e questo è precisamente un esempio di <em>eredità</em> della classe.</p>
<hr />
</div>
<div id="StruttureDati" class="section level2">
<h2><span class="header-section-number">3.8</span> Strutture di dati</h2>
<p>A questo punto, dopo aver visto quali sono le principali tipologie di dati che si possono gestire in R, dobbiamo comprendere in quali modi è possibile organizzarli. L’oggetto più semplice all’interno di R è il <em>vettore</em>, ma strutture di base sono anche le <strong>matrici</strong>, gli <strong>array</strong>, le <strong>liste</strong> e, infine, i <strong>data frame</strong> (che possono essere considerati degli oggetti “speciali”).</p>
<div id="vettori" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Vettori</h3>
<p>Un vettore può essere pensato come una serie di celle concatenate, ognuna delle quali contiene un valore. A ciascuna cella o elemento del vettore corrisponde un <em>indice di posizione</em> che, come nel caso dei numeri civici su una via che consentono al corriere amazon di trovare un destinatario specifico, possono essere usati per manipolare il vettore, ad esempio estraendone i valori presenti in celle precise identificate tra quadre in una indicizzazione. La cosa importante da assimilare è che <strong>un vettore può contenere elementi che appartengono tutti a una stessa classe</strong>. Questo vuol dire che R gestisce vettori di tanti tipi, i principali dei quali sono proprio i <strong>character</strong>, <strong>integer</strong>, <strong>logical</strong>, <strong>numeric</strong>…. insomma proprio le classi che abbiamo visto poco fa.
Esistono anche altri tipi di vettori, che menzioniamo senza approfondire: <strong>complex</strong> (numeri complessi), <strong>double</strong>, <strong>expression</strong>, <strong>list</strong>, <strong>single</strong>, e <strong>raw</strong>.
Generare un vettore è molto semplice, e non indicheremo due modalità alternative:</p>
<ul>
<li>Mediante la sua “funzione generatrice”. Ne esiste una per ogni tipo di vettore, e il suo nome è intuitivo. Ad esempio, per generare un vettore numeric c’è la funzione omonima <strong>numeric</strong>. Il suo utilizzo, come quello delle sue “sorelle” <strong>character</strong>, <strong>logical</strong>, <strong>integer</strong>, e <strong>factor</strong> (ma vale anche per gli altri tipi appena menzionati), è molto semplice:</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="base.html#cb73-1"></a>a &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb73-2"><a href="base.html#cb73-2"></a>a</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="base.html#cb75-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>L’argomento all’interno delle parentesi specifica la lunghezza del vettore che si vuole generare. Si noterà che, per default, R ha generato un vettore composto da 10 quantità tutte uguali a 0. Intuitivamwente, la funzione <strong>character</strong> genera una serie di stringhe di lunghezza 0 (vuote).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="base.html#cb77-1"></a>a &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">10</span>)</span>
<span id="cb77-2"><a href="base.html#cb77-2"></a>a</span></code></pre></div>
<pre><code>##  [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="base.html#cb79-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Se non lo avete già notato, le quantità character sono sempre facilmente identificabili perchè R le racchiude tra le virgolette.
In entrambi gli esempi, l’applicazione della funzione <strong>class</strong> sugli oggetti generati restituisce una risposta analoga a quelle viste nel paragrafo precedente, e naturalmente univoca perchè tutti gli elementi del vettore sono della stessa classe.</p>
<ul>
<li>Mediante la funzione <strong>c</strong>, che abbiamo già incontrato:</li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="base.html#cb81-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb81-2"><a href="base.html#cb81-2"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="base.html#cb83-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="base.html#cb85-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb85-2"><a href="base.html#cb85-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="base.html#cb87-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Noterete che nel primo caso abbiamo messo insieme (concatenato) 3 numeri per generale il vettore a, immediatamanet classificato da R come numeric. Nel secondo caso abbiamo messo insieme le prime tre lettere dell’alfabeto, ottenendo un vettore che R classifica come character.</p>
<p>Per ciascuna delle funzioni generatrici esiste una sorella “coercitrice”. Per esempio a <strong>numeric</strong> corrisponde <strong>is.numeric</strong>, così come a <strong>character</strong> corrisponde <strong>is.character</strong>.
Vediamo un esempio illuminante.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="base.html#cb89-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb89-2"><a href="base.html#cb89-2"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="base.html#cb91-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="base.html#cb93-1"></a>a &lt;-<span class="kw">as.character</span>(a)</span>
<span id="cb93-2"><a href="base.html#cb93-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="base.html#cb95-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>In questo caso abbiamo prima generato un vettore numeric e poi lo abbiamo “costretto” a diventare character. La nostra esperienza è che i neofiti di R sono spesso confusi da alcuni aspetti di queste trasformazioni, per cui vediamo cosa succede caso per caso.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="base.html#cb97-1"></a><span class="co">#Da numeric a character</span></span>
<span id="cb97-2"><a href="base.html#cb97-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb97-3"><a href="base.html#cb97-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.character</span>(a)</span>
<span id="cb97-4"><a href="base.html#cb97-4"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="base.html#cb99-1"></a><span class="co">#Da  character a numeric</span></span>
<span id="cb99-2"><a href="base.html#cb99-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)</span>
<span id="cb99-3"><a href="base.html#cb99-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span>
<span id="cb99-4"><a href="base.html#cb99-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="base.html#cb101-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb101-2"><a href="base.html#cb101-2"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span></code></pre></div>
<pre><code>## Warning: si è prodotto un NA per coercizione</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="base.html#cb103-1"></a>a</span></code></pre></div>
<pre><code>## [1] NA NA NA</code></pre>
<p>Nei primi due casi è andato tutto bene. INfatti, quando R ha <strong>coercito</strong> il vettore “1”, “2”, “3” a diventare numeric ha ottenuto dei numeri… cioè delle quantità che per lui hanno senso e possono essere gestite come tali. Ma, quando abbiamo coercito il vettore “A”, “B”, “C” a diventare numeric,
R non ha ottenuto dei valori gestibili come numeric e ha quindi generato dei valori detti <strong>NA (not assigned)</strong>. Questa è la prima volta che ci imbattiamo in loro, e dobbiamo subito sapere che la loro comparsa è indice che qualcosa nei nostri conti è andato storto. Insomma che probabilmente c’è un “errore” da qualche parte nel nostro codice. Invece:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="base.html#cb105-1"></a><span class="co">#Da character a factor</span></span>
<span id="cb105-2"><a href="base.html#cb105-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb105-3"><a href="base.html#cb105-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.factor</span>(a)</span>
<span id="cb105-4"><a href="base.html#cb105-4"></a>a</span></code></pre></div>
<pre><code>## [1] A C C
## Levels: A C</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="base.html#cb107-1"></a><span class="co">#Da numeric a factor</span></span>
<span id="cb107-2"><a href="base.html#cb107-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb107-3"><a href="base.html#cb107-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.factor</span>(a)</span>
<span id="cb107-4"><a href="base.html#cb107-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3
## Levels: 1 2 3</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="base.html#cb109-1"></a><span class="co">#Da factor a character</span></span>
<span id="cb109-2"><a href="base.html#cb109-2"></a>a &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span>
<span id="cb109-3"><a href="base.html#cb109-3"></a>a</span></code></pre></div>
<pre><code>## [1] A C C
## Levels: A B C</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="base.html#cb111-1"></a>a &lt;-<span class="st"> </span><span class="kw">as.character</span>(a)</span>
<span id="cb111-2"><a href="base.html#cb111-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;C&quot; &quot;C&quot;</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="base.html#cb113-1"></a><span class="co">#Da factor a numeric</span></span>
<span id="cb113-2"><a href="base.html#cb113-2"></a>a &lt;-<span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span>
<span id="cb113-3"><a href="base.html#cb113-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span>
<span id="cb113-4"><a href="base.html#cb113-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 3 3</code></pre>
<p>Guardiamo per bene questi esempi, anche perchè ne approfitteremo per illustrare la funzione generatrice <strong>factor</strong>.
Nel primo esempio, abbiamo definito il vettore <em>a</em> concatenando tre valori, due dei quali sono uguali tra loro, in modo da generare un vettore character che poi abbiamo coercito a diventare factor.
Poichè gli <em>univoci</em> nel vettore di partenza erano solo due (“A” e “C”), R ha automaticamente stabilito che il <em>factor a</em> contiene valori che possono assumere solo uno tra questi due possibili stati. Gli stati o valori che possono essere assunti da un factor si chiamano <strong>livelli</strong>. I livelli possono essere esplicitamente definiti mediante la funzione generatrice <em>factor</em> o possono essere “desunti” dall’analisi dei valori assunti dagli elementi di un oggetto già esistente, come avviene anche nel secondo esempio (in cui abbiamo generato un <em>numeric</em> e poi lo abbiamo trasformato in un <em>factor</em>).
Il terzo esempio, invece, ci mostra come possiamo generare un vettore <em>factor</em> definendo i suoi livelli in modo che comprendano stati o valori che non sono osservati nel vettore stesso, ma sono teoricamente ammessi. Nello specifico, <em>a</em> comprende solo tre elementi che assumono uno tra due valori (“A” e “C”), ma il livello “B” è ammesso anche se non osservato.</p>
<p>Sorvoleremo sulle altre combinazioni di coercizione, ma il neofita è invitato a sperimentare e apprendere in maniera euristica…</p>
<p>Invece è importante richiamare l’attenzione su un aspetto già menzionato di R: la sua logica ad oggetti è concepita per essere vettoriale. Questo significa che vettori e matrici sono le sue strutture di base, e di fatto ogni oggetto può essere visto come un qualche tipo di vettore. Addirittura gli scalari possono essere visti come speciali vettori di dimensione 1 (un unico elemento). Le conseguenze di questa cosa sarà evidente nel prossimo paragrafo.</p>
<hr />
</div>
<div id="matrici-e-array" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Matrici (e Array)</h3>
<p>Ed eccoci qui a parlar di matrici.
La prima cosa da dire a proposito di esse è che sono uno degli oggetti elettivi per il calcolo all’interno di R. Moltissime funzione di basi, infatti, sono già predisposte per essere applicate sulle matrici in diretta e “performante” in termini di tempo di esecuzione. Ma cosa è una matrice?
Una matrice può essere definita come un reticolo (in inglese <em>lattice</em>) di valori omologhi (nel senso che appartengono tutti alla stessa tipologia, per esempio sono tutti <em>numeric</em> o tutti <em>character</em>) disposti in maniera regolare in righe e colonne. Ogni valore sarà pertanto individuato in maniera univoca da una coppia di numeri interi che corrisponde ai suoi indici di posizione all’interno della matrice (riga e colonna). Questa logica topografica è la stessa che utilizzavamo quando giocavamo alla battaglia navale sui banchi di scuola.
La sintassi del comando che si deve usare per generare una matrice è molto semplice. Quello che occorre è specificare il contenuto della matrice e la sua geometria (quante righe, quante colonne).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="base.html#cb115-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb115-2"><a href="base.html#cb115-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb115-3"><a href="base.html#cb115-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Questo primo, banale esempio ci aiuta a capire 2 cose importanti:</p>
<ul>
<li><p>Quando visualizziamo una matriche, R utilizza l’<em>indicizzazione</em> per mostrarci la sua struttura reticolare. Infatti all’inizio di ogni riga e sopra ogni colonna compaiono due parentesi quadre con all’interno i rispettivi indici di riga e di colonna.</p></li>
<li><p>Nel comando predente abbiamo speficato che l’argomento data (cioè il contenuto della matrice) deve corrispondere ai numeri da 1 a 6. Ebbene, R dispone questi numeri in 2 colonne e partendo dall’angolo sinistro e procedendo a riempire la matrice “per colonne”.</p></li>
</ul>
<p>In effetti, il comando matrix ha un’opzione che ci permette, se lo vogliamo, di riempire la matrice “per riga”:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="base.html#cb117-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb117-2"><a href="base.html#cb117-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)</span>
<span id="cb117-3"><a href="base.html#cb117-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
<p>In questo esempio, l’<em>attivazione</em> dell’opzione <em>byrow</em> ci ha restituito un oggetto con lo stesso contenuto della matrice precedente ma con una diversa disposizione dei numeri al suo interno.
In entrambi i casi, comunque, la matrice può essere vista come una serie di vettori (righe o colonne) appiccicati insieme. Una dimostrazione di questo ci viene dall’utilizzo dei comandi <em>cbind</em> e <em>rbind</em> (acronimi di “columns bind” e “rows bind”):</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="base.html#cb119-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb119-2"><a href="base.html#cb119-2"></a>c1 =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></span>
<span id="cb119-3"><a href="base.html#cb119-3"></a>c2 =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb119-4"><a href="base.html#cb119-4"></a>M &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, c2)</span>
<span id="cb119-5"><a href="base.html#cb119-5"></a>M</span></code></pre></div>
<pre><code>##      c1 c2
## [1,]  1  4
## [2,]  2  5
## [3,]  3  6</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="base.html#cb121-1"></a><span class="kw">class</span>(M)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="base.html#cb123-1"></a>c1 =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></span>
<span id="cb123-2"><a href="base.html#cb123-2"></a>c2 =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb123-3"><a href="base.html#cb123-3"></a>M &lt;-<span class="st"> </span><span class="kw">rbind</span>(c1, c2)</span>
<span id="cb123-4"><a href="base.html#cb123-4"></a>M</span></code></pre></div>
<pre><code>##    [,1] [,2] [,3]
## c1    1    2    3
## c2    4    5    6</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="base.html#cb125-1"></a><span class="kw">class</span>(M)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<p>In entrambi i casi otteniamo un oggetto di classe <em>matrix</em>.
Da questi semplici esempi si deduce che una matrice è un oggetto sempre e solo bidimensionale. Ebbene, per comprendere gli <em>array</em> basta sapere che essi sono semplicemente matrici sono più di 2 dimensioni.
Non ci dilunghiamo oltre sulle matrici, ma torneremo estesamente su di esse quando (tra poco) parleremo di funzioni.</p>
</div>
<div id="liste" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Liste</h3>
<p>Le <em>liste</em> sono delle vere e proprie “collezioni” di oggetti in R. Ogni lista è di per se un oggetto, ma in pratica ogni lista contiene dei sotto-oggetti (matrici, vettori, scalari, array, data frame, altre liste).
L’utilità delle lista sta proprio nella loro versatilità strutturale: mentre vettori, matrici ed array sono oggetti che contengono elementi di un solo tipo, le liste possono contenere una molteplicità di sotto-oggetti di tipo diverso. Inoltre, tutti gli altri oggetti di R sono “regolari”: la loro struttura è organizzata in dimensioni (le righe o le colonne) rigide: ci si aspetta che ogni riga di una matrice contenga un elemento per ciascuna colonna, e viceversa.
Per comprendere la differenza tra le <em>liste</em> e gli altri oggetti, può essere utile fare un giro all’Ikea
<img src="Images/ikea.png" />
La figura parla da se: non potreste mai mettere la TV in una matrice o in un vettore!</p>
<p>E’ possibile generare una lista mediante il comando <em>list</em> di cui vediamo una prima semplicissima applicazione:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="base.html#cb127-1"></a><span class="co">#Genero il vettore V avente 5 elementi  numerici</span></span>
<span id="cb127-2"><a href="base.html#cb127-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb127-3"><a href="base.html#cb127-3"></a>V</span></code></pre></div>
<pre><code>## [1] 4 9 1 0 7</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="base.html#cb129-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb129-2"><a href="base.html#cb129-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb129-3"><a href="base.html#cb129-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="base.html#cb131-1"></a><span class="co">#Genero la lista L contenente i sotto-oggetti V e M</span></span>
<span id="cb131-2"><a href="base.html#cb131-2"></a>L &lt;-<span class="st"> </span><span class="kw">list</span>(V, M)</span>
<span id="cb131-3"><a href="base.html#cb131-3"></a>L</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4 9 1 0 7
## 
## [[2]]
##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Si vede subito che all’interno di L ci sono sia V che M.
Ora, prima di passare alle funzioni (che abbiamo subdolamente introdotto senza parlarne in maniera esplicita…), vediamo l’ultima tipologia di oggetto R di base: i data.frame</p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Data Frame</h3>
<p>E’ abbastanza facile immaginare un <em>data frame</em> come una matrice, quindi un oggetto regolare, che contenga diversi tipi di oggetti, tipicamente un tipo per ogno colonna. Ad esempio</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="base.html#cb133-1"></a><span class="co">#Genero il vettore V avente 5 elementi numerici</span></span>
<span id="cb133-2"><a href="base.html#cb133-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb133-3"><a href="base.html#cb133-3"></a></span>
<span id="cb133-4"><a href="base.html#cb133-4"></a><span class="co">#Genero il vettore C avente 5 elementi character</span></span>
<span id="cb133-5"><a href="base.html#cb133-5"></a>C &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb133-6"><a href="base.html#cb133-6"></a></span>
<span id="cb133-7"><a href="base.html#cb133-7"></a><span class="co">#Genero il vettore H avente 5 elementi factor</span></span>
<span id="cb133-8"><a href="base.html#cb133-8"></a>H &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L1&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>))</span>
<span id="cb133-9"><a href="base.html#cb133-9"></a></span>
<span id="cb133-10"><a href="base.html#cb133-10"></a><span class="co">#Genero il data frame df contente gli oggetti V, C e H</span></span>
<span id="cb133-11"><a href="base.html#cb133-11"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(V, C, H) </span>
<span id="cb133-12"><a href="base.html#cb133-12"></a>df</span></code></pre></div>
<pre><code>##   V C  H
## 1 4 A L1
## 2 9 A L2
## 3 1 B L2
## 4 0 B L2
## 5 7 C L1</code></pre>
<p>Comodo no? Immaginate di essere un ecologo intento nel monitoraggio di una popolazione animale “sul campo”.
Per ogni indivduo analizzato (la riga del data frame) raccoglierete una serie di misure. Alcune continue (il peso, la lunghezza), altre character (il nome o il codice dell’esemplare), altre factor (il sesso), e così via.
Vi sarà possibile organizzare queste molteplici informazioni nelle colonne di un data frame in modo da avere il corrispondente informatico di una tabella. E’ chiaro che tutto questo è molto intuitivo e versatile, e questo è esattamente il motivo per cui, nella maggior parte dei corsi su R, i data frame sono un argomento centrale e questi oggetti sono considerati i più importanti all’interno di R.</p>
<p>Gli autori di questo manuale non la pensano così.</p>
<p>Noi pensiamo che i data frame, che sono trattati nell’ambiente R, da un punto di vista computazionale, come delle liste, sono oggetti da prendere con pinze. Questo per varie ragioni:</p>
<ul>
<li>se siete dei principianti, i data frame sono oggetti troppo complessi e fuorvianti</li>
<li>è complicato imparare i fondamenti di computazione di R usando i data frame, anche perchè molte funzioni di R sono ottimizzate per lavorare su matrici numeriche</li>
<li>per maneggiare appieno i data frame è necessario avere una certa famigliarità con tutte le tipologie di dati (numeric, character, factor, ecc.)</li>
</ul>
<p>Torneremo in maniera apporondita sui data frame quando affronteremo la “filosofia ggplot”, ma per ora li mettiamo da parte.</p>
</div>
</div>
<div id="Funzioni" class="section level2">
<h2><span class="header-section-number">3.9</span> Sintassi di base (II): le funzioni</h2>
<p>Abbiamo già spiegato che R è un ambiente <em>object-oriented</em> e, quindi, la manipolazione e trasformazione dei dati contenuti negli oggetti rappresenta in estrema sintesi il metodo di lavoro che si utilizza in questo ambiente. Le <strong>funzioni</strong> non sono altro che sequenze di istruzioni per manipolare dati in ingresso ed ottenere un certo risultato in uscita.
R, anche nella sua versione base, contiene centinaia di funzioni preimpostate e disponibili, ma diciamo da subito che l’utente, anche se è un principiante, può definirne di nuove e, anzi, il successo di R si deve sopratutto alla sua capacità di stimolare la fantasia e la creatività.
Per impadronirci di questo strumento essenziale, tuttavia, dobbiamo comprenderne ed assimilarne gli aspetti di base:</p>
<ul>
<li>Ogni funzione ha un suo <strong>nome</strong> preciso, non ambiguo e unico. In generale, non possiamo definire oggetti che hanno lo stesso nome delle funzioni e viceversa (o meglio possiamo farlo, ma a nostro rischio e pericolo);</li>
<li>Ogni funzione si utilizza mediante il suo nome seguito da una coppia di parentesi tonde al cui interno sono inseriti i riferimenti agli <strong>argomenti</strong> della funzione e alle sue <strong>opzioni</strong>;</li>
<li><strong>argomenti</strong> e <strong>opzioni</strong> sono specifici di ogni funzione. Questo significa che, col tempo, è necessario (e automatico) imparare a memoria tanti nomi di funzioni e dei loro argomenti…</li>
</ul>
<p>Vediamo alcuni esempi cominciando da una funzione che abbiamo già incontato: la funzione <strong>matrix</strong></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="base.html#cb135-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb135-2"><a href="base.html#cb135-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>In questo esempio di applicazione notiamo che:</p>
<ul>
<li>Definiamo un oggetto di nome M mediante assegnazione alla funzione matrix. Questo significa che quello che esce dalla parte destra dell’assegnazione diventerà <strong>M</strong>;</li>
<li>Usiamo la funzione mediante il suo nome seguito da una serie di input forniti all’interno di una coppia di parentesi tonde;</li>
<li>Quello che c’è tra le parentesi tonde è una serie di assegnazioni con tanto di nomi e di valori. Questa è la modalità di utilizzo più “verbose” cioè esplicita a prolissa. In realtà, potremmo omettere i nomi degli argomnti purchè li inseriamo nell’ordina in cui la funzione se li aspetta.</li>
</ul>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="base.html#cb136-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb136-2"><a href="base.html#cb136-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb136-3"><a href="base.html#cb136-3"></a></span>
<span id="cb136-4"><a href="base.html#cb136-4"></a><span class="co">#Utilizzo equivalente</span></span>
<span id="cb136-5"><a href="base.html#cb136-5"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>Dunque la funzione matrix, per funzionare, ha bisogno di 3 argomenti: <em>data</em>, <em>nrow</em> e <em>ncol</em>. Il significato dei loro nomi dovrebbe essere intuitivo: <em>data</em> corrisponde ai dati da inserire (i valori nelle celle della matrice), <em>nrow</em> specifica il numero di righe della matrice, <em>ncol</em> specifica il numero di colonne.
Non tutti gli argomenti di una funziona hanno la stessa importanza. Nel caso di <em>matrix</em>, la geometria della matrice da creare (cioè il suo numero di righe e di colonne) è più importante del contenuto. Ce ne accorgiamo provando a fare:</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="base.html#cb137-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb137-2"><a href="base.html#cb137-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb137-3"><a href="base.html#cb137-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   NA   NA
## [2,]   NA   NA
## [3,]   NA   NA</code></pre>
<p>L’oggetto M contiene una serie di valori tutti uguali chiamati <strong>NA</strong>. Scopriremo tra poco di cosa si tratta, ma intanto notiamo che la geometria è quella desiderata. Allo stesso modo, possiamo generare una matrice contenente valori tutti uguali (ma definiti)</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="base.html#cb139-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb139-2"><a href="base.html#cb139-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb139-3"><a href="base.html#cb139-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1
## [3,]    1    1</code></pre>
<p>In questo caso R ha popolato la matrice con tanti valori pari a 1.
E’ interessante commentare cosa succede quando l’input non è “coerente”. Ad esempio:</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="base.html#cb141-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb141-2"><a href="base.html#cb141-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(1:7, 3, 2): data length [7] is not a sub-multiple or multiple
## of the number of rows [3]</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="base.html#cb143-1"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>In questo caso abbiamo indicato a R che la matrice deve contenere i valori da 1 a 7, pur avendo 3 righe e 2 colonne (e quindi 6 celle). R, obbediente, produce un oggetto M identico a precedenti omettendo l’ultimo valore da noi indicato per l’argomento <em>data</em> (il 7), ma ci avvisa che “i conti non tornano” mediante un “warning”. Come dice il suo nome, un <strong>warning</strong> non è un errore ma un avvertimento, ma è importante fare attenzione perchè magari l’incoerenza degli argomenti è frutto di un banale errore di digitazione.
Vediamo un altro esempio:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="base.html#cb145-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb145-2"><a href="base.html#cb145-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(1:5, 3, 2): data length [5] is not a sub-multiple or multiple
## of the number of rows [3]</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="base.html#cb147-1"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    1</code></pre>
<p>Se guardiamo bene il contenuto di M, ci accorgiamo che sono presenti i numeri da 1 a 5, inseriti per colonne, ma nell’ultima cella della matrice (quella in basso a destra) compare una seconda volta il numero 1 (il primo della serie da noi indicata). Il motivo è semplice: abbiamo detto a R di generare una matrice di 6 celle ma gli abbiamo fornito solo 5 valori per riempirla. Risultato: R ha “riutilizzato” il primo valore della serie.</p>
<p>Altra cosa da dire importante sulle funzioni è che, oltre agli argomenti (indispensabili), può essere importante conoscere e padroneggiare le <strong>opzioni</strong>.
Riprendiamo l’esempio di matrix</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="base.html#cb149-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb149-2"><a href="base.html#cb149-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb149-3"><a href="base.html#cb149-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="base.html#cb151-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb151-2"><a href="base.html#cb151-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>)</span>
<span id="cb151-3"><a href="base.html#cb151-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Che differenza notiamo tra questi due comandi? Nel primo caso R ha usato la sequenza da 1 a 6 per riempire la matrice M “per colonna”, nel secondo caso lo ha fatto “per riga”. Questo ci permette di chiarire in senso generale l’uso delle opzioni: <strong>esse rappresentano dei comandi di input delle funzioni per alterarne il comportamento ma, essendo appunto opzionali, esiste una modalità “di base” (o di default come dicono gli inglesi) nell’esecuzione di ogni funzione e le opzioni hanno il potere di alterarla</strong>. Per disattivare un’opzione dobbiamo porla uguale a FALSE, se la vogliamo attivare la dobbiamo porre uguale a TRUE. Questa è un’altra peculiarità delle opzioni: sono delle variabili booleane e possono assumere solo due valori, TRUE e FALSE appunto.
Se comprendiamo questo, possiamo facilmente intuire perchè le opzioni sono sempre per definizione disattive e siamo noi a doverle “attivare”.</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="base.html#cb153-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb153-2"><a href="base.html#cb153-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb153-3"><a href="base.html#cb153-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="base.html#cb155-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb155-2"><a href="base.html#cb155-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>)</span>
<span id="cb155-3"><a href="base.html#cb155-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Questi due comandi producono risultati identici perchè sono identici: nel secondo caso l’opzione <em>byrow</em> è espressamente ed esplicitamente annullata dall’utente, nel primo lo è perchè quello è lo stato predefinito di ogni opzione.
Questo punto ci fornisce l’appiglio per introdurre una nuova, semplice funzione: <strong>sum</strong>. Come dice il suo nome, la funzione <strong>sum</strong> calcola la somma degli oggetti che le vengono forniti come input, indipendentemente dalla loro geometria (possono essere vettori o matrici o array) ma non dal loro tipo (la somma è definita solo per le quantità integer e numeric, non per quelle factor o character o per le altre).
Quindi:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="base.html#cb157-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb157-2"><a href="base.html#cb157-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb157-3"><a href="base.html#cb157-3"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M)</span>
<span id="cb157-4"><a href="base.html#cb157-4"></a>SM</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="base.html#cb159-1"></a><span class="co">#Genero il vettore V avente 5 elementi numerici</span></span>
<span id="cb159-2"><a href="base.html#cb159-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb159-3"><a href="base.html#cb159-3"></a>SV &lt;-<span class="st"> </span><span class="kw">sum</span>(V)</span>
<span id="cb159-4"><a href="base.html#cb159-4"></a>SV</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>Ok? Allora adesso introduciamo volutamente un esempio “rognoso”:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="base.html#cb161-1"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb161-2"><a href="base.html#cb161-2"></a>V</span></code></pre></div>
<pre><code>## [1]  1  3  5 -2  3  7</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="base.html#cb163-1"></a>V &lt;-<span class="st"> </span><span class="kw">sqrt</span>(V)</span></code></pre></div>
<pre><code>## Warning in sqrt(V): Si è prodotto un NaN</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="base.html#cb165-1"></a>V</span></code></pre></div>
<pre><code>## [1] 1.000000 1.732051 2.236068      NaN 1.732051 2.645751</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="base.html#cb167-1"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(V, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb167-2"><a href="base.html#cb167-2"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M)</span>
<span id="cb167-3"><a href="base.html#cb167-3"></a>SM</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<p>Analizziamo il pasticcio che abbiamo combinato:</p>
<ul>
<li>Abbiamo definito il vettore V come composto da 6 elementi numerici, di cui uno negativo</li>
<li>Abbiamo usato la semplice funzione <strong>sqrt</strong> (acronimo di <em>square root</em>) per calcolare le radici quadrate dei valori di V</li>
<li>Siccome non esiste un numero reale che corrisponda alla radice quadrata di un negativo, il nuovo vettore V contiene un valore “strano” che non abbiamo mai incontrato: <strong>NaN</strong> (acronimo di not-a-number)</li>
<li>Siamo andati avanti generando la matrice M come se nulla fosse…</li>
<li>Quando abbiamo calcolato il valore della somma SM di M, abbiamo ottenuto una brutta risposta: ancora un NaN!!!!</li>
</ul>
<p>Perchè ci siamo andati a impelagare in questa brutta storia? Per mostrare che la funzione <em>sum</em> ha un’utilissima (ma pericolosa!) opzione denominata <strong>na.rm</strong>. Proviamo ad attivarla:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="base.html#cb169-1"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb169-2"><a href="base.html#cb169-2"></a>V &lt;-<span class="st"> </span><span class="kw">sqrt</span>(V)</span></code></pre></div>
<pre><code>## Warning in sqrt(V): Si è prodotto un NaN</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="base.html#cb171-1"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(V, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb171-2"><a href="base.html#cb171-2"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb171-3"><a href="base.html#cb171-3"></a>SM</span></code></pre></div>
<pre><code>## [1] 9.345921</code></pre>
<p>Questa volta abbiamo ottenuto un valore “buono” della somma di M. Se facciamo due calcoli a mente possiamo facilmente dedurre che esso corrisponde alla somma di tutti i valori di M tranne quello strano e brutto NaN, con il quale faremo conoscenza tra poco. Adesso però ci interessa un’altra cosa: l’opzione <em>na.rm</em> sta per “remove NA or NaN”, e quindi significa autorizzare la funzione a far finta che non ci siano valori strani. Quindi, attivandola, abbiamo detto a R di calcolare la somma solo sugli altri valori. A questo punto qualcuno di voi lettori si starà chiedendo: e perchè mai questa fantastica opzione è disattiva di default e dobbiamo attivarla noi? Non sarebbe meglio se fosse sempre accesa e ci proteggesse da risultati brutti? La risposta è NO, non sarebbe affatto meglio, perchè il fatto che i nostri calcoli si inceppino ogni volta che da qualche parte compare un valore strano è un ottimo modo per costringerci a ricontrollare le nostre procedure e fare in modo che siano il più generali e versatili possibili. Per esempio, vogliamo risolvere un problema ma non prendiamo in considerazione che i valori di alcune variabili possono assumere valori negativi. Se così è, e da qualche parte nel nostro codice usiamo funzioni non definite su R- (come la radice quadrata o il logaritmo) ci imbatteremo in un valore anomalo e saremmo naturalmente portati a rimediare.</p>
<p><img src="Images/1funzione.png" />
Ci soffermiamo ora su un altro aspetto essenziale delle funzioni. Mi riferisco al fatto che ciascuna di esse vive e opera in un sottoambiente di quello principale, cioè la sessione di lavoro all’interno della quale stiamo operando. Vediamo cosa significa con un esempio:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="base.html#cb173-1"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb173-2"><a href="base.html#cb173-2"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb173-3"><a href="base.html#cb173-3"></a><span class="kw">sum</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="base.html#cb175-1"></a>x</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="base.html#cb177-1"></a>y</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Sebbene avessimo definito x e y con valori pari a 5 e 3, la somma (in cui abbiamo ri-definito i valori di x e di y), ci ha restituito come somma 0. Inoltre, nell’ambiente principale i valori di x e di y sono rimasti quelli “originali”. Questa ultima cosa dipende dal fatto che, all’interno della funzione <strong>sum</strong>, abbiamo usato l’uguale (=) invece dell’assegnazione (&lt;-). Infatti, se facciamo il contrario:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="base.html#cb179-1"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb179-2"><a href="base.html#cb179-2"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb179-3"><a href="base.html#cb179-3"></a><span class="kw">sum</span>(x &lt;-<span class="st"> </span><span class="dv">5</span>, y &lt;-<span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="base.html#cb181-1"></a>x</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="base.html#cb183-1"></a>y</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>scopriamo che ora il valore di y è cambiato anche nell’ambiente principale. <strong>Questo è il motivo per cui, nell’ambito delle “buona pratiche” che affronteremo più avanti, è sempre proibito fare assegnazioni nello sviluppo di codici e pacchetti: si rischia di fare un pasticcio tremendo quando le si utilizza perchè si rischia di sovrascrivere quantità e oggetti dell’ambiente principale</strong>.</p>
<p>funzioni come argomento di altre funzioni</p>
</div>
<div id="Calcolo" class="section level2">
<h2><span class="header-section-number">3.10</span> La frontiera del calcolo: NA e NaN</h2>
<p>Abbiamo recentemente fatto la sgradevole conoscenza del <em>NaN</em>. Questa quantità, “<em>not-a-number</em>”, viene fuori quanto facciamo calcoli che non sono definiti nell’insieme dei numeri Reali.
Quindi:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="base.html#cb185-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb185-2"><a href="base.html#cb185-2"></a><span class="kw">log</span>(x)</span></code></pre></div>
<pre><code>## [1] -Inf</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="base.html#cb187-1"></a>x &lt;-<span class="st"> </span><span class="dv">-5</span></span>
<span id="cb187-2"><a href="base.html#cb187-2"></a><span class="kw">sqrt</span>(x)</span></code></pre></div>
<pre><code>## Warning in sqrt(x): Si è prodotto un NaN</code></pre>
<pre><code>## [1] NaN</code></pre>
<p>Ora completiamo l’opera con la conoscenza dei <strong>NA</strong>, che sono ancora più antipatici. <strong>NA</strong> sta per “<em>not_assigned</em>”, cioè quantità non definita. Ecco alcuni esempi di come può saltare fuori:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="base.html#cb190-1"></a>x &lt;-<span class="st"> &quot;Testo&quot;</span></span>
<span id="cb190-2"><a href="base.html#cb190-2"></a><span class="kw">as.numeric</span>(x)</span></code></pre></div>
<pre><code>## Warning: si è prodotto un NA per coercizione</code></pre>
<pre><code>## [1] NA</code></pre>
<p>In questo caso abbiamo generato un <strong>NA</strong> chiedendo a R di coercire come numerico una quantità testo, il che letteralmente non ha alcun senso. Più in generale, i <strong>NA</strong> sono il classico caso di “dato mancante”. Se si trovano all’interno di un oggetto, i <strong>NA</strong> devono essere interpretati e trattati come dei “buchi”, a differenza dei <strong>NaN</strong> che sono “valori impossibili”.
La presenza dei <strong>NA</strong> in un codice sono generalmente un sintomo del fatto che la procedura non è abbastanza generale (poichè la presenza di buchi vuol dire spesso che ci sono condizioni che non si realizzano mai, per esempio selezioni che restituiscono un insieme vuoto) e che quindi non è adatta ai dati.
Come abbiamo visto, R non nasconde la polvere sotto il tappeto (a meno che non lo invitiamo a farlo), per cui la graduale eliminazione dei passaggi che generano dei <strong>NA</strong> o dei <strong>NaN</strong> rappresenta una normale fase di revisione e debugging del codice.</p>
</div>
<div id="Boole" class="section level2">
<h2><span class="header-section-number">3.11</span> Operatori relazionali e algebra di Boole</h2>
<p>Sull’opera immortale di <strong>George Boole</strong> è stato scritto tanto, ma mai a sufficienza. Nessuno più di lui ha contribuito a gettare le basi della computazione elettonica. Tanto è vero che la sua <strong>Algebra</strong> è fondamentale anche (e ancora) per noi. Alla base di tutto c’è che le quantità che maneggiamo sono sempre tradotte, nel profondo dei nostri pc, in quantità binarie. Come nelle sinapsi del nostro cervello, i microchip dei nostri processori riduco la realtà a sequenze di stati <strong>acceso-spento</strong>.
La prova sta nel fatto che le quantità booleane le abbiamo già incontrate: sono le quantità di tipo <strong>logical</strong>. Adesso dobbiamo generalizzare a problemi più complessi, per esempio la <strong>verifica di condizioni</strong> all’interno di funzioni o algoritmi. Per farlo, prima dobbiamo prendere in rassegna la sintassi degli operatori booleani in R:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="base.html#cb193-1"></a>dB =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Operatore =</span> <span class="kw">c</span>(<span class="st">&quot;==&quot;</span>, <span class="st">&quot;&gt;&quot;</span>, <span class="st">&quot;&lt;&quot;</span>, <span class="st">&quot;&gt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="st">&quot;&amp;&quot;</span>, <span class="st">&quot;|&quot;</span>),</span>
<span id="cb193-2"><a href="base.html#cb193-2"></a>                <span class="dt">Significato =</span> <span class="kw">c</span>(<span class="st">&quot;uguale&quot;</span>, <span class="st">&quot;maggiore&quot;</span>, <span class="st">&quot;minore&quot;</span>, <span class="st">&quot;maggiore o uguale&quot;</span>,</span>
<span id="cb193-3"><a href="base.html#cb193-3"></a>                                <span class="st">&quot;minore o uguale&quot;</span>, <span class="st">&quot;negazione&quot;</span>,<span class="st">&quot;and&quot;</span>,<span class="st">&quot;or&quot;</span>))</span>
<span id="cb193-4"><a href="base.html#cb193-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb193-5"><a href="base.html#cb193-5"></a>  dB, <span class="dt">caption =</span> <span class="st">&#39;Gli operatori booleani in R&#39;</span>,</span>
<span id="cb193-6"><a href="base.html#cb193-6"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb193-7"><a href="base.html#cb193-7"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab5">Table 3.2: </span>Gli operatori booleani in R</caption>
<thead>
<tr class="header">
<th align="left">Operatore</th>
<th align="left">Significato</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">==</td>
<td align="left">uguale</td>
</tr>
<tr class="even">
<td align="left">&gt;</td>
<td align="left">maggiore</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">minore</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">maggiore o uguale</td>
</tr>
<tr class="odd">
<td align="left">&lt;=</td>
<td align="left">minore o uguale</td>
</tr>
<tr class="even">
<td align="left">!</td>
<td align="left">negazione</td>
</tr>
<tr class="odd">
<td align="left">&amp;</td>
<td align="left">and</td>
</tr>
<tr class="even">
<td align="left">|</td>
<td align="left">or</td>
</tr>
</tbody>
</table>
<p>Vediamo ora alcune loro semplici applicazioni, in modo da spiegare in maniera intuitiva il loro utilizzo</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="base.html#cb194-1"></a><span class="co">#Definisco le quantità x e y e faccio a R una serie di domande</span></span>
<span id="cb194-2"><a href="base.html#cb194-2"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb194-3"><a href="base.html#cb194-3"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb194-4"><a href="base.html#cb194-4"></a>x <span class="op">&gt;</span><span class="st"> </span>y <span class="co">#x è maggiore di y</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="base.html#cb196-1"></a>x <span class="op">&lt;</span><span class="st"> </span>y <span class="co">#x è minore di y</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="base.html#cb198-1"></a><span class="op">!</span>(x <span class="op">==</span><span class="st"> </span>y) <span class="co"># negazione di (x è uguale a y)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="base.html#cb200-1"></a>(x <span class="op">==</span><span class="st"> </span>y) <span class="op">&amp;</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span>y) <span class="co"># (x è uguale a y) and (x è maggiore di y)</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="base.html#cb202-1"></a>(x <span class="op">==</span><span class="st"> </span>y) <span class="op">|</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span>y) <span class="co"># (x è uguale a y) or (x è maggiore di y)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Prestiamo attenzione agli esempi precedenti perchè abbiamo introdotto alcune cose importanti:
* Si possono scrivere semplici <strong>espressioni</strong> proprie dall’Algebra di Boole, ovvero quantità logiche che possono essere solo o vere (TRUE) o false (FALSE) senza ambiguità e complicazioni ulteriori.
* In risposta a queste semplici espressioni, R ci restituisce TRUE o FALSE
* <strong>Se vogliamo usare la negazione o combinare insieme più espressioni dobbiamo racchiuderle tra tonde perchè, di fatto, ogni singola espressione è una piccola funzione</strong></p>
<p>E’ chiaro che tutto questo può esserci utile soltanto se ricordiamo l’Algebra di Boole e, in particolare, le tabelle di verità degli indicatori che si usano per mettere insieme più espressioni.</p>
<p>Questa è la tabella di verità per AND (&amp;):</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="base.html#cb204-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">Espressione1 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb204-2"><a href="base.html#cb204-2"></a>                        <span class="dt">Espressione2 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb204-3"><a href="base.html#cb204-3"></a>                        <span class="dt">Valore =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>)), </span>
<span id="cb204-4"><a href="base.html#cb204-4"></a>             <span class="dt">caption =</span> <span class="st">&quot;Tabella di verità dell&#39;operatore AND&quot;</span>,</span>
<span id="cb204-5"><a href="base.html#cb204-5"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb204-6"><a href="base.html#cb204-6"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab6">Table 3.3: </span>Tabella di verità dell’operatore AND</caption>
<thead>
<tr class="header">
<th align="left">Espressione1</th>
<th align="left">Espressione2</th>
<th align="left">Valore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Questa è la tabella di verità per OR (|):</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="base.html#cb205-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">Espressione1 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb205-2"><a href="base.html#cb205-2"></a>                        <span class="dt">Espressione2 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb205-3"><a href="base.html#cb205-3"></a>                        <span class="dt">Valore =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>)), </span>
<span id="cb205-4"><a href="base.html#cb205-4"></a>             <span class="dt">caption =</span> <span class="st">&quot;Tabella di verità dell&#39;operatore OR&quot;</span>,</span>
<span id="cb205-5"><a href="base.html#cb205-5"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb205-6"><a href="base.html#cb205-6"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab7">Table 3.4: </span>Tabella di verità dell’operatore OR</caption>
<thead>
<tr class="header">
<th align="left">Espressione1</th>
<th align="left">Espressione2</th>
<th align="left">Valore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Per capire l’utilità dell’Algebra di Boole in R possiamo usare alcuni semplici esempi:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="base.html#cb206-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb206-2"><a href="base.html#cb206-2"></a>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span></code></pre></div>
<pre><code>## [1] 9 4 6 7 3 3 1</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="base.html#cb208-1"></a>x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>]</span></code></pre></div>
<pre><code>## [1]  -7 -14</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="base.html#cb210-1"></a>x[x <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 3 3</code></pre>
<p>Dopo aver generato il vettore <em>x</em>, composto di 10 valori numerici, usiamo le parentesi <strong>quadre</strong> per racchiudere un’espressione che ci permetta di selezione, usando l’algebra di Boole, alcuni degli elementi di x. In questi esempi, estraiamo gli elementi di x che sono positivi, o negativi, o uguali al valore 3.
Si tratta ovviamente di esempi molto semplici. Ma la logica da utilizzare per combinazioni più complesse è esattamente la stessa… ma per applicarla dobbiamo fare conoscenza con la funzione <strong>which</strong>.</p>
<p>La funzione <strong>which</strong> serve per combinare più condizioni usando gli operatori di Boole.
Immaginiamo di voler estrarre da x, in un colpo solo, gli elementi maggiori di 3 o minori di -3.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="base.html#cb212-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb212-2"><a href="base.html#cb212-2"></a>x[<span class="kw">which</span>((x <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)<span class="op">|</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">-3</span>))]</span></code></pre></div>
<pre><code>## [1]   9   4   6  -7   7 -14</code></pre>
<p>Naturalmente dobbiamo prestare grande attenzione alla struttura annidata delle parentesti e alla sintassi.
Infatti, nel comando precedente, ci sono due condizioni che devono essere valutate, cioè <strong>(x &gt; 3)</strong> e <strong>(x &lt; -3)</strong>. Poichè esse sono collegate dall’operatore booleano OR (|), è sufficiente che una sola di esse sia soddisfatta.
<strong>which</strong> è, in effetti, una funzione estremamente utile e frequente, che ci permette di assemblare condizioni anche molto complesse.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="base.html#cb214-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb214-2"><a href="base.html#cb214-2"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<p>In questo esempio abbiamo “rovesciato” la selezione precedente, e quindi abbiamo scelto di estrarre i valori compresi tra -3 e 3 ma con l’esclusione dello zero.
Si noti che le due condizioni <strong>((x &lt;= 3)&amp;(x &gt;= -3))</strong> sono racchiuse da una coppia di graffe e quindi il risultato di questa espressione viene prima calcolato e poi combinato con quello dell’espressione <strong>(x != 0)</strong>. Le due espressioni <strong>(x &lt;= 3)</strong> e <strong>(x &gt;= -3)</strong> hanno quindi la precedenza e un livello più basso, mentre il loro risultato è di pari livello rispetto a <strong>(x != 0)</strong>.
La funzione <strong>which</strong> ha anche una opzione molto importante, che si chiama <strong>arr.ind</strong> (contrazione di array indexes). Per assimilarla, facciamo un esempio riferito a una matrice</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="base.html#cb216-1"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb216-2"><a href="base.html#cb216-2"></a></span>
<span id="cb216-3"><a href="base.html#cb216-3"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="base.html#cb218-1"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">arr.ind =</span> T)]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="base.html#cb220-1"></a><span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 6 7 8</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="base.html#cb222-1"></a><span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">arr.ind =</span> T)   </span></code></pre></div>
<pre><code>##      row col
## [1,]   1   2
## [2,]   2   2
## [3,]   3   2</code></pre>
<p>L’utilizzo dell’opzione <strong>arr.ind</strong> non cambia il risultato dell’indicizzazione di <em>x</em>, ma cambia <strong>la forma</strong> in cui la funzione <strong>which</strong> ci restituisce gli <strong>indici di posizione</strong> degli elementi di <em>x</em> che soddisfano la condizione specificata. Se <strong>arr.ind</strong> disattiva, <strong>which</strong> tratta tutti gli oggetti (anche le matrici) come dei vettori, e dunque il risultato che ci fornisce è vettoriale. Se *<strong>arr.ind</strong> è attiva e stiamo lavorando su una matrice, <strong>which</strong> ci restituisce delle coordinate in due dimensioni: riga e colonna degli elementi di <em>x</em> che soddisfano la condizione desiderata.</p>
</div>
<div id="luso-dellhelp" class="section level2">
<h2><span class="header-section-number">3.12</span> L’uso dell’Help</h2>
<p>Fino a questo punto, abbiamo <em>subdolamente</em> introdotto alcune funzioni di base di R (matrix, which, sum,…) illustrandone le principali caratteristiche. Queste e altre funzioni fanno parte del vocabolario di base che un neofita di R deve assimilare, ma ce ne sono tante altre che si aggiungono via via ed è evidente che dobbiamo capire come si fa ad apprendere il loro utilizzo (in maniera possibilmente rapida). La risposta è: <strong>usando l’help di R</strong>! L’Help di R è un interfaccia brutto e apparentemente antipatico. Però, a dispetto delle apparenze, è uno strumento estramemente versatile e completo, e quindi imparare a usarlo ci permette di procedere rapidamente con il nostro <em>self training</em>.</p>
<p><img src="Images/1help.png" /></p>
<p>Per fare la sua conoscenza, proviamo a digitare da terminale il nome di una funzione preceduto dal punto interrogativo:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="base.html#cb224-1"></a>?sum</span>
<span id="cb224-2"><a href="base.html#cb224-2"></a>?which    </span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Autori.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Libro_MIR.pdf", "Libro_MIR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
