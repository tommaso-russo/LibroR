<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 4 Le basi | Un viaggio nell’ambiente R</title>
  <meta name="description" content="Capitolo 4 Le basi | Un viaggio nell’ambiente R" />
  <meta name="generator" content="bookdown 0.21.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 4 Le basi | Un viaggio nell’ambiente R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 4 Le basi | Un viaggio nell’ambiente R" />
  
  
  



<meta name="date" content="2021-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Autori.html"/>
<link rel="next" href="gen.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Copertina</a></li>
<li class="chapter" data-level="2" data-path="Prefazione.html"><a href="Prefazione.html"><i class="fa fa-check"></i><b>2</b> Prefazione</a></li>
<li class="chapter" data-level="3" data-path="Autori.html"><a href="Autori.html"><i class="fa fa-check"></i><b>3</b> Gli autori</a></li>
<li class="chapter" data-level="4" data-path="base.html"><a href="base.html"><i class="fa fa-check"></i><b>4</b> Le basi</a><ul>
<li class="chapter" data-level="4.1" data-path="base.html"><a href="base.html#R"><i class="fa fa-check"></i><b>4.1</b> Che cosa è l’ambiente R</a></li>
<li class="chapter" data-level="4.2" data-path="base.html"><a href="base.html#Russo"><i class="fa fa-check"></i><b>4.2</b> A cosa serve/non serve R</a></li>
<li class="chapter" data-level="4.3" data-path="base.html"><a href="base.html#WYSIWYM"><i class="fa fa-check"></i><b>4.3</b> “What You See Is What You Mean”: dallo Script al terminale (e viceversa)</a></li>
<li class="chapter" data-level="4.4" data-path="base.html"><a href="base.html#Espressioni"><i class="fa fa-check"></i><b>4.4</b> Le Espressioni</a></li>
<li class="chapter" data-level="4.5" data-path="base.html"><a href="base.html#Assegnazioni"><i class="fa fa-check"></i><b>4.5</b> Le Assegnazioni</a></li>
<li class="chapter" data-level="4.6" data-path="base.html"><a href="base.html#SintassiI"><i class="fa fa-check"></i><b>4.6</b> Sintassi di base (I): l’uso delle parentesi</a><ul>
<li class="chapter" data-level="4.6.1" data-path="base.html"><a href="base.html#le-parentesi-tonde"><i class="fa fa-check"></i><b>4.6.1</b> Le parentesi <strong>tonde</strong></a></li>
<li class="chapter" data-level="4.6.2" data-path="base.html"><a href="base.html#le-parentesi-quadre"><i class="fa fa-check"></i><b>4.6.2</b> Le parentesi <strong>quadre</strong></a></li>
<li class="chapter" data-level="4.6.3" data-path="base.html"><a href="base.html#le-parentesi-graffe"><i class="fa fa-check"></i><b>4.6.3</b> Le parentesi <strong>graffe</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="base.html"><a href="base.html#TipiDati"><i class="fa fa-check"></i><b>4.7</b> Tipologie di dati: gli attributi e le classi</a></li>
<li class="chapter" data-level="4.8" data-path="base.html"><a href="base.html#StruttureDati"><i class="fa fa-check"></i><b>4.8</b> Strutture di dati</a><ul>
<li class="chapter" data-level="4.8.1" data-path="base.html"><a href="base.html#vettori"><i class="fa fa-check"></i><b>4.8.1</b> Vettori</a></li>
<li class="chapter" data-level="4.8.2" data-path="base.html"><a href="base.html#matrici-e-array"><i class="fa fa-check"></i><b>4.8.2</b> Matrici (e Array)</a></li>
<li class="chapter" data-level="4.8.3" data-path="base.html"><a href="base.html#liste"><i class="fa fa-check"></i><b>4.8.3</b> Liste</a></li>
<li class="chapter" data-level="4.8.4" data-path="base.html"><a href="base.html#data-frame"><i class="fa fa-check"></i><b>4.8.4</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="base.html"><a href="base.html#Funzioni"><i class="fa fa-check"></i><b>4.9</b> Sintassi di base (II): le funzioni</a></li>
<li class="chapter" data-level="4.10" data-path="base.html"><a href="base.html#Matrioske"><i class="fa fa-check"></i><b>4.10</b> Il mondo “a matrioske”</a></li>
<li class="chapter" data-level="4.11" data-path="base.html"><a href="base.html#Calcolo"><i class="fa fa-check"></i><b>4.11</b> La frontiera del calcolo: NA e NaN</a></li>
<li class="chapter" data-level="4.12" data-path="base.html"><a href="base.html#Boole"><i class="fa fa-check"></i><b>4.12</b> Operatori relazionali e algebra di Boole</a></li>
<li class="chapter" data-level="4.13" data-path="base.html"><a href="base.html#luso-dellhelp"><i class="fa fa-check"></i><b>4.13</b> L’uso dell’Help</a></li>
<li class="chapter" data-level="4.14" data-path="base.html"><a href="base.html#una-cassetta-degli-attrezzi-essenziali"><i class="fa fa-check"></i><b>4.14</b> Una cassetta degli attrezzi essenziali</a><ul>
<li class="chapter" data-level="4.14.1" data-path="base.html"><a href="base.html#c"><i class="fa fa-check"></i><b>4.14.1</b> c</a></li>
<li class="chapter" data-level="4.14.2" data-path="base.html"><a href="base.html#numeric"><i class="fa fa-check"></i><b>4.14.2</b> numeric</a></li>
<li class="chapter" data-level="4.14.3" data-path="base.html"><a href="base.html#character"><i class="fa fa-check"></i><b>4.14.3</b> character</a></li>
<li class="chapter" data-level="4.14.4" data-path="base.html"><a href="base.html#list"><i class="fa fa-check"></i><b>4.14.4</b> list</a></li>
<li class="chapter" data-level="4.14.5" data-path="base.html"><a href="base.html#matrix"><i class="fa fa-check"></i><b>4.14.5</b> matrix</a></li>
<li class="chapter" data-level="4.14.6" data-path="base.html"><a href="base.html#array"><i class="fa fa-check"></i><b>4.14.6</b> array</a></li>
<li class="chapter" data-level="4.14.7" data-path="base.html"><a href="base.html#data.frame"><i class="fa fa-check"></i><b>4.14.7</b> data.frame</a></li>
<li class="chapter" data-level="4.14.8" data-path="base.html"><a href="base.html#vector"><i class="fa fa-check"></i><b>4.14.8</b> vector</a></li>
<li class="chapter" data-level="4.14.9" data-path="base.html"><a href="base.html#rep"><i class="fa fa-check"></i><b>4.14.9</b> rep</a></li>
<li class="chapter" data-level="4.14.10" data-path="base.html"><a href="base.html#seq"><i class="fa fa-check"></i><b>4.14.10</b> seq</a></li>
<li class="chapter" data-level="4.14.11" data-path="base.html"><a href="base.html#head-e-tail"><i class="fa fa-check"></i><b>4.14.11</b> head e tail</a></li>
<li class="chapter" data-level="4.14.12" data-path="base.html"><a href="base.html#nrow-ncol-dim-e-length"><i class="fa fa-check"></i><b>4.14.12</b> nrow, ncol, dim e length</a></li>
<li class="chapter" data-level="4.14.13" data-path="base.html"><a href="base.html#str"><i class="fa fa-check"></i><b>4.14.13</b> str</a></li>
<li class="chapter" data-level="4.14.14" data-path="base.html"><a href="base.html#class"><i class="fa fa-check"></i><b>4.14.14</b> class</a></li>
<li class="chapter" data-level="4.14.15" data-path="base.html"><a href="base.html#unique"><i class="fa fa-check"></i><b>4.14.15</b> unique</a></li>
<li class="chapter" data-level="4.14.16" data-path="base.html"><a href="base.html#table"><i class="fa fa-check"></i><b>4.14.16</b> table</a></li>
<li class="chapter" data-level="4.14.17" data-path="base.html"><a href="base.html#rev-sort-e-order"><i class="fa fa-check"></i><b>4.14.17</b> rev, sort e order</a></li>
<li class="chapter" data-level="4.14.18" data-path="base.html"><a href="base.html#sample"><i class="fa fa-check"></i><b>4.14.18</b> sample</a></li>
<li class="chapter" data-level="4.14.19" data-path="base.html"><a href="base.html#cbind-e-rbind"><i class="fa fa-check"></i><b>4.14.19</b> cbind e rbind</a></li>
<li class="chapter" data-level="4.14.20" data-path="base.html"><a href="base.html#which"><i class="fa fa-check"></i><b>4.14.20</b> which</a></li>
<li class="chapter" data-level="4.14.21" data-path="base.html"><a href="base.html#match"><i class="fa fa-check"></i><b>4.14.21</b> match</a></li>
<li class="chapter" data-level="4.14.22" data-path="base.html"><a href="base.html#intersect-setdiff-e-union"><i class="fa fa-check"></i><b>4.14.22</b> intersect, setdiff, e union</a></li>
<li class="chapter" data-level="4.14.23" data-path="base.html"><a href="base.html#merge"><i class="fa fa-check"></i><b>4.14.23</b> merge</a></li>
<li class="chapter" data-level="4.14.24" data-path="base.html"><a href="base.html#apply"><i class="fa fa-check"></i><b>4.14.24</b> apply</a></li>
<li class="chapter" data-level="4.14.25" data-path="base.html"><a href="base.html#min-max-range"><i class="fa fa-check"></i><b>4.14.25</b> min, max, range</a></li>
<li class="chapter" data-level="4.14.26" data-path="base.html"><a href="base.html#summary"><i class="fa fa-check"></i><b>4.14.26</b> summary</a></li>
<li class="chapter" data-level="4.14.27" data-path="base.html"><a href="base.html#cumsum"><i class="fa fa-check"></i><b>4.14.27</b> cumsum</a></li>
<li class="chapter" data-level="4.14.28" data-path="base.html"><a href="base.html#median"><i class="fa fa-check"></i><b>4.14.28</b> median</a></li>
<li class="chapter" data-level="4.14.29" data-path="base.html"><a href="base.html#quantile"><i class="fa fa-check"></i><b>4.14.29</b> quantile</a></li>
<li class="chapter" data-level="4.14.30" data-path="base.html"><a href="base.html#mean"><i class="fa fa-check"></i><b>4.14.30</b> mean</a></li>
<li class="chapter" data-level="4.14.31" data-path="base.html"><a href="base.html#sd"><i class="fa fa-check"></i><b>4.14.31</b> sd</a></li>
<li class="chapter" data-level="4.14.32" data-path="base.html"><a href="base.html#runif"><i class="fa fa-check"></i><b>4.14.32</b> runif</a></li>
<li class="chapter" data-level="4.14.33" data-path="base.html"><a href="base.html#rnorm"><i class="fa fa-check"></i><b>4.14.33</b> rnorm</a></li>
<li class="chapter" data-level="4.14.34" data-path="base.html"><a href="base.html#weighted.mean"><i class="fa fa-check"></i><b>4.14.34</b> weighted.mean</a></li>
<li class="chapter" data-level="4.14.35" data-path="base.html"><a href="base.html#read.table"><i class="fa fa-check"></i><b>4.14.35</b> read.table</a></li>
<li class="chapter" data-level="4.14.36" data-path="base.html"><a href="base.html#write.table"><i class="fa fa-check"></i><b>4.14.36</b> write.table</a></li>
<li class="chapter" data-level="4.14.37" data-path="base.html"><a href="base.html#read.csv"><i class="fa fa-check"></i><b>4.14.37</b> read.csv</a></li>
<li class="chapter" data-level="4.14.38" data-path="base.html"><a href="base.html#write.csv"><i class="fa fa-check"></i><b>4.14.38</b> write.csv</a></li>
<li class="chapter" data-level="4.14.39" data-path="base.html"><a href="base.html#readrds"><i class="fa fa-check"></i><b>4.14.39</b> readRDS</a></li>
<li class="chapter" data-level="4.14.40" data-path="base.html"><a href="base.html#saverds"><i class="fa fa-check"></i><b>4.14.40</b> saveRDS</a></li>
<li class="chapter" data-level="4.14.41" data-path="base.html"><a href="base.html#jpeg-bmp-png-tiff"><i class="fa fa-check"></i><b>4.14.41</b> jpeg, bmp, png, tiff</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gen.html"><a href="gen.html"><i class="fa fa-check"></i><b>5</b> Analisi di dati genetici</a><ul>
<li class="chapter" data-level="5.1" data-path="gen.html"><a href="gen.html#gen_intro"><i class="fa fa-check"></i><b>5.1</b> Introduzione</a><ul>
<li class="chapter" data-level="5.1.1" data-path="gen.html"><a href="gen.html#perché-la-genetica-con-r"><i class="fa fa-check"></i><b>5.1.1</b> Perché la genetica con R?</a></li>
<li class="chapter" data-level="5.1.2" data-path="gen.html"><a href="gen.html#risorse"><i class="fa fa-check"></i><b>5.1.2</b> Risorse</a></li>
<li class="chapter" data-level="5.1.3" data-path="gen.html"><a href="gen.html#prima-di-cominciare"><i class="fa fa-check"></i><b>5.1.3</b> Prima di cominciare…</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="gen.html"><a href="gen.html#gen_drift"><i class="fa fa-check"></i><b>5.2</b> Deriva Genetica</a></li>
<li class="chapter" data-level="5.3" data-path="gen.html"><a href="gen.html#gen_str"><i class="fa fa-check"></i><b>5.3</b> Struttura genetica delle popolazioni</a><ul>
<li class="chapter" data-level="5.3.1" data-path="gen.html"><a href="gen.html#le-statistiche-f"><i class="fa fa-check"></i><b>5.3.1</b> Le statistiche F</a></li>
<li class="chapter" data-level="5.3.2" data-path="gen.html"><a href="gen.html#inferenza-bayesiana-con-structure"><i class="fa fa-check"></i><b>5.3.2</b> Inferenza Bayesiana con STRUCTURE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="gen.html"><a href="gen.html#gen_phylo"><i class="fa fa-check"></i><b>5.4</b> Filogenesi</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html"><i class="fa fa-check"></i><b>6</b> Machine learning in R</a><ul>
<li class="chapter" data-level="6.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#introduzione"><i class="fa fa-check"></i><b>6.1</b> Introduzione</a><ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#supervised-learning"><i class="fa fa-check"></i><b>6.1.1</b> Supervised Learning</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#unsupervised-learning"><i class="fa fa-check"></i><b>6.1.2</b> Unsupervised Learning</a></li>
<li class="chapter" data-level="6.1.3" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#dati"><i class="fa fa-check"></i><b>6.1.3</b> Dati</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#divisione-dei-dati"><i class="fa fa-check"></i><b>6.2</b> Divisione dei dati</a><ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#campionamento-casuale-semplice"><i class="fa fa-check"></i><b>6.2.1</b> Campionamento casuale semplice</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#campionamento-stratificato"><i class="fa fa-check"></i><b>6.2.2</b> Campionamento stratificato</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#metodi-di-ricampionamento"><i class="fa fa-check"></i><b>6.3</b> Metodi di ricampionamento</a><ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#cross-validation"><i class="fa fa-check"></i><b>6.3.1</b> Cross-validation</a></li>
<li class="chapter" data-level="6.3.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#bootstrapping"><i class="fa fa-check"></i><b>6.3.2</b> Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#stima-della-performance-del-modello"><i class="fa fa-check"></i><b>6.4</b> Stima della performance del modello</a><ul>
<li class="chapter" data-level="6.4.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#modelli-di-regressione"><i class="fa fa-check"></i><b>6.4.1</b> Modelli di regressione</a></li>
<li class="chapter" data-level="6.4.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#modelli-di-classificazione"><i class="fa fa-check"></i><b>6.4.2</b> Modelli di classificazione</a></li>
<li class="chapter" data-level="6.4.3" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#concludendo"><i class="fa fa-check"></i><b>6.4.3</b> Concludendo…</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#algoritmi-di-machine-learning-in-r"><i class="fa fa-check"></i><b>6.5</b> Algoritmi di Machine Learning in R</a><ul>
<li class="chapter" data-level="6.5.1" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#decision-trees"><i class="fa fa-check"></i><b>6.5.1</b> Decision Trees</a></li>
<li class="chapter" data-level="6.5.2" data-path="machine-learning-in-r.html"><a href="machine-learning-in-r.html#random-forests"><i class="fa fa-check"></i><b>6.5.2</b> Random Forests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>7</b> Bibliografia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un viaggio nell’ambiente R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="base" class="section level1">
<h1><span class="header-section-number">Capitolo 4</span> Le basi</h1>
<p><img src="Images/01-01.png" /></p>
<div id="R" class="section level2">
<h2><span class="header-section-number">4.1</span> Che cosa è l’ambiente R</h2>
<p>R è un ambiente di programmazione. Parafrasando Morpheus che sfida Neo nella palestra virtuale di “Struttura”, diremo che l’ambiente R ha le sue regole, e che conoscerle rappresenta il primo passo per impadronirsi di questo strumento (e aggirare o infrangere le sue regole).
In questa sezione saranno introdotte alcune nozioni generali che, spesso, sono date per scontate e quindi non chiaramente delineate. Nella nostra esperienza, dare per scontati questi concetti rende ostica il primo impatto con R e le prime fasi del suo utilizzo, cioè quelle durante le quali i nuovi utenti devono assimilare la sintassi, le diverse tipologie di dati e le strutture all’interno delle quali possono essere organizzati e gestiti. Come tutti gli ambienti e i linguaggi di programmazione, R ha una sua sintassi e, sebbene essa non sia particolarmente complessa e articolata, sicuramente rappresenta il primo grande ostacolo a un utilizzo rapido ed efficace.
Al contrario, se resi comprensibili e chiari, i capisaldi della sintassi possono essere dei punti di riferimento quando guardiamo un codice scritto da altri o da noi stessi un pò di tempo fa… E dunque la prima parte di questo manuale è concepita per illustrare le regole generali che sono alla base delle procedure nell’ambiente R.<br />
Dunque impareremo la differenza sostanziale tra una <strong>espressione</strong> ed una <strong>assegnazione</strong>, l’utilizzo delle <strong>parentesi</strong> e le diverse tipologie di <strong>oggetti</strong> di base.<br />
Successivamente, imparemo a comporre dei semplici codici combinandoi espressioni, assegnazioni, e oggetti. Nel farlo, cercheremo subito di introdurre delle <strong>norme di stile</strong> e delle <strong>buone pratiche</strong> che ci aiuteranno a essere più ordinati, efficienti ed efficaci.</p>
<p>R è un ambiente per <em>Object-oriented programming</em>, cioè uno stile di programmazione diventato molto popolare negli ultimi anni. Questo stile si basa sull’utilizzo (la manipolazione mediante comandi) di <strong>oggetti</strong>, un approccio che rende molto semplice accedere (leggere e scrivere) ai dati in memoria e combinarli in strutture che possono essere anche molto complesse.
Aspetti fondamentali dei lunguaggi <em>object-oriented</em> sono il concetto di <strong>classe</strong> e quello di <strong>metodo</strong>, sui quali torneremo in seguito in maniera approfondita.</p>
<p><strong>Classi</strong> e <strong>Metodi</strong> sono legati dal fatto che, in R, la computazione si basa sull’applicazione di specifici metodi a oggetti di specifiche classi. Non esiste una corrispondenza biunivoca tra classi e metodi, piuttosto molti metodi possono essere applicati a oggetti di classi diverse e viceversa. Tuttavia, metodi diversi sono generalmente specializzati per essere applicati su specifiche classi di oggetti. Questa associazione metodi-classi è spesso molto intuitiva, ma esistono funzioni generiche per determinare di che classe sia un dato oggetto e quali siano i metodi su di esso applicabili.</p>
<p>Un altro aspetto importante dei lunguaggi <em>object-oriented</em> è quello di <em>inheritance</em> (eredità). Questo aspetto può essere sintetizzato come la capacità degli oggetti generati durante l’esecuzione di un codice o di una procedura di calcolo di “portarsi appresso” le caratteristiche degli oggetti “genitori” o delle funzioni “genitrici”, cioè quelli a partire dai quali sono stati generati. Un esempio intuitivo è il seguente: se definisco due quantità numeriche <em>a</em> e <em>b</em> e le sommo, quello che ottengo (<em>c</em>) erediterà le caratteristiche dei genitori (numerici entrambi) e potrà essere trattato come tale. Questo aspetto semplifica enormemente il lavoro poichè, a differenza di quanto avviene in linguaggi di base, non è necessario pre-definire l’oggetto <em>c</em> indicandone esplicitamente le caratteristiche e poi riempirlo.</p>
<p>Continuando l’elenco dei grandi vantaggi di R, dobbiamo sicuramente menzionare la sua enorme <em>Community</em>. Secondo la compagnia di analisi del software <a href="https://www.tiobe.com/tiobe-index/">TIOBE</a>, l’ambiente R è attualemnte al 9° posto tra i linguaggi più popolari ma, soprattutto, è quello che continua a crescere al ritmo più sostenuto.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="base.html#cb1-1"></a>TIOBE &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Name =</span> <span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;Java&quot;</span>, <span class="st">&quot;Python&quot;</span>, <span class="st">&quot;C++&quot;</span>, <span class="st">&quot;C#&quot;</span>, <span class="st">&quot;Visual Basic&quot;</span>, <span class="st">&quot;Java Script&quot;</span>, <span class="st">&quot;R&quot;</span>,</span>
<span id="cb1-2"><a href="base.html#cb1-2"></a>                             <span class="st">&quot;PHP&quot;</span>, <span class="st">&quot;SQL&quot;</span>, <span class="st">&quot;Go&quot;</span>, <span class="st">&quot;Swift&quot;</span>, <span class="st">&quot;Pearl&quot;</span>, <span class="st">&quot;Assembly language&quot;</span>, <span class="st">&quot;Ruby&quot;</span>,</span>
<span id="cb1-3"><a href="base.html#cb1-3"></a>                             <span class="st">&quot;MATLAB&quot;</span>, <span class="st">&quot;Classic Visual Basic&quot;</span>, <span class="st">&quot;Groovy&quot;</span>, <span class="st">&quot;Objective-C&quot;</span>, <span class="st">&quot;Rust&quot;</span>),</span>
<span id="cb1-4"><a href="base.html#cb1-4"></a>                    <span class="dt">Ratings =</span> <span class="kw">c</span>(<span class="fl">16.98</span>, <span class="fl">14.43</span>, <span class="fl">9.69</span>, <span class="fl">6.84</span>, <span class="fl">4.68</span>, <span class="fl">4.66</span>, <span class="fl">2.87</span>, <span class="fl">2.79</span>, <span class="fl">2.24</span>, <span class="fl">1.46</span>, <span class="fl">1.43</span>, <span class="fl">1.42</span>, <span class="fl">1.11</span>, <span class="fl">1.04</span>, <span class="fl">1.03</span>, <span class="fl">0.86</span>, <span class="fl">0.82</span>, <span class="fl">0.77</span>, <span class="fl">0.76</span>, <span class="fl">0.74</span>),</span>
<span id="cb1-5"><a href="base.html#cb1-5"></a>                    <span class="dt">Change =</span> <span class="kw">c</span>(<span class="fl">1.83</span>, <span class="fl">-1.60</span>, <span class="fl">-0.33</span>, <span class="fl">0.78</span>, <span class="fl">0.83</span>, <span class="fl">0.97</span>, <span class="fl">0.62</span>, <span class="fl">1.97</span>, <span class="fl">0.17</span>, <span class="fl">-0.17</span>, <span class="fl">0.45</span>, <span class="fl">0.53</span>, <span class="fl">0.25</span>, <span class="fl">-0.07</span>, <span class="fl">-0.28</span>, <span class="fl">-0.41</span>, <span class="fl">-0.20</span>, <span class="fl">-0.46</span>, <span class="fl">-0.93</span>, <span class="fl">0.29</span>))</span>
<span id="cb1-6"><a href="base.html#cb1-6"></a></span>
<span id="cb1-7"><a href="base.html#cb1-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb1-8"><a href="base.html#cb1-8"></a>  <span class="kw">head</span>(TIOBE, <span class="kw">nrow</span>(TIOBE)), <span class="dt">caption =</span> <span class="st">&#39;TIOBE Index for August 2020&#39;</span>,</span>
<span id="cb1-9"><a href="base.html#cb1-9"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb1-10"><a href="base.html#cb1-10"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 4.1: </span>TIOBE Index for August 2020</caption>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="right">Ratings</th>
<th align="right">Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">C</td>
<td align="right">16.98</td>
<td align="right">1.83</td>
</tr>
<tr class="even">
<td align="left">Java</td>
<td align="right">14.43</td>
<td align="right">-1.60</td>
</tr>
<tr class="odd">
<td align="left">Python</td>
<td align="right">9.69</td>
<td align="right">-0.33</td>
</tr>
<tr class="even">
<td align="left">C++</td>
<td align="right">6.84</td>
<td align="right">0.78</td>
</tr>
<tr class="odd">
<td align="left">C#</td>
<td align="right">4.68</td>
<td align="right">0.83</td>
</tr>
<tr class="even">
<td align="left">Visual Basic</td>
<td align="right">4.66</td>
<td align="right">0.97</td>
</tr>
<tr class="odd">
<td align="left">Java Script</td>
<td align="right">2.87</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="right">2.79</td>
<td align="right">1.97</td>
</tr>
<tr class="odd">
<td align="left">PHP</td>
<td align="right">2.24</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">SQL</td>
<td align="right">1.46</td>
<td align="right">-0.17</td>
</tr>
<tr class="odd">
<td align="left">Go</td>
<td align="right">1.43</td>
<td align="right">0.45</td>
</tr>
<tr class="even">
<td align="left">Swift</td>
<td align="right">1.42</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">Pearl</td>
<td align="right">1.11</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">Assembly language</td>
<td align="right">1.04</td>
<td align="right">-0.07</td>
</tr>
<tr class="odd">
<td align="left">Ruby</td>
<td align="right">1.03</td>
<td align="right">-0.28</td>
</tr>
<tr class="even">
<td align="left">MATLAB</td>
<td align="right">0.86</td>
<td align="right">-0.41</td>
</tr>
<tr class="odd">
<td align="left">Classic Visual Basic</td>
<td align="right">0.82</td>
<td align="right">-0.20</td>
</tr>
<tr class="even">
<td align="left">Groovy</td>
<td align="right">0.77</td>
<td align="right">-0.46</td>
</tr>
<tr class="odd">
<td align="left">Objective-C</td>
<td align="right">0.76</td>
<td align="right">-0.93</td>
</tr>
<tr class="even">
<td align="left">Rust</td>
<td align="right">0.74</td>
<td align="right">0.29</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="base.html#cb2-1"></a><span class="kw">par</span>(<span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb2-2"><a href="base.html#cb2-2"></a><span class="kw">barplot</span>(TIOBE<span class="op">$</span>Ratings[<span class="kw">order</span>(TIOBE<span class="op">$</span>Ratings, <span class="dt">decreasing =</span> F)], </span>
<span id="cb2-3"><a href="base.html#cb2-3"></a>        <span class="dt">names.arg =</span> TIOBE<span class="op">$</span>Name[<span class="kw">order</span>(TIOBE<span class="op">$</span>Ratings, <span class="dt">decreasing =</span> F)], </span>
<span id="cb2-4"><a href="base.html#cb2-4"></a>        <span class="dt">xlab =</span> <span class="st">&quot;Ratings (%)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb2-5"><a href="base.html#cb2-5"></a>        <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;grey&quot;</span>,<span class="dv">12</span>),<span class="st">&quot;blue&quot;</span>,<span class="kw">rep</span>(<span class="st">&quot;grey&quot;</span>,<span class="dv">7</span>)), <span class="dt">horiz =</span> T)</span></code></pre></div>
<p><img src="01-base_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Questo dato è ancora più significativo se si considera che R non è esattamente un ambiente per produrre software compilato e quindi eseguibile (come avviene invece con i membri della famiglia <strong>C</strong>).
Perchè questo aspetto è così importante? Semplicemente perchè, essendo R un ambiente “libero”, ogni utente può attingere a una sterminata banca dati di informazioni, algoritmi, pacchetti aggiuntivi e funzioni già sviluppate da altri utenti… e spesso può contare sull’aiuto diretto di una vasta community. In ambito scientifico, R ha avuto (e continua ad avere) una diffusione inarrestabile perchè incarna perfettamente alcuni ideali della ricerca: la possibilità di sviluppare metodologie completamente replicabili, chiare e ulteriormente implementabili.
Come ha giustamente argomentato <a href="https://ropensci.org/blog/2017/06/23/community/">qui</a> Shannon Ellis, una <em>community</em> ampia offre sviluppatori, esperti, potenziali collaboratori, estensori di documentazione, persone che mettono alla prova le nostre routine, “agitatori” (che sono sempre utili per tenere viva la <em>community</em>!) o semplicemente persone gentili che sono disposte ad aiutare i neofiti. Ma, soprattutto, qualsiasi sia la sfida con la quale siete alle prese, molto probabilmente qualcuno ci si è già cimentato e potrete ripartire dal suo lavoro. Non è forse, questo, un enorme vantaggio?
Shannon Ellis ha compilato una <a href="https://ropensci.org/blog/2017/06/23/community/">lista di siti/blog</a> che rappresentano i principali canali web della
<em>community</em> di R. I principali sono:</p>
<ul>
<li><a href="https://blog.revolutionanalytics.com/local-r-groups.html"><strong>(Revolution) Local R meetup groups</strong></a> - un motore di ricerca che aiuta a trovare riferimenti nella propria area di interesse (per salire sulla spalle dei giganti);</li>
<li><a href="https://rweekly.org/"><strong>Rweekly</strong></a> - un magazine settimanale di quello che succede nel mondo di R;</li>
<li><a href="https://www.r-bloggers.com/"><strong>R-bloggers</strong></a> - un archivio di post utili fatti tra utenti di R;</li>
<li><a href="https://stackoverflow.com/"><strong>Stack Overflow</strong></a> - dove cercare risposte alle nostre domande, spesso legate alle difficoltà dei neofiti (ma non solo)</li>
</ul>
<p>Una bella e completa descrizione di cosa sia R la trovate <a href="https://www.performancetrading.it/Documents/VrRAmbiente/VrR_software_R.htm">qui</a>. In sintesi:</p>
<ul>
<li>R è un ambiente integrato e coerente per l’analisi statistica;</li>
<li>R è contemporaneamente un linguaggio ed un software;</li>
<li>R è un potente strumento per la produzione di grafici (originali);</li>
<li>R è distribuito gratuitamente sotto i vincoli della <a href="https://it.wikipedia.org/wiki/GNU_General_Public_License"><strong>GPL - General Public License</strong></a> ed è disponibile per diverse architetture hardware e sistemi operativi: Unix, Linux, Windows, MacOS.</li>
<li>R è disponibile presso il sito <a href="http://www.r-project.org"><strong>The R Project for Statistical Computing</strong></a> dove è possibile scaricare, oltre che il programma base, anche una serie di moduli aggiuntivi e un’ampia manualistica (in lingua inglese) sull’ambiente che va dall’installazione del software al suo utilizzo nell’analisi dei dati;</li>
<li>il sorgente di R è scritto parte nel linguaggio C e parte nel linguaggio Fortran.</li>
</ul>
<hr />
</div>
<div id="Russo" class="section level2">
<h2><span class="header-section-number">4.2</span> A cosa serve/non serve R</h2>
<p>R non è una panacea, e anche gli appassionati di questo strumento devono essere a conoscenza dei suoi difetti quanto dei suoi pregi. Da una parte, R si comporta come gli smartphone (un nuovo tipo di <em>device</em> che, dalla sua comparsa sul mercato, ha completamente “assorbito” e messo fuori dal mercato altri <em>device</em> come i lettori mp3, le fotocamere, i navigatori satellitari). Infatti chi usa R può facilmente rinunciare a fogli di calcolo, software proprietari per la statistica, gestori di database, piattaforme per la geostatistica, software per l’analisi e la manipolazione di immagini, e la lista potrebbe continuare.
R può servire praticamente a tutto!
Un altro grande vantaggio di R è che, essendo un software opensource, si può accedere al codice sorgente e modificarlo. R è del tutto gratuito.
R possiede un’ampia biblioteca di manuali e dispense accessibili gratuitamente in rete, oltre a pubblicazioni a pagamento.
L’installazione base di R può essere integrata con librerie di funzioni addizionali (il vero valore aggiunto per il mondo della ricerca) che ne ampliano a dismisura le capacità.
R offre un supporto tramite l’<a href="https://www.r-project.org/help.html">R Development Core Team</a>.
Infine, R sa “parlare” con altri linguaggi, da C a SQL a fortran e Python, per cui si possono integrare metodi e funzioni sviluppate in altri contesti.
Per essere proprio completi, è importante ricordare che.</p>
<ul>
<li>R ha una quantità veramente incredibile di funzioni grafiche che consentono di ottenere grafici estremamente efficaci dal punto di vista scientifico ma anche “belli”</li>
<li>R permette di essere creativi ed efficienti, poichè consente di scrivere nuove funzioni o intere librerie in maniera molto semplice</li>
<li>La sua versione base è molto snella, ed essendo sviluppato secondo una logica vettoriale lavora molto bene su vettori e matrici</li>
</ul>
<p>E le brutte notizie?</p>
<p>Beh…</p>
<ul>
<li>R è “brutto”: la sua interfaccia non è pensata per essere bella e accattivante come gli OS ai quali siamo abituati. L’interfaccia utente a carattere (CUI) di R è anche “ostico”, poichè ci costringe a cambiare modo di lavorare. E’ vero che è presente anche un’interfaccia GUI (Graphical User Interface), ma gli utenti esperti non la usano quasi mai;</li>
<li>R è “un elefante”: può arrivare a occupare una grande quantità di memoria e la sua velocità di calcolo è di gran lunga inferiore a quelle di ambienti e linguacci di livello più basso (come la famiglia C o Visual Basic). Questo, a volte, costringe gli utenti più esperti a compilare delle funzioni in C tutte le volte che le loro analisi diventano <em>computational and time demanding</em>;</li>
<li>Non tutte le funzioni di R sono ottimizzate per avere elevate prestazioni (un buon esempio sono le funzioni di ottimizzazione numerica). A volte sarete costretti a metterci del vostro per sviluppare funzioni nuove o più performanti;</li>
<li>Se sviluppate un’applicazione basata su R, è vostro onere tutto quello che rigarda il <em>debug</em> e il mantenimento: se salta fuori un problema, non potete prendervela con nessun altro!</li>
</ul>
<hr />
</div>
<div id="WYSIWYM" class="section level2">
<h2><span class="header-section-number">4.3</span> “What You See Is What You Mean”: dallo Script al terminale (e viceversa)</h2>
<p>Per affrontare la prima parte, dedicata a una carrellata degli aspetti base (concettuali e di sintassi) dell’ambiente R, è necessario assimilare alcuni termini (e strumenti):
Il <strong>terminale</strong> (detto <em>console</em> in inglese, così come è denominata la sua finestra nell’interfaccia di R studio), è l’ <strong>interfaccia</strong> attraverso il quale l’utente interagisce con R.</p>
<div class="figure">
<img src="Images/01-02.png" alt="" />
<p class="caption">Fonte: <a href="https://xkcd.com/149/" class="uri">https://xkcd.com/149/</a></p>
</div>
<p>Citando testualmente Wikipedia: “<em>In informatica una interfaccia a riga di comando[1] (dall’inglese command line interface, in acronimo CLI) o anche console, a volte detta semplicemente riga di comando e, impropriamente[senza fonte], prompt dei comandi, è un tipo di interfaccia utente caratterizzata da un’interazione testuale tra utente ed elaboratore (vedi shell): l’utente impartisce comandi testuali in input mediante tastiera alfanumerica e riceve risposte testuali in output dall’elaboratore mediante display o stampante alfanumerici. Nei sistemi operativi moderni usati nei personal computer, al posto della CLI, in buona parte, c’è l’interfaccia grafica con caratteristiche tipicamente user friendly</em>”.
Il primo (e forse principale) trauma al quale il neofita di R si trova di fronte è la necessità di rinunciare (possibilmente da subito e definitavamente) all’interazione tramite il mouse e quindi le interfacce a finestre e menù a tendina che tanto ci sono familiari e rispetto alle quali abbiamo sviluppato una certa dipendenza! Quando si comincia a usare R, bisogna accettare di inserire i comandi digitandoli direttamente nel terminale o predisponendoli in uno script (una sequenza di comandi annotata da qualche parte, generalmente in un editor di testo o in una apposita finestra di R studio).
Ci sono due motivi principali per questo:
1. Sarebbe impossibile codificare tutti i possibili comandi di R in un menù grafico o a tendina, senza considerare che questo limiterebbe comunque l’originalità degli utenti e renderebbe assai complesso combinare insieme varie funzioni;
2. Imparare a usare il terminale rende il lavoro estremamente più veloce (provare per credere). Questo secondo aspetto accomuna R a tanti altri ambienti di alto livello e persino a sistemi operativi come Ubuntu e Debian (due delle principali distribuzioni di Linux).
Per utilizzare il terminale, però, non basta conoscere la sintassi dei comandi: bisogna cambiare filosofia. Quando utilizziamo un elaboratore di testo, digitiamo i caratteri sapendo che esiste una precisa corrispondenza tra i tasti che premiamo e il risultato che apparirà sullo schermo.
Questo modo di operare viene denominaro What You See Is What You Get (“quello che vedi è quello che è” o “ottieni quanto vedi” - acronimo WYSIWYG). Utilizzare il terminale di un ambiente come R significa invece applicare la filosofia What You See Is What You Mean (letteralmente: quel che vedi è ciò che intendi; sinteticamente, vedi quanto intendi - acronimo WYSIWYM). In sostanza, le istruzioni che digitiamo non sono semplici parole sullo schermo ma implicano l’applicazione di funzioni anche complesse che, nelle intenzioni dell’utente, devono restituire un risultato di qualche tipo.
L’utilizzo di R si svolge tipicamente attraverso un continuo passaggio dall’editor di testo, dove si modica lo script, al terminale dove lo si esegue. Se poi si usano interfacce avanzate come <strong>R studio</strong><a href="https://rstudio.com/">TIOBE</a>, si può disporre di utili finestre accessorie (come quella dei grafici).
La figura seguente ci mostra una tipica schermata di <strong>R studio</strong></p>
<div class="figure">
<img src="Images/01-03.png" alt="" />
<p class="caption">Un’anteprima dell’interfaccia di R studio</p>
</div>
<p>L’interfaccia di Rstudio contiene 4 finestre che sono spesso organizzate in questo modo (ma l’utente ha ampie possibilità di personalizzarle). Analizziamo questo esempio:</p>
<ul>
<li><p>In alto a sinistra c’è lo <strong>Script</strong> o gli <strong>Script</strong> se si vuole gestire più procedure separate. Questa finestra è semplicemente un blocco note multipagina che consente di inviare i comandi direttamente al <strong>terminale</strong></p></li>
<li><p>In basso a sinistra ecco proprio lui, il <strong>terminale</strong>, ovvero il canale di collegamento in ingresso da noi verso R. In Rstudio, questa finestra si chiama <strong>Console</strong>. Avete presente Ellen Ripley che comunica con Mother, il super computer cattivo dell’astronale Nostromo, mediante un terminale? Ecco, il concetto è quello e… a volte penserete che R è antipatico quasi quanto Mother :-)</p></li>
</ul>
<div class="figure">
<img src="Images/01-04.png" alt="" />
<p class="caption">Fonte: <a href="https://preview.redd.it/ai8a6o42tar31.jpg?width=960&amp;crop=smart&amp;auto=webp&amp;s=5ad06fc01552f5227130af2659b47803004f7faf" class="uri">https://preview.redd.it/ai8a6o42tar31.jpg?width=960&amp;crop=smart&amp;auto=webp&amp;s=5ad06fc01552f5227130af2659b47803004f7faf</a></p>
</div>
<ul>
<li><p>In alto a destra c’è una finestra “composita” che racchiude <strong>Environment</strong>, all’interno del quale troveremo un elenco (con alcune caratteristiche essenziali) degli oggetti nella memoria della sessione, <strong>History</strong>, una cronologia dei comandi passati alla <strong>Console</strong>, e infine le tre sottofinestre <strong>Connections</strong>, <strong>Build</strong> e <strong>Tutorial</strong> sulle quali, per ora, possiamo sorvolare.</p></li>
<li><p>In basso a destra c’è un’altra finestra “composita” che racchiude <strong>Files</strong>, cioè l’elenco dei file nella cartella di lavoro (la directory del pc) scelta per la sessione, <strong>Plots</strong>, che conterrà le anteprime dei grafici realizzati, <strong>Packages</strong>, che è un prontuario di tutti gli help dei pacchetti installlati, <strong>Help</strong>, l’interfaccia minimale di aiuto che presto impareremo ad apprezzare, e <strong>Viewer</strong>, destinata a mostrare contenuto HTML come le applicazioni Shiny.</p></li>
</ul>
<p>Una tipica sessione di lavoro in R con Rstudio prevedere un utizzo semi-simultaneo di questi pannelli, e principalmente dello <strong>Script</strong> e del <strong>Terminale</strong> o <strong>Console</strong>.
Dopo queste premesse siamo pronti per rompere gli indugi e fare conoscenza con R.
Qualsiasi sia la vostra installazione, aprite il terminale e cominciamo.</p>
</div>
<div id="Espressioni" class="section level2">
<h2><span class="header-section-number">4.4</span> Le Espressioni</h2>
<p>R è, prima di tutto, un ambiente per calcolo. In questo senso, possiamo vedere il terminale come una calcolatrice.
E’ possibile eseguire calcoli semplici o complessi direttamente mediante il terminale, digitando delle istruzioni analoghe alle formule algebriche, cioè utilizzando un insieme di quantità numeriche, simboli e operatori matematici, e poi premendo il tasto INVIO.
Come avviene per altri ambienti e linguaggi di programmazione, gli operatori matematici di base sono:</p>
<ul>
<li>La somma, codificata col simbolo +.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="base.html#cb3-1"></a><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<ul>
<li>La sottrazione, codificata col simbolo -.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="base.html#cb5-1"></a><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] -3</code></pre>
<ul>
<li>La moltiplicazione, codificata col simbolo *.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="base.html#cb7-1"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<ul>
<li>La divisione, codificata col simbolo /.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="base.html#cb9-1"></a><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 0.4</code></pre>
<ul>
<li>L’elevamento a potenza, codicato col simbolo ^ (ad esempio x^2 indica x elevato al quadrato).</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="base.html#cb11-1"></a><span class="dv">2</span><span class="op">^</span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<p>Esistono poi altre simbologie con un significato matematico definito, come ad esempio:</p>
<ul>
<li>Il simbolo : che serve a generare una sequenza ordinata di interi tra un minino ed un massimo definiti, come ad esempio</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="base.html#cb13-1"></a><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<ul>
<li>Il simbolo % che serve, ad esempio, per specificare il prodotto scalare invece che quello generico (vettoriale se utilizzato su vettori), come ad esempio</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="base.html#cb15-1"></a><span class="kw">c</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   85</code></pre>
<p>All’interno di R, l’utilizzo delle varie tipologie di parentesi è legato a funzionalità diverse (vedi più avanti). Per questo motivo, le parentesi ** tonde ** sono, di fatto, l’unica tipologia di parentesi che mantiene (anche) un significato matematico. Ad esempio</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="base.html#cb17-1"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Questo implica che, se esistono espressioni annidate, dovremo utilizzare sempre e solo le parentesi tonde (invece che passare alle quadre e poi alle graffe come ci hanno insegnato a scuola):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="base.html#cb19-1"></a>((<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))<span class="op">/</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 7.5</code></pre>
<p>E’ ovvio che l’utilzzo delle parentesi deve essere sempre “simmetrico” (una parentesi apre e una chiude) e coerente (i conti devono tornare e quindi ci devono essere tante parentesi aperte quanto quelle chiuse). Quando le espressioni diventano molto complesse, quindi, diventa complicato capire, a colpo d’occhio, quali sono le coppie di parentesi. Ad esempio:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="base.html#cb21-1"></a>(((<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="dv">1</span>))<span class="op">^</span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 243</code></pre>
<p>Comunque i più comuni editor per gli script, e quindi anche software più complessi e integrati come R studio, ci vengono in soccorso evidenziando le coppie di parentesi quando ci spostiamo lungo una espressione con le frecce destra e sinistra della tastiera (provare per credere!).
Le frecce in alto e in basso, invece, possono essere usate per scorrere nella cronologia dei comandi che abbiamo inserito tramite il terminale. Questo ci aiuta a non dover ri-digitare daccapo un’istruzione usata poco prima.
Possiamo digitare le espressioni, dunque, attraverso il terminale che, abbiamo già imparato, ci appare come il simbolo <strong>&gt;</strong>. Tuttavia, quando digitiamo un’espressione matematicamente incompleta (nella quale, ad esempio, manca una parentesi o un argomento legato ad un operatore), R non eseguirà il calcolo ma ci risponderà con l’operatore <strong>+</strong> che serve a farci capire che “manca qualcosa”.
E’ possibile (ma è preferibile non farlo per non pasticciare il codice) inserire più espressioni, separate da <strong>;</strong> o <strong>.</strong> nella stessa linea di comando (prima di premere INVIO).
In ogni caso, le espressioni digitate direttamente nel terminale non vengono salvate in memoria e non possono essere usate per produrre risultati molto complessi. Tutte le volte che sono necessari più passaggi per arrivare dai dati di partenza ai risultati finali è necessario “prendere appunti”, cioè generare delle quantità intermedie e associare ad esse dei nomi. Questo è esattamente quello in cui consiste l’ <strong>assegnazione</strong>.</p>
<hr />
</div>
<div id="Assegnazioni" class="section level2">
<h2><span class="header-section-number">4.5</span> Le Assegnazioni</h2>
<p>Il risultato di una semplice espressione, come gli esempi del paragrafo precedente, viene stampato sullo schermo, cioè appare come risposta di R nel terminale, ma non viene memorizzato.
Per generare una costante, una variabile o un qualsiasi oggetto che contenga uno o più valori (che magari solo il risultato di espressioni matematiche) è necessario <strong>assegnare</strong> all’espressione un nome.
Questo è possibile farlo attraverso i comandi <strong>=</strong> e <strong>&lt;-</strong>. Ad esempio:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="base.html#cb23-1"></a>a =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb23-2"><a href="base.html#cb23-2"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span></code></pre></div>
<p>hanno lo stesso significato e producono il medesimo effetto: l’oggetto <strong>a</strong> sarà associato alla quantità 4. Perché questa ridondanza (2 simbologie per la stessa cosa)? In realtà, <strong>=</strong> e <strong>&lt;-</strong> non si comportano esattamente allo stesso modo. Per cogliere la differenza, proviamo a digitare la seguente espressione, basata sull’utilizzo della funzione <strong>sum</strong>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="base.html#cb24-1"></a><span class="kw">sum</span>(<span class="dt">a =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="base.html#cb26-1"></a>a</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Dopo che R ci avrà restituito il risultato 9, proviamo a “chiedergli” se ricorda quanto valgono a e b, ad esempio digitando <strong>a</strong> nel terminale e premendo invio. Scopriremo che R non ricorda quanto valga <strong>a</strong>!
Se invece provassimo a digitare l’espressione:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="base.html#cb28-1"></a><span class="kw">sum</span>(a &lt;-<span class="st"> </span><span class="dv">4</span>, b &lt;-<span class="st"> </span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="base.html#cb30-1"></a>a</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>e poi chiedessimo a R quanto vale <strong>a</strong> (oppure <strong>b</strong>) scopriremmo che R ha memorizzato i loro valori.
Il perchè di questa apparente stranezza sta nel fatto che l’ambiente di calcolo di R non è unico, bensì ogni funzione opera in un suo “spazio” secondario e solo le quantità assegnate con <strong>&lt;-</strong> trascendono dal sottospazio definito dalla funzione <em>sum</em> allo spazio generale attraverso il quale dialoghiamo.
Dunque, a seconda che vogliamo assegnare delle quantità “generali” o “locali” sceglieremo la simbologia corrispondente, tenendo presente che esistono delle “buona pratiche” che vedremo più avanti. Ovviamente una differenza sostanziale tra <strong>=</strong> e <strong>&lt;-</strong> sta anche nella complessità (e quindi nella velocità) delle due scritture: nel secondo caso, dovremo usare una combinazione due tasti (&lt; + -) invece che uno, e quindi l’assegnazione “generale” è più “faticosa”.
Un’ultima precisazione: le assegnazioni possono essere scritte anche da sinistra verso destra. Ad esempio le scritture:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="base.html#cb32-1"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb32-2"><a href="base.html#cb32-2"></a><span class="dv">4</span> -&gt;<span class="st"> </span>a</span></code></pre></div>
<p>sono funzionalmente equivalenti. Tuttavia si sconsiglia la seconda poichè, come chiunque può sperimentare, è molto più chiaro un algoritmo in cui gli oggetti generati nei diversi passaggi compaiono subito all’inizio di ogni riga.</p>
<hr />
</div>
<div id="SintassiI" class="section level2">
<h2><span class="header-section-number">4.6</span> Sintassi di base (I): l’uso delle parentesi</h2>
<p>Le parentesi sono dei simboli tipografici ampiamente usate sia nella lingua scritta che nella matematica. Esistono 3 tipi di parentesi, e per ognuno di essi esiste una versione di apertura delle parentesi ed una di chiusura: la prima è generalmente un’immagine dotata di convessità verso sinistra, mentre la seconda la possiede generalmente a destra. Nell’ambiente R, le parentesi sono delle strutture molto importanti usate per finalità ben precise. Per questo è fondamentale imparare ad usarle in modo appropriato ed imparare a riconoscerele all’interno di uno <em>script</em>, in modo da orientarsi in procedure complicate o istruzioni annidate.
All’interno di R, ognuna delle tre diverse tipologie di parentesi (tonde, quadre, graffe) è destinata a uno scopo preciso:</p>
<div id="le-parentesi-tonde" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Le parentesi <strong>tonde</strong></h3>
<p>Servono per specificare gli argomenti (ed eventualmente le opzioni) di una <strong>funzione</strong>. In sostanza, le parentesi tonde deliminato un micro-ambiente, parzialmente indipendente da quello generale, all’interno del quale entrano alcuni oggetti o valori (gli argomenti) e dal quale fuoriescono altri oggetti o valori (i risultati).
Può essere utile, a questo punto, fare un piccolo antipasto di come si usano le funzioni in R (torneremo estesamente più avanti sull’argomento). L’esempio seguente ci mostra il risultato dell’utilizzo della funzione <em>c</em>, una delle più semplici tra quelle di base.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="base.html#cb33-1"></a><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 5</code></pre>
<p>Il nome <em>c</em> sta per <em>concatenate</em> (concatena), e difatti questa funzione mette insieme gli <em>argomenti</em>, separati da virgole, in un singolo oggetto (in questo caso un vettore composto da 4 numeri). <strong>Le parentesi tonde seguono sempre il nome della funzione e racchiudono gli argomenti (e le opzioni, se ci sono) separati da virgole</strong>. In questo caso non abbiamo effettuato nessuna assegnazione, e il terminale di R esegue il comando restituendoci il vettore desiderato.
Un altro semplice esempio è:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="base.html#cb35-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb35-2"><a href="base.html#cb35-2"></a><span class="kw">sum</span>(a)</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>In questo caso, abbiamo generato un vettore denominato <em>a</em> e poi abbiamo applicato la funzione <em>sum</em> (somma) su di esso, ottenendo il risultato corrispondente alla somma degli elementi di <em>a</em>.
Gli argomenti di una funzione, dunque, sono i dati in ingresso, la materia prima per permettere alla funzione di lavorare e restituirci un risultato.</p>
<p><img src="Images/01-05.png" /></p>
</div>
<div id="le-parentesi-quadre" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Le parentesi <strong>quadre</strong></h3>
<p>Servono per <strong>indicizzare</strong> gli oggetti, cioè per identificare al loro interno delle sottoparti precise. Come all’interno di una griglia spaziale (immaginate di giocare una partita di battaglia navale), le parentesi quadre ci permettono di fare riferimento a pezzi specifici di oggetti complessi, permettendoci di manipolarli (estrarne delle parti, sostituirle, modificarle, ecc.).
Anche in questo caso si possono fare degli esempi preliminari.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="base.html#cb37-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">5</span>)</span>
<span id="cb37-2"><a href="base.html#cb37-2"></a>a[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>La scrittura precedente definisce un nuovo vettore <em>a</em> e poi, mediante l’uso delle parentesi quadre, ne identifica e isola il primo valore (in questo caso il numero 10). Naturalmente potremmo isolare, con la stessa logica, un altro elemento di <em>a</em>, per esempio il quarto.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="base.html#cb39-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">5</span>)</span>
<span id="cb39-2"><a href="base.html#cb39-2"></a>a[<span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Dovrebbe essere chiaro, quindi, che il numero che compare tra le parentesi quadre corrisponde alla posizione dell’elemento desiderato, e non al suo valore. Siccome un vettore di numeri è, per definizione, un oggetto unidimensionale, è sufficiente un singolo valore (la “posizione nella fila”) per indicare un singolo valore (come nella coda alle poste). Ma cosa accade quando abbiamo oggetti con più di una dimensione?
Per comprenderlo estendiamo gli esempi alle matrici (che sono oggetti a due dimensioni, righe e colonne). Vediamo un esempio:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="base.html#cb41-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb41-2"><a href="base.html#cb41-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="base.html#cb43-1"></a>m[<span class="dv">1</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 101</code></pre>
<p>Sorvoliamo sull’analisi degli argomenti della funzione <em>matrix</em> (i lettori più scaltri avranno intuito che la funzione la genera mettendo i valori da 101 a 109 in 3 righe e 3 colonne, come si vede dalla struttura che R stampa sullo schermo quando invochiamo <em>m</em>), e vediamo come, in questo caso, all’interno delle parentesi quadre abbiamo messo 2 numeri, 1 e 1, separati da una virgola.
R ci dice che <em>m[1,1]</em> corrisponde al numero 101, quello collocato nella prima riga e prima colonna della matrice.
Allo stesso modo potremmo identificare il numero 104 come quello nella prima riga e seconda colonna.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="base.html#cb45-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb45-2"><a href="base.html#cb45-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="base.html#cb47-1"></a>m[<span class="dv">1</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 104</code></pre>
<p>Insomma i due valori separati da virgola tra le quadre sono niente altro che le coordinate dei valori desiderati. Nel caso di un oggetto bidimensionale come una matrice, per indicare un elemento si deve ragionare come in una partita di battaglia navale!</p>
<p>Naturalmente possiamo voler isolare più di un elemento di un oggetto complesso, ad esempio:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="base.html#cb49-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb49-2"><a href="base.html#cb49-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="base.html#cb51-1"></a>n &lt;-<span class="st"> </span>m[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb51-2"><a href="base.html#cb51-2"></a>n</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  101  104
## [2,]  102  105</code></pre>
<p>In questo caso, abbiamo isolato un pezzo della matrice <em>m</em>, corrispondente alle prime 4 celle (quelle nelle prime due righe e prime due colonne) e lo abbiamo assegnato all’oggetto <em>n</em>.
Un ultimo esempio, la selezione di elementi non contingui:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="base.html#cb53-1"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">109</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb53-2"><a href="base.html#cb53-2"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  101  104  107
## [2,]  102  105  108
## [3,]  103  106  109</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="base.html#cb55-1"></a>n &lt;-<span class="st"> </span>m[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb55-2"><a href="base.html#cb55-2"></a>n</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  101  107
## [2,]  103  109</code></pre>
<p>Analizzando il codice dell’esempio, dovremmo poter capire che, all’interno delle quadre, abbiamo indicato due vettori generati con la funzione <em>c</em>. Ciascuno di essi corrisponde al vettore composto da due elementi, i numeri 1 e 3, e quindi il risultato complessivo sarà la creazione di un oggetto <em>n</em>, anch’esso una matrice, composto dagli elementi nella prima riga e terza colonna di <em>m</em>.
Torneremo sul concetto di indicizzazione, e sul suo utilizzo, man mano che prenderemo familiarietà con oggetti aventi struttura più complessa (come ad esempio le <em>liste</em> o gli <em>array</em>)</p>
<p><img src="Images/01-06.png" /></p>
</div>
<div id="le-parentesi-graffe" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Le parentesi <strong>graffe</strong></h3>
<p>Servono principalmente a delimitare strutture precise come i <em>loop</em> (cicli). Dunque le vedremo comparire all’interno di un codice per generare e gestire delle strutture di controllo complesse come le scelte (il ciclo <em>if</em>, <em>else</em>) o iterazioni di blocchi di istruzioni (il ciclo <em>for</em>).
Un esempio è:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="base.html#cb57-1"></a>a &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-2"><a href="base.html#cb57-2"></a>b &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb57-3"><a href="base.html#cb57-3"></a>c &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb57-4"><a href="base.html#cb57-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>b){</span>
<span id="cb57-5"><a href="base.html#cb57-5"></a>  a &lt;-<span class="st"> </span>a  <span class="op">+</span><span class="st"> </span>c</span>
<span id="cb57-6"><a href="base.html#cb57-6"></a>}</span>
<span id="cb57-7"><a href="base.html#cb57-7"></a>a</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>In questo caso, abbiamo definito tre oggetti ( <em>a</em>, <em>b</em>, e <em>c</em>), e poi abbiamo usato la struttura di controllo <em>for</em> per iterare una semplice operazione: prendere <em>a</em> e sommargli <em>b</em> volte <em>c</em>.
Il risultato, intuitivo, è 10.
Le graffe servono per racchiudere il ciclo <em>for</em>.
E’ interessante notare che, manipolando i valori di <em>a</em>, <em>b</em> e <em>c</em>, si possono ottenere risultati diversi… il che è esattamente lo spirito di una struttura iterativa del genere.
Vedremo che le parentesi graffe servono anche a definire le funzioni, ma su questo torneremo più avanti.</p>
<p><img src="Images/01-07.png" /></p>
<hr />
</div>
</div>
<div id="TipiDati" class="section level2">
<h2><span class="header-section-number">4.7</span> Tipologie di dati: gli attributi e le classi</h2>
<p>Tutti i linguaggi di programmazione a oggetti (ed R è uno di questi) sono basati sul fatto che blocchi di informazione detti <strong>oggetti</strong> (siano essi quantità, variabili, istruzioni, procedure complesse) siano utilizzati per accedere ad altrettanti blocchi di dati in memoria. Questa è una differenza sostaziale rispetto ad altri linguaggi come C che si basano sull’accesso <em>diretto</em> ai dati in memoria, cosa che R non consente. All’interno di R gli oggetti hanno un nome esclusivo e sono l’elemento di base su cui lavorare, qualsiasi sia la loro struttura.
Il modo in cui R immagazzina in memoria una dato oggetto è detta <strong>tipo</strong> dell’oggetto stesso.
Non è importante approfondire i diversi tipi di oggetti in R, per cui non ci dilungheremo sull’argomento.</p>
<p>Quello che, invece, è veramente importante sapere è che ogni tipo di oggetto possiede una serie di <strong>attributi</strong>. Tra questi, quello che spicca per importante è la <strong>Classe</strong>.
Come abbiamo già detto in precedenza, le classi sono importanti poichè a seconda di essere variano i metodi che si possono applicare agli oggetti. A questo punto è utile chiarire che i metodi non sono altro che funzioni, e che quindi a ogni classe di oggetti possono essere applicate funzioni diverse, ovvero che una stessa funzione può avere comportamenti diversi a seconda della classe dei suoi
argomenti (cioè degli oggetti sui quali viene applicata).</p>
<p>All’interno di R è possibile operare con diverse tipologie di dati, per ognuna della quali esiste una <strong>classe</strong> predefinita. Sebbene ci siano molte classi già implementate ed altre possano essere definite dagli utenti esperti, esistono 5 classi principali di dati:</p>
<ul>
<li>La classe <strong>numeric</strong>, destinata a tutti i <strong>numeri reali</strong> (elementi dell’insieme R)</li>
<li>La classe <strong>integer</strong>, destinata a tutti i <strong>numeri interi</strong> (elementi dell’insieme N)</li>
<li>La classe <strong>character</strong>, destinata alle stringhe di testo o alle sequenze di caratteri</li>
<li>La classe <strong>logical</strong>, destinata alle espressioni nell’accezione dell’<strong>Algebra di Boole</strong></li>
<li>La classe <strong>factor</strong>, destinata a variabili o quantità qualitative o semi-quantitative</li>
</ul>
<p>E’ facile immaginare il senso delle prime due classi, poichè si riferiscono a insiemi ben noti della matematica. Anche la terza classe è intuitivamente familiare: tutti sappiamo cosa sono i caratteri di un testo. Per gli altri è sufficiente dire che il testo (formato da caratteri) è un tipo di informazione particolare per gli ambienti di calcolo (come R), poichè se ne possono valutare le caratteristiche (quanti caratteri ci sono in una stringa? Quante parole ci sono in un testo?) ma non ha senso applicare funzioni matematiche ai testi.
La quarta classe si riferisce agli oggetti (le espressioni, ma in un senso diverso da quello di cui abbiamo parlato in una sezione precedente a proposito di R) propri dell’Algebra di Boole, il grande matematico inglese che ha gettato le basi per la computazione elettorica.
L’ultima classe è pensata per permetterci di gestire valori semi-quantitativi o qualitativi. Si possono fare moltissimi esempi di “fattori” (<strong>variabili che possono assumere un numero finito di stati o valori</strong>): il sesso di ciascun individuo di una popolazione, il colore degli occhi di diversi individui, la classe di età (coorte) a cui appartengono, l’intensità di un trattamento farmacologico. La cosa importante da dire, in proposito, è che possono esserci fattori ordinabili e fattori non ordinabili. Un esempio del primo tipo sono il sesso o il colore degli occhi: non ha senso dire che maschio viene prima di femmina o che ci sia una scala ordinata di colori (o forse si?). Esempi di fattori ordinabili sono invece la classe di età (coorte) o l’intensità di un trattamento farmacologico: è possibile stabilire una sequenza continua di valori (es. classe di età 0, classe 1, classe 2 e così via).</p>
<p>Per ciascuna delle 5 classi esiste un comando (funzione) che serve a generare un oggetto appartenente alla classe voluta. I comandi in questione hanno lo stesso nome della classe, e quindi avremo le funzioni:</p>
<ul>
<li>numeric()</li>
<li>integer()</li>
<li>character()</li>
<li>logical()</li>
<li>factor()</li>
</ul>
<p>L’utilizzo di queste funzioni è abbastanza intuitivo. Ad esempio, la funzione <em>numeric</em> può essere utulizzata con un solo argomento ( <em>length</em>, ovvero lunghezza) per generare un vettore numerico pieno di zeri (0 è il valore di default) di dimensione desiderata.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="base.html#cb59-1"></a>a &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb59-2"><a href="base.html#cb59-2"></a>a</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<p>Lo stesso avviene per <em>integer</em>, <em>character</em>, e <em>logical</em></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="base.html#cb61-1"></a>a &lt;-<span class="st"> </span><span class="kw">integer</span>(<span class="dv">5</span>)</span>
<span id="cb61-2"><a href="base.html#cb61-2"></a>a</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<p>Nel caso di <em>integer</em> non c’è molto da dire.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="base.html#cb63-1"></a>a &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">5</span>)</span>
<span id="cb63-2"><a href="base.html#cb63-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<p>Nel caso di <em>character</em> otteniamo una sequenza di blocchi di testo vuoti.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="base.html#cb65-1"></a>a &lt;-<span class="st"> </span><span class="kw">logical</span>(<span class="dv">5</span>)</span>
<span id="cb65-2"><a href="base.html#cb65-2"></a>a</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Nel caso di <em>logical</em> otteniamo una sequenza di espressioni booleane, per definizione <em>false</em> (che è il corrispettivo di 0 nell’Algebra binaria di Boole, mentre 1 corrisponde a <em>true</em>). Una piccola trattazione dell’Algebra di Boole, così importante per la programmazione, ci aspetta più avanti.</p>
<p>Una cosa che merita di essere detta, inoltre, è che R è in grado di riconoscere automaticamente le caratteristiche di un oggetto e assegnarlo alla classe opportuna.
Proviamo a riprendere uno degli esempi precedenti e, dopo aver generato una variabile di nome <em>a</em> alla quale assegnamo valore 4, usiamo la funzione <strong>class()</strong> per chiedere a R che roba sia <em>a</em>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="base.html#cb67-1"></a>a &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb67-2"><a href="base.html#cb67-2"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>In questo esempio, R ha correttamente dedotto che volessimo generare una quantità numerica. In effetti, avremmo potuto anche scegliere di assegnare <em>a</em> alla classe <em>integer</em>. Tuttavia R sceglierà sempre come default la classe <em>numeric</em> (che è un sinonimo di <em>double</em> per chi ha già familiarità con linguaggi di programmazione, e in effetti <em>double</em> è il tipo degli oggetti <em>numeric</em>, cioè il modo con cui viene archiviato in memoria) per tutti gli oggetti che contengono solo numeri.</p>
<p>E’ anche possibule definire un oggetto senza inserirne direttamente il valore, e l’esempio che segue ci permette anche di riprendere il concetto di <strong>eredità</strong> (<em>inheritance</em>).</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="base.html#cb69-1"></a>a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb69-2"><a href="base.html#cb69-2"></a>a</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="base.html#cb71-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>In questo esempio abbiamo definito la quantità <em>a</em> come la somma della radice quadrata di 9 (la funzione <em>sqrt</em> è appunto l’acronimo di square root) e del numero 2 elevato al quadrato.
Interrogato sul valore di <em>a</em> e sulla sua classe, R ci risponde che <em>a</em> vale 7 e che è un <em>numeric</em>.
R ha automaticamente calcolato il risultato e lo ha assegnato all’oggetto <em>a</em>. Inoltre, ha dedotto che <em>a</em> è un oggetto della classe <em>numeric</em>, e questo è precisamente un esempio di <em>eredità</em> della classe.</p>
<hr />
</div>
<div id="StruttureDati" class="section level2">
<h2><span class="header-section-number">4.8</span> Strutture di dati</h2>
<p>A questo punto, dopo aver visto quali sono le principali tipologie di dati che si possono gestire in R, dobbiamo comprendere in quali modi è possibile organizzarli. L’oggetto più semplice all’interno di R è il <em>vettore</em>, ma strutture di base sono anche le <strong>matrici</strong>, gli <strong>array</strong>, le <strong>liste</strong> e, infine, i <strong>data frame</strong> (che possono essere considerati degli oggetti “speciali”).</p>
<div id="vettori" class="section level3">
<h3><span class="header-section-number">4.8.1</span> Vettori</h3>
<p>Un vettore può essere pensato come una serie di celle concatenate, ognuna delle quali contiene un valore. A ciascuna cella o elemento del vettore corrisponde un <em>indice di posizione</em> che, come nel caso dei numeri civici su una via che consentono a un corriere postale di trovare un destinatario specifico, possono essere usati per manipolare il vettore, ad esempio estraendone i valori presenti in celle precise identificate tra quadre in una indicizzazione. La cosa importante da assimilare è che <strong>un vettore può contenere elementi che appartengono tutti a una stessa classe</strong>. Questo vuol dire che R gestisce vettori di tanti tipi, i principali dei quali sono proprio i <strong>character</strong>, <strong>integer</strong>, <strong>logical</strong>, <strong>numeric</strong>…. insomma proprio le classi che abbiamo visto poco fa.
Esistono anche altri tipi di vettori, che menzioniamo senza approfondire: <strong>complex</strong> (numeri complessi), <strong>double</strong>, <strong>expression</strong>, <strong>list</strong>, <strong>single</strong>, e <strong>raw</strong>.
Generare un vettore è molto semplice, e non indicheremo due modalità alternative:</p>
<ul>
<li>Mediante la sua “funzione generatrice”. Ne esiste una per ogni tipo di vettore, e il suo nome è intuitivo. Ad esempio, per generare un vettore numeric c’è la funzione omonima <strong>numeric</strong>. Il suo utilizzo, come quello delle sue “sorelle” <strong>character</strong>, <strong>logical</strong>, <strong>integer</strong>, e <strong>factor</strong> (ma vale anche per gli altri tipi appena menzionati), è molto semplice:</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="base.html#cb73-1"></a>a &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb73-2"><a href="base.html#cb73-2"></a>a</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="base.html#cb75-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>L’argomento all’interno delle parentesi specifica la lunghezza del vettore che si vuole generare. Si noterà che, per default, R ha generato un vettore composto da 10 quantità tutte uguali a 0. Intuitivamwente, la funzione <strong>character</strong> genera una serie di stringhe di lunghezza 0 (vuote).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="base.html#cb77-1"></a>a &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">10</span>)</span>
<span id="cb77-2"><a href="base.html#cb77-2"></a>a</span></code></pre></div>
<pre><code>##  [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="base.html#cb79-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Se non lo avete già notato, le quantità character sono sempre facilmente identificabili perchè R le racchiude tra le virgolette.
In entrambi gli esempi, l’applicazione della funzione <strong>class</strong> sugli oggetti generati restituisce una risposta analoga a quelle viste nel paragrafo precedente, e naturalmente univoca perchè tutti gli elementi del vettore sono della stessa classe.</p>
<ul>
<li>Mediante la funzione <strong>c</strong>, che abbiamo già incontrato:</li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="base.html#cb81-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb81-2"><a href="base.html#cb81-2"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="base.html#cb83-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="base.html#cb85-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb85-2"><a href="base.html#cb85-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="base.html#cb87-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Noterete che nel primo caso abbiamo messo insieme (concatenato) 3 numeri per generale il vettore a, immediatamante classificato da R come numeric. Nel secondo caso abbiamo messo insieme le prime tre lettere dell’alfabeto, ottenendo un vettore che R classifica come character.</p>
<p>Per ciascuna delle funzioni generatrici esiste una sorella “coercitrice”. Per esempio a <strong>numeric</strong> corrisponde <strong>is.numeric</strong>, così come a <strong>character</strong> corrisponde <strong>is.character</strong>.
Vediamo un esempio illuminante.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="base.html#cb89-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb89-2"><a href="base.html#cb89-2"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="base.html#cb91-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="base.html#cb93-1"></a>a &lt;-<span class="kw">as.character</span>(a)</span>
<span id="cb93-2"><a href="base.html#cb93-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="base.html#cb95-1"></a><span class="kw">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>In questo caso abbiamo prima generato un vettore numeric e poi lo abbiamo “costretto” a diventare character. A volte i neofiti di R sono confusi da alcuni aspetti di queste trasformazioni, per cui vediamo cosa succede caso per caso.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="base.html#cb97-1"></a><span class="co">#Da numeric a character</span></span>
<span id="cb97-2"><a href="base.html#cb97-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb97-3"><a href="base.html#cb97-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.character</span>(a)</span>
<span id="cb97-4"><a href="base.html#cb97-4"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="base.html#cb99-1"></a><span class="co">#Da  character a numeric</span></span>
<span id="cb99-2"><a href="base.html#cb99-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)</span>
<span id="cb99-3"><a href="base.html#cb99-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span>
<span id="cb99-4"><a href="base.html#cb99-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="base.html#cb101-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb101-2"><a href="base.html#cb101-2"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span></code></pre></div>
<pre><code>## Warning: si è prodotto un NA per coercizione</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="base.html#cb103-1"></a>a</span></code></pre></div>
<pre><code>## [1] NA NA NA</code></pre>
<p>Nei primi due casi è andato tutto bene. Infatti, quando R ha <strong>coercito</strong> il vettore “1”, “2”, “3” a diventare numeric ha ottenuto dei numeri… cioè delle quantità che per lui hanno senso e possono essere gestite come tali. Ma, quando abbiamo coercito il vettore “A”, “B”, “C” a diventare numeric,
R non ha ottenuto dei valori gestibili come numeric e ha quindi generato dei valori detti <strong>NA (not assigned)</strong>. Questa è la prima volta che ci imbattiamo in loro, e dobbiamo subito sapere che la loro comparsa può essere un indice cdel fatto he qualcosa nei nostri calcoli è andato storto. Magari c’è un “errore” da qualche parte nel nostro codice. Invece:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="base.html#cb105-1"></a><span class="co">#Da character a factor</span></span>
<span id="cb105-2"><a href="base.html#cb105-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb105-3"><a href="base.html#cb105-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.factor</span>(a)</span>
<span id="cb105-4"><a href="base.html#cb105-4"></a>a</span></code></pre></div>
<pre><code>## [1] A C C
## Levels: A C</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="base.html#cb107-1"></a><span class="co">#Da numeric a factor</span></span>
<span id="cb107-2"><a href="base.html#cb107-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb107-3"><a href="base.html#cb107-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.factor</span>(a)</span>
<span id="cb107-4"><a href="base.html#cb107-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 2 3
## Levels: 1 2 3</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="base.html#cb109-1"></a><span class="co">#Da factor a character</span></span>
<span id="cb109-2"><a href="base.html#cb109-2"></a>a &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span>
<span id="cb109-3"><a href="base.html#cb109-3"></a>a</span></code></pre></div>
<pre><code>## [1] A C C
## Levels: A B C</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="base.html#cb111-1"></a>a &lt;-<span class="st"> </span><span class="kw">as.character</span>(a)</span>
<span id="cb111-2"><a href="base.html#cb111-2"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;C&quot; &quot;C&quot;</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="base.html#cb113-1"></a><span class="co">#Da factor a numeric</span></span>
<span id="cb113-2"><a href="base.html#cb113-2"></a>a &lt;-<span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span>
<span id="cb113-3"><a href="base.html#cb113-3"></a>a &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(a)</span>
<span id="cb113-4"><a href="base.html#cb113-4"></a>a</span></code></pre></div>
<pre><code>## [1] 1 3 3</code></pre>
<p>Guardiamo per bene questi esempi, anche perchè ne approfitteremo per illustrare la funzione generatrice <strong>factor</strong>.
Nel primo esempio, abbiamo definito il vettore <em>a</em> concatenando tre valori, due dei quali sono uguali tra loro, in modo da generare un vettore character che poi abbiamo coercito a diventare factor.
Poichè gli <em>univoci</em> nel vettore di partenza erano solo due (“A” e “C”), R ha automaticamente stabilito che il <em>factor a</em> contiene valori che possono assumere solo uno tra questi due possibili stati. Gli stati o valori che possono essere assunti da un factor si chiamano <strong>livelli</strong>. I livelli possono essere esplicitamente definiti mediante la funzione generatrice <em>factor</em> o possono essere “desunti” dall’analisi dei valori assunti dagli elementi di un oggetto già esistente, come avviene anche nel secondo esempio (in cui abbiamo generato un <em>numeric</em> e poi lo abbiamo trasformato in un <em>factor</em>).
Il terzo esempio, invece, ci mostra come possiamo generare un vettore <em>factor</em> definendo i suoi livelli in modo che comprendano stati o valori che non sono osservati nel vettore stesso, ma sono teoricamente ammessi. Nello specifico, <em>a</em> comprende solo tre elementi che assumono uno tra due valori (“A” e “C”), ma il livello “B” è ammesso anche se non osservato.</p>
<p>Sorvoleremo sulle altre combinazioni di coercizione, ma il neofita è invitato a sperimentare e apprendere in maniera euristica…</p>
<p>Invece è importante richiamare l’attenzione su un aspetto già menzionato di R: la sua logica ad oggetti è concepita per essere vettoriale. Questo significa che vettori e matrici sono le sue strutture di base, e di fatto ogni oggetto può essere visto come un qualche tipo di vettore. Addirittura gli scalari possono essere visti come speciali vettori di dimensione 1 (un unico elemento). Le conseguenze di questa cosa sarà evidente nel prossimo paragrafo.</p>
<hr />
</div>
<div id="matrici-e-array" class="section level3">
<h3><span class="header-section-number">4.8.2</span> Matrici (e Array)</h3>
<p>Ed eccoci qui a parlare di matrici.
La prima cosa da dire a proposito di esse è che sono uno degli oggetti elettivi per il calcolo all’interno di R. Moltissime funzione di base, infatti, sono già predisposte per essere applicate sulle matrici in diretta e “performante” in termini di tempo di esecuzione. Ma cosa è una matrice?
Una matrice può essere definita come un reticolo (in inglese <em>lattice</em>) di valori omologhi (nel senso che appartengono tutti alla stessa tipologia, per esempio sono tutti <em>numeric</em> o tutti <em>character</em>) disposti in maniera regolare in righe e colonne. Ogni valore sarà pertanto individuato in maniera univoca da una coppia di numeri interi che corrisponde ai suoi indici di posizione all’interno della matrice (riga e colonna). Questa logica topografica è la stessa che utilizzavamo quando giocavamo alla battaglia navale sui banchi di scuola.
La sintassi del comando che si deve usare per generare una matrice è molto semplice. Quello che occorre è specificare il contenuto della matrice e la sua geometria (quante righe, quante colonne).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="base.html#cb115-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb115-2"><a href="base.html#cb115-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb115-3"><a href="base.html#cb115-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Questo primo, banale esempio ci aiuta a capire 2 cose importanti:</p>
<ul>
<li><p>Quando visualizziamo una matriche, R utilizza l’<em>indicizzazione</em> per mostrarci la sua struttura reticolare. Infatti all’inizio di ogni riga e sopra ogni colonna compaiono due parentesi quadre con all’interno i rispettivi indici di riga e di colonna.</p></li>
<li><p>Nel comando predente abbiamo speficato che l’argomento data (cioè il contenuto della matrice) deve corrispondere ai numeri da 1 a 6. Ebbene, R dispone questi numeri in 2 colonne e partendo dall’angolo sinistro e procedendo a riempire la matrice “per colonne”.</p></li>
</ul>
<p>In effetti, il comando matrix ha un’opzione che ci permette, se lo vogliamo, di riempire la matrice “per riga”:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="base.html#cb117-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb117-2"><a href="base.html#cb117-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)</span>
<span id="cb117-3"><a href="base.html#cb117-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
<p>In questo esempio, l’<em>attivazione</em> dell’opzione <em>byrow</em> ci ha restituito un oggetto con lo stesso contenuto della matrice precedente ma con una diversa disposizione dei numeri al suo interno.
In entrambi i casi, comunque, la matrice può essere vista come una serie di vettori (righe o colonne) appiccicati insieme. Una dimostrazione di questo ci viene dall’utilizzo dei comandi <em>cbind</em> e <em>rbind</em> (acronimi di “columns bind” e “rows bind”):</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="base.html#cb119-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb119-2"><a href="base.html#cb119-2"></a>c1 =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></span>
<span id="cb119-3"><a href="base.html#cb119-3"></a>c2 =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb119-4"><a href="base.html#cb119-4"></a>M &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, c2)</span>
<span id="cb119-5"><a href="base.html#cb119-5"></a>M</span></code></pre></div>
<pre><code>##      c1 c2
## [1,]  1  4
## [2,]  2  5
## [3,]  3  6</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="base.html#cb121-1"></a><span class="kw">class</span>(M)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="base.html#cb123-1"></a>c1 =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></span>
<span id="cb123-2"><a href="base.html#cb123-2"></a>c2 =<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb123-3"><a href="base.html#cb123-3"></a>M &lt;-<span class="st"> </span><span class="kw">rbind</span>(c1, c2)</span>
<span id="cb123-4"><a href="base.html#cb123-4"></a>M</span></code></pre></div>
<pre><code>##    [,1] [,2] [,3]
## c1    1    2    3
## c2    4    5    6</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="base.html#cb125-1"></a><span class="kw">class</span>(M)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<p>In entrambi i casi otteniamo un oggetto di classe <em>matrix</em>.
Da questi semplici esempi si deduce che una matrice è un oggetto sempre e solo bidimensionale. Ebbene, per comprendere gli <em>array</em> basta sapere che essi sono semplicemente matrici sono più di 2 dimensioni.
Non ci dilunghiamo oltre sulle matrici, ma torneremo estesamente su di esse quando (tra poco) parleremo di funzioni.</p>
</div>
<div id="liste" class="section level3">
<h3><span class="header-section-number">4.8.3</span> Liste</h3>
<p>Le <em>liste</em> sono delle vere e proprie “collezioni” di oggetti in R. Ogni lista è di per se un oggetto, ma in pratica ogni lista contiene dei sotto-oggetti (matrici, vettori, scalari, array, data frame, altre liste).
L’utilità delle lista sta proprio nella loro versatilità strutturale: mentre vettori, matrici ed array sono oggetti che contengono elementi di un solo tipo, le liste possono contenere una molteplicità di sotto-oggetti di tipo diverso. Inoltre, tutti gli altri oggetti di R sono “regolari”: la loro struttura è organizzata in dimensioni (le righe o le colonne) rigide: ci si aspetta che ogni riga di una matrice contenga un elemento per ciascuna colonna, e viceversa.
Per comprendere la differenza tra le <em>liste</em> e gli altri oggetti, può essere utile fare un giro all’Ikea.
<img src="Images/01-08.png" />
La figura parla da se: non potreste mai mettere la TV in una matrice o in un vettore!</p>
<p>E’ possibile generare una lista mediante il comando <em>list</em> di cui vediamo una prima semplicissima applicazione:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="base.html#cb127-1"></a><span class="co">#Genero il vettore V avente 5 elementi  numerici</span></span>
<span id="cb127-2"><a href="base.html#cb127-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb127-3"><a href="base.html#cb127-3"></a>V</span></code></pre></div>
<pre><code>## [1] 4 9 1 0 7</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="base.html#cb129-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb129-2"><a href="base.html#cb129-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb129-3"><a href="base.html#cb129-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="base.html#cb131-1"></a><span class="co">#Genero la lista L contenente i sotto-oggetti V e M</span></span>
<span id="cb131-2"><a href="base.html#cb131-2"></a>L &lt;-<span class="st"> </span><span class="kw">list</span>(V, M)</span>
<span id="cb131-3"><a href="base.html#cb131-3"></a>L</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4 9 1 0 7
## 
## [[2]]
##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Si vede subito che all’interno di L ci sono sia V che M.
Ora, prima di passare alle funzioni (che abbiamo subdolamente introdotto senza parlarne in maniera esplicita…), vediamo l’ultima tipologia di oggetto R di base: i data.frame</p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">4.8.4</span> Data Frame</h3>
<p>E’ abbastanza facile immaginare un <em>data frame</em> come una matrice, quindi un oggetto regolare, che contenga diversi tipi di oggetti, tipicamente un tipo per ogno colonna. Ad esempio</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="base.html#cb133-1"></a><span class="co">#Genero il vettore V avente 5 elementi numerici</span></span>
<span id="cb133-2"><a href="base.html#cb133-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb133-3"><a href="base.html#cb133-3"></a></span>
<span id="cb133-4"><a href="base.html#cb133-4"></a><span class="co">#Genero il vettore C avente 5 elementi character</span></span>
<span id="cb133-5"><a href="base.html#cb133-5"></a>C &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb133-6"><a href="base.html#cb133-6"></a></span>
<span id="cb133-7"><a href="base.html#cb133-7"></a><span class="co">#Genero il vettore H avente 5 elementi factor</span></span>
<span id="cb133-8"><a href="base.html#cb133-8"></a>H &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L2&quot;</span>,<span class="st">&quot;L1&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>))</span>
<span id="cb133-9"><a href="base.html#cb133-9"></a></span>
<span id="cb133-10"><a href="base.html#cb133-10"></a><span class="co">#Genero il data frame df contente gli oggetti V, C e H</span></span>
<span id="cb133-11"><a href="base.html#cb133-11"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(V, C, H) </span>
<span id="cb133-12"><a href="base.html#cb133-12"></a>df</span></code></pre></div>
<pre><code>##   V C  H
## 1 4 A L1
## 2 9 A L2
## 3 1 B L2
## 4 0 B L2
## 5 7 C L1</code></pre>
<p>Comodo no? Immaginate di essere un ecologo intento nel monitoraggio di una popolazione animale “sul campo”.
Per ogni indivduo analizzato (la riga del data frame) raccoglierete una serie di misure. Alcune continue (il peso, la lunghezza), altre character (il nome o il codice dell’esemplare), altre factor (il sesso), e così via.
Vi sarà possibile organizzare queste molteplici informazioni nelle colonne di un data frame in modo da avere il corrispondente informatico di una tabella. E’ chiaro che tutto questo è molto intuitivo e versatile, e questo è esattamente il motivo per cui, nella maggior parte dei corsi su R, i data frame sono un argomento centrale e questi oggetti sono considerati i più importanti all’interno di R.</p>
<p>Tuttavia, da un punto di vista computazionale, i data.frame sono oggetti da prendere con pinze. Questo anche perchè per usare i data frame è necessario avere una certa famigliarità con tutte le tipologie di dati (numeric, character, factor, ecc.)
Torneremo in maniera apporondita sui data frame quando affronteremo le diverse “filosofie” per produrrre grafici, ma per ora li mettiamo da parte.</p>
</div>
</div>
<div id="Funzioni" class="section level2">
<h2><span class="header-section-number">4.9</span> Sintassi di base (II): le funzioni</h2>
<p>Abbiamo già spiegato che R è un ambiente <em>object-oriented</em> e, quindi, la manipolazione e trasformazione dei dati contenuti negli oggetti rappresenta in estrema sintesi il metodo di lavoro che si utilizza in questo ambiente. Le <strong>funzioni</strong> non sono altro che sequenze di istruzioni per manipolare dati in ingresso ed ottenere un certo risultato in uscita.
R, anche nella sua versione base, contiene centinaia di funzioni preimpostate e disponibili, ma diciamo da subito che l’utente, anche se è un principiante, può definirne di nuove e, anzi, il successo di R si deve sopratutto alla sua capacità di stimolare la fantasia e la creatività.
Per impadronirci di questo strumento essenziale, tuttavia, dobbiamo comprenderne ed assimilarne gli aspetti di base:</p>
<ul>
<li>Ogni funzione ha un suo <strong>nome</strong> preciso, non ambiguo e unico. In generale, non possiamo definire oggetti che hanno lo stesso nome delle funzioni e viceversa (o meglio possiamo farlo, ma a nostro rischio e pericolo);</li>
<li>Ogni funzione si utilizza mediante il suo nome seguito da una coppia di parentesi tonde al cui interno sono inseriti i riferimenti agli <strong>argomenti</strong> della funzione e alle sue <strong>opzioni</strong>;</li>
<li><strong>argomenti</strong> e <strong>opzioni</strong> sono specifici di ogni funzione. Questo significa che, col tempo, è necessario (e automatico) imparare a memoria tanti nomi di funzioni e dei loro argomenti…</li>
</ul>
<p>Vediamo alcuni esempi cominciando da una funzione che abbiamo già incontato: la funzione <strong>matrix</strong></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="base.html#cb135-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb135-2"><a href="base.html#cb135-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>In questo esempio di applicazione notiamo che:</p>
<ul>
<li>Definiamo un oggetto di nome M mediante assegnazione alla funzione matrix. Questo significa che quello che esce dalla parte destra dell’assegnazione diventerà <strong>M</strong>;</li>
<li>Usiamo la funzione mediante il suo nome seguito da una serie di input forniti all’interno di una coppia di parentesi tonde;</li>
<li>Quello che c’è tra le parentesi tonde è una serie di assegnazioni con tanto di nomi e di valori. Questa è la modalità di utilizzo più “verbose” cioè esplicita a prolissa. In realtà, potremmo omettere i nomi degli argomnti purchè li inseriamo nell’ordina in cui la funzione se li aspetta.</li>
</ul>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="base.html#cb136-1"></a><span class="co">#Genero la matrice M avente 3 righe, 2 colonne e contenente i numeri da 1 a 6</span></span>
<span id="cb136-2"><a href="base.html#cb136-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb136-3"><a href="base.html#cb136-3"></a></span>
<span id="cb136-4"><a href="base.html#cb136-4"></a><span class="co">#Utilizzo equivalente</span></span>
<span id="cb136-5"><a href="base.html#cb136-5"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>Dunque la funzione matrix, per funzionare, ha bisogno di 3 argomenti: <em>data</em>, <em>nrow</em> e <em>ncol</em>. Il significato dei loro nomi dovrebbe essere intuitivo: <em>data</em> corrisponde ai dati da inserire (i valori nelle celle della matrice), <em>nrow</em> specifica il numero di righe della matrice, <em>ncol</em> specifica il numero di colonne.
Non tutti gli argomenti di una funziona hanno la stessa importanza. Nel caso di <em>matrix</em>, la geometria della matrice da creare (cioè il suo numero di righe e di colonne) è più importante del contenuto. Ce ne accorgiamo provando a fare:</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="base.html#cb137-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb137-2"><a href="base.html#cb137-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb137-3"><a href="base.html#cb137-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   NA   NA
## [2,]   NA   NA
## [3,]   NA   NA</code></pre>
<p>L’oggetto M contiene una serie di valori tutti uguali chiamati <strong>NA</strong>. Scopriremo tra poco di cosa si tratta, ma intanto notiamo che la geometria è quella desiderata. Allo stesso modo, possiamo generare una matrice contenente valori tutti uguali (ma definiti)</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="base.html#cb139-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb139-2"><a href="base.html#cb139-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb139-3"><a href="base.html#cb139-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1
## [3,]    1    1</code></pre>
<p>In questo caso R ha popolato la matrice con tanti valori pari a 1.
E’ interessante commentare cosa succede quando l’input non è “coerente”. Ad esempio:</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="base.html#cb141-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb141-2"><a href="base.html#cb141-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(1:7, 3, 2): data length [7] is not a sub-multiple or multiple
## of the number of rows [3]</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="base.html#cb143-1"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>In questo caso abbiamo indicato a R che la matrice deve contenere i valori da 1 a 7, pur avendo 3 righe e 2 colonne (e quindi 6 celle). R, obbediente, produce un oggetto M identico a precedenti omettendo l’ultimo valore da noi indicato per l’argomento <em>data</em> (il 7), ma ci avvisa che “i conti non tornano” mediante un “warning”. Come dice il suo nome, un <strong>warning</strong> non è un errore ma un avvertimento, ma è importante fare attenzione perchè magari l’incoerenza degli argomenti è frutto di un banale errore di digitazione.
Vediamo un altro esempio:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="base.html#cb145-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb145-2"><a href="base.html#cb145-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(1:5, 3, 2): data length [5] is not a sub-multiple or multiple
## of the number of rows [3]</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="base.html#cb147-1"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    1</code></pre>
<p>Se guardiamo bene il contenuto di M, ci accorgiamo che sono presenti i numeri da 1 a 5, inseriti per colonne, ma nell’ultima cella della matrice (quella in basso a destra) compare una seconda volta il numero 1 (il primo della serie da noi indicata). Il motivo è semplice: abbiamo detto a R di generare una matrice di 6 celle ma gli abbiamo fornito solo 5 valori per riempirla. Risultato: R ha “riutilizzato” il primo valore della serie.</p>
<p>Altra cosa da dire importante sulle funzioni è che, oltre agli argomenti (indispensabili), può essere importante conoscere e padroneggiare le <strong>opzioni</strong>.
Riprendiamo l’esempio di matrix</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="base.html#cb149-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb149-2"><a href="base.html#cb149-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb149-3"><a href="base.html#cb149-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="base.html#cb151-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb151-2"><a href="base.html#cb151-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>)</span>
<span id="cb151-3"><a href="base.html#cb151-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Che differenza notiamo tra questi due comandi? Nel primo caso R ha usato la sequenza da 1 a 6 per riempire la matrice M “per colonna”, nel secondo caso lo ha fatto “per riga”. Questo ci permette di chiarire in senso generale l’uso delle opzioni: <strong>esse rappresentano dei comandi di input delle funzioni per alterarne il comportamento ma, essendo appunto opzionali, esiste una modalità “di base” (o di default come dicono gli inglesi) nell’esecuzione di ogni funzione e le opzioni hanno il potere di alterarla</strong>. Per disattivare un’opzione dobbiamo porla uguale a FALSE, se la vogliamo attivare la dobbiamo porre uguale a TRUE. Questa è un’altra peculiarità delle opzioni: sono delle variabili booleane e possono assumere solo due valori, TRUE e FALSE appunto.
Se comprendiamo questo, possiamo facilmente intuire perchè le opzioni sono sempre per definizione disattive e siamo noi a doverle “attivare”.</p>
<p>Ad esempio:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="base.html#cb153-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb153-2"><a href="base.html#cb153-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb153-3"><a href="base.html#cb153-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="base.html#cb155-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb155-2"><a href="base.html#cb155-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>)</span>
<span id="cb155-3"><a href="base.html#cb155-3"></a>M</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Questi due comandi producono risultati identici perchè sono identici: nel secondo caso l’opzione <em>byrow</em> è espressamente ed esplicitamente annullata dall’utente, nel primo lo è perchè quello è lo stato predefinito di ogni opzione.
Questo punto ci fornisce l’appiglio per introdurre una nuova, semplice funzione: <strong>sum</strong>. Come dice il suo nome, la funzione <strong>sum</strong> calcola la somma degli oggetti che le vengono forniti come input, indipendentemente dalla loro geometria (possono essere vettori o matrici o array) ma non dal loro tipo (la somma è definita solo per le quantità integer e numeric, non per quelle factor o character o per le altre).
Quindi:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="base.html#cb157-1"></a><span class="co">#Genero la matrice M &quot;vuota&quot; avente 3 righe, 2 colonne </span></span>
<span id="cb157-2"><a href="base.html#cb157-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb157-3"><a href="base.html#cb157-3"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M)</span>
<span id="cb157-4"><a href="base.html#cb157-4"></a>SM</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="base.html#cb159-1"></a><span class="co">#Genero il vettore V avente 5 elementi numerici</span></span>
<span id="cb159-2"><a href="base.html#cb159-2"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb159-3"><a href="base.html#cb159-3"></a>SV &lt;-<span class="st"> </span><span class="kw">sum</span>(V)</span>
<span id="cb159-4"><a href="base.html#cb159-4"></a>SV</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>Ok? Allora adesso introduciamo volutamente un esempio “rognoso”:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="base.html#cb161-1"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb161-2"><a href="base.html#cb161-2"></a>V</span></code></pre></div>
<pre><code>## [1]  1  3  5 -2  3  7</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="base.html#cb163-1"></a>V &lt;-<span class="st"> </span><span class="kw">sqrt</span>(V)</span></code></pre></div>
<pre><code>## Warning in sqrt(V): Si è prodotto un NaN</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="base.html#cb165-1"></a>V</span></code></pre></div>
<pre><code>## [1] 1.000000 1.732051 2.236068      NaN 1.732051 2.645751</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="base.html#cb167-1"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(V, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb167-2"><a href="base.html#cb167-2"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M)</span>
<span id="cb167-3"><a href="base.html#cb167-3"></a>SM</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<p>Analizziamo il pasticcio che abbiamo combinato:</p>
<ul>
<li>Abbiamo definito il vettore V come composto da 6 elementi numerici, di cui uno negativo</li>
<li>Abbiamo usato la semplice funzione <strong>sqrt</strong> (acronimo di <em>square root</em>) per calcolare le radici quadrate dei valori di V</li>
<li>Siccome non esiste un numero reale che corrisponda alla radice quadrata di un negativo, il nuovo vettore V contiene un valore “strano” che non abbiamo mai incontrato: <strong>NaN</strong> (acronimo di not-a-number)</li>
<li>Siamo andati avanti generando la matrice M come se nulla fosse…</li>
<li>Quando abbiamo calcolato il valore della somma SM di M, abbiamo ottenuto una brutta risposta: ancora un NaN!!!!</li>
</ul>
<p>Perchè ci siamo andati a impelagare in questa brutta storia? Per mostrare che la funzione <em>sum</em> ha un’utilissima (ma pericolosa!) opzione denominata <strong>na.rm</strong>. Proviamo ad attivarla:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="base.html#cb169-1"></a>V &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">-2</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb169-2"><a href="base.html#cb169-2"></a>V &lt;-<span class="st"> </span><span class="kw">sqrt</span>(V)</span></code></pre></div>
<pre><code>## Warning in sqrt(V): Si è prodotto un NaN</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="base.html#cb171-1"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(V, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb171-2"><a href="base.html#cb171-2"></a>SM &lt;-<span class="st"> </span><span class="kw">sum</span>(M, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb171-3"><a href="base.html#cb171-3"></a>SM</span></code></pre></div>
<pre><code>## [1] 9.345921</code></pre>
<p>Questa volta abbiamo ottenuto un valore “buono” della somma di M. Se facciamo due calcoli a mente possiamo facilmente dedurre che esso corrisponde alla somma di tutti i valori di M tranne quello strano e brutto NaN, con il quale faremo conoscenza tra poco. Adesso però ci interessa un’altra cosa: l’opzione <em>na.rm</em> sta per “remove NA or NaN”, e quindi significa autorizzare la funzione a far finta che non ci siano valori strani. Quindi, attivandola, abbiamo detto a R di calcolare la somma solo sugli altri valori. A questo punto qualcuno di voi lettori si starà chiedendo: e perchè mai questa fantastica opzione è disattiva di default e dobbiamo attivarla noi? Non sarebbe meglio se fosse sempre accesa e ci proteggesse da risultati brutti? La risposta è NO, non sarebbe affatto meglio, perchè il fatto che i nostri calcoli si inceppino ogni volta che da qualche parte compare un valore strano è un ottimo modo per costringerci a ricontrollare le nostre procedure e fare in modo che siano il più generali e versatili possibili. Per esempio, vogliamo risolvere un problema ma non prendiamo in considerazione che i valori di alcune variabili possono assumere valori negativi. Se così è, e da qualche parte nel nostro codice usiamo funzioni non definite sull’insieme R dei numeri reali (come la radice quadrata o il logaritmo) ci imbatteremo in un valore anomalo e saremmo naturalmente portati a rimediare.</p>
<p><img src="Images/01-09.png" />
Ci soffermiamo ora su un altro aspetto essenziale delle funzioni. Mi riferisco al fatto che ciascuna di esse vive e opera in un sottoambiente di quello principale, cioè la sessione di lavoro all’interno della quale stiamo operando. Vediamo cosa significa con un esempio:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="base.html#cb173-1"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb173-2"><a href="base.html#cb173-2"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb173-3"><a href="base.html#cb173-3"></a><span class="kw">sum</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="base.html#cb175-1"></a>x</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="base.html#cb177-1"></a>y</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Sebbene avessimo definito x e y con valori pari a 5 e 3, la somma (in cui abbiamo ri-definito i valori di x e di y), ci ha restituito come somma 0. Inoltre, nell’ambiente principale i valori di x e di y sono rimasti quelli “originali”. Questa ultima cosa dipende dal fatto che, all’interno della funzione <strong>sum</strong>, abbiamo usato l’uguale (=) invece dell’assegnazione (&lt;-). Infatti, se facciamo il contrario:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="base.html#cb179-1"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb179-2"><a href="base.html#cb179-2"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb179-3"><a href="base.html#cb179-3"></a><span class="kw">sum</span>(x &lt;-<span class="st"> </span><span class="dv">5</span>, y &lt;-<span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="base.html#cb181-1"></a>x</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="base.html#cb183-1"></a>y</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>scopriamo che ora il valore di y è cambiato anche nell’ambiente principale. <strong>Questo è il motivo per cui, nell’ambito delle “buona pratiche” che affronteremo più avanti, è sempre proibito fare assegnazioni nello sviluppo di codici e pacchetti: si rischia di fare un pasticcio tremendo quando le si utilizza perchè si rischia di sovrascrivere quantità e oggetti dell’ambiente principale</strong>.</p>
</div>
<div id="Matrioske" class="section level2">
<h2><span class="header-section-number">4.10</span> Il mondo “a matrioske”</h2>
<p>Il mondo delle funzioni di R è fatto come le famose bambole russe, nel senso che ogni funzione generalmente può accettare, al posto dei sui argomenti, delle altre funzioni, a patto che restituiscano oggetti coerenti con gli input attesi dalla funzione di Rango superiore.</p>
<div class="figure">
<img src="Images/01-10.png" alt="" />
<p class="caption">Fonte:<a href="https://cdn.pixabay.com/photo/2019/03/27/09/01/matryoshka-4084557_1280.jpg" class="uri">https://cdn.pixabay.com/photo/2019/03/27/09/01/matryoshka-4084557_1280.jpg</a></p>
</div>
<p>Se, ad esempio, volessi generare una matrice che contiene come elementi i valori restituiti dalla funzione somma, scriverò:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="base.html#cb185-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">9</span></span>
<span id="cb185-2"><a href="base.html#cb185-2"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sum</span>(x), <span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>In questo caso, la matrice m è rimpita con il solo valore 9, cioè l’output della funzione sum applicata al vettore x. Come avevamo già detto, quello che avviene dentro le funzioni di rango più basso non si riflette (se non tramite i risultati) sulle funzioni di rango più elevato. Ancora un esempio:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="base.html#cb186-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">9</span></span>
<span id="cb186-2"><a href="base.html#cb186-2"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sum</span>(x), <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb186-3"><a href="base.html#cb186-3"></a>s &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">matrix</span>(<span class="kw">sum</span>(x), <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb186-4"><a href="base.html#cb186-4"></a>s</span></code></pre></div>
<pre><code>## [1] 405</code></pre>
<p>In questo semplice esercizio abbiamo “annidato” tre funzioni una dentro l’altra, ottenento il valore finale di s.
Il grande vantaggio di questa potenzialità di R è che ci consente di risparmiare sugli oggetti (e i relativi nomi) che è necessario generare. Il prezzo è che, con strutture molto complesse a annidate, può essere difficile modificare il codice o correggerlo.</p>
</div>
<div id="Calcolo" class="section level2">
<h2><span class="header-section-number">4.11</span> La frontiera del calcolo: NA e NaN</h2>
<p>Abbiamo recentemente fatto la sgradevole conoscenza del <em>NaN</em>. Questa quantità, “<em>not-a-number</em>”, viene fuori quanto facciamo calcoli che non sono definiti nell’insieme dei numeri Reali.
Quindi:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="base.html#cb188-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb188-2"><a href="base.html#cb188-2"></a><span class="kw">log</span>(x)</span></code></pre></div>
<pre><code>## [1] -Inf</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="base.html#cb190-1"></a>x &lt;-<span class="st"> </span><span class="dv">-5</span></span>
<span id="cb190-2"><a href="base.html#cb190-2"></a><span class="kw">sqrt</span>(x)</span></code></pre></div>
<pre><code>## Warning in sqrt(x): Si è prodotto un NaN</code></pre>
<pre><code>## [1] NaN</code></pre>
<p>Ora completiamo l’opera con la conoscenza dei <strong>NA</strong>, che sono ancora più antipatici. <strong>NA</strong> sta per “<em>not_assigned</em>”, cioè quantità non definita. Ecco alcuni esempi di come può saltare fuori:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="base.html#cb193-1"></a>x &lt;-<span class="st"> &quot;Testo&quot;</span></span>
<span id="cb193-2"><a href="base.html#cb193-2"></a><span class="kw">as.numeric</span>(x)</span></code></pre></div>
<pre><code>## Warning: si è prodotto un NA per coercizione</code></pre>
<pre><code>## [1] NA</code></pre>
<p>In questo caso abbiamo generato un <strong>NA</strong> chiedendo a R di coercire come numerico una quantità testo, il che letteralmente non ha alcun senso. Più in generale, i <strong>NA</strong> sono il classico caso di “dato mancante”. Se si trovano all’interno di un oggetto, i <strong>NA</strong> devono essere interpretati e trattati come dei “buchi”, a differenza dei <strong>NaN</strong> che sono “valori impossibili”.
La presenza dei <strong>NA</strong> in un codice sono generalmente un sintomo del fatto che la procedura non è abbastanza generale (poichè la presenza di buchi vuol dire spesso che ci sono condizioni che non si realizzano mai, per esempio selezioni che restituiscono un insieme vuoto) e che quindi non è adatta ai dati.
Come abbiamo visto, R non nasconde la polvere sotto il tappeto (a meno che non lo invitiamo a farlo), per cui la graduale eliminazione dei passaggi che generano dei <strong>NA</strong> o dei <strong>NaN</strong> rappresenta una normale fase di revisione e debugging del codice.</p>
</div>
<div id="Boole" class="section level2">
<h2><span class="header-section-number">4.12</span> Operatori relazionali e algebra di Boole</h2>
<p>Sull’opera immortale di <strong>George Boole</strong> è stato scritto tanto, ma mai a sufficienza. Nessuno più di lui ha contribuito a gettare le basi della computazione elettonica. Tanto è vero che la sua <strong>Algebra</strong> è fondamentale anche (e ancora) per noi. Alla base di tutto c’è che le quantità che maneggiamo sono sempre tradotte, nel profondo dei nostri pc, in quantità binarie. Come nelle sinapsi del nostro cervello, i microchip dei nostri processori riduco la realtà a sequenze di stati <strong>acceso-spento</strong>.</p>
<p><img src="Images/01-11.png" /></p>
<p>La prova sta nel fatto che le quantità booleane le abbiamo già incontrate: sono le quantità di tipo <strong>logical</strong>. Adesso dobbiamo generalizzare a problemi più complessi, per esempio la <strong>verifica di condizioni</strong> all’interno di funzioni o algoritmi. Per farlo, prima dobbiamo prendere in rassegna la sintassi degli operatori booleani in R:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="base.html#cb196-1"></a>dB =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Operatore =</span> <span class="kw">c</span>(<span class="st">&quot;==&quot;</span>, <span class="st">&quot;&gt;&quot;</span>, <span class="st">&quot;&lt;&quot;</span>, <span class="st">&quot;&gt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="st">&quot;&amp;&quot;</span>, <span class="st">&quot;|&quot;</span>),</span>
<span id="cb196-2"><a href="base.html#cb196-2"></a>                <span class="dt">Significato =</span> <span class="kw">c</span>(<span class="st">&quot;uguale&quot;</span>, <span class="st">&quot;maggiore&quot;</span>, <span class="st">&quot;minore&quot;</span>, <span class="st">&quot;maggiore o uguale&quot;</span>,</span>
<span id="cb196-3"><a href="base.html#cb196-3"></a>                                <span class="st">&quot;minore o uguale&quot;</span>, <span class="st">&quot;negazione&quot;</span>,<span class="st">&quot;and&quot;</span>,<span class="st">&quot;or&quot;</span>))</span>
<span id="cb196-4"><a href="base.html#cb196-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb196-5"><a href="base.html#cb196-5"></a>  dB, <span class="dt">caption =</span> <span class="st">&#39;Gli operatori booleani in R&#39;</span>,</span>
<span id="cb196-6"><a href="base.html#cb196-6"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb196-7"><a href="base.html#cb196-7"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab5">Table 4.2: </span>Gli operatori booleani in R</caption>
<thead>
<tr class="header">
<th align="left">Operatore</th>
<th align="left">Significato</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">==</td>
<td align="left">uguale</td>
</tr>
<tr class="even">
<td align="left">&gt;</td>
<td align="left">maggiore</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">minore</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">maggiore o uguale</td>
</tr>
<tr class="odd">
<td align="left">&lt;=</td>
<td align="left">minore o uguale</td>
</tr>
<tr class="even">
<td align="left">!</td>
<td align="left">negazione</td>
</tr>
<tr class="odd">
<td align="left">&amp;</td>
<td align="left">and</td>
</tr>
<tr class="even">
<td align="left">|</td>
<td align="left">or</td>
</tr>
</tbody>
</table>
<p>Vediamo ora alcune loro semplici applicazioni, in modo da spiegare in maniera intuitiva il loro utilizzo</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="base.html#cb197-1"></a><span class="co">#Definisco le quantità x e y e faccio a R una serie di domande</span></span>
<span id="cb197-2"><a href="base.html#cb197-2"></a>x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb197-3"><a href="base.html#cb197-3"></a>y &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb197-4"><a href="base.html#cb197-4"></a>x <span class="op">&gt;</span><span class="st"> </span>y <span class="co">#x è maggiore di y</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="base.html#cb199-1"></a>x <span class="op">&lt;</span><span class="st"> </span>y <span class="co">#x è minore di y</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="base.html#cb201-1"></a><span class="op">!</span>(x <span class="op">==</span><span class="st"> </span>y) <span class="co"># negazione di (x è uguale a y)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="base.html#cb203-1"></a>(x <span class="op">==</span><span class="st"> </span>y) <span class="op">&amp;</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span>y) <span class="co"># (x è uguale a y) and (x è maggiore di y)</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="base.html#cb205-1"></a>(x <span class="op">==</span><span class="st"> </span>y) <span class="op">|</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span>y) <span class="co"># (x è uguale a y) or (x è maggiore di y)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Prestiamo attenzione agli esempi precedenti perchè abbiamo introdotto alcune cose importanti:
* Si possono scrivere semplici <strong>espressioni</strong> proprie dall’Algebra di Boole, ovvero quantità logiche che possono essere solo o vere (TRUE) o false (FALSE) senza ambiguità e complicazioni ulteriori.
* In risposta a queste semplici espressioni, R ci restituisce TRUE o FALSE
* <strong>Se vogliamo usare la negazione o combinare insieme più espressioni dobbiamo racchiuderle tra tonde perchè, di fatto, ogni singola espressione è una piccola funzione</strong></p>
<p>E’ chiaro che tutto questo può esserci utile soltanto se ricordiamo l’Algebra di Boole e, in particolare, le tabelle di verità degli indicatori che si usano per mettere insieme più espressioni.</p>
<p>Questa è la tabella di verità per AND (&amp;):</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="base.html#cb207-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">Espressione1 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb207-2"><a href="base.html#cb207-2"></a>                        <span class="dt">Espressione2 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb207-3"><a href="base.html#cb207-3"></a>                        <span class="dt">Valore =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>)), </span>
<span id="cb207-4"><a href="base.html#cb207-4"></a>             <span class="dt">caption =</span> <span class="st">&quot;Tabella di verità dell&#39;operatore AND&quot;</span>,</span>
<span id="cb207-5"><a href="base.html#cb207-5"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb207-6"><a href="base.html#cb207-6"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab6">Table 4.3: </span>Tabella di verità dell’operatore AND</caption>
<thead>
<tr class="header">
<th align="left">Espressione1</th>
<th align="left">Espressione2</th>
<th align="left">Valore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Questa è la tabella di verità per OR (|):</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="base.html#cb208-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">Espressione1 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb208-2"><a href="base.html#cb208-2"></a>                        <span class="dt">Espressione2 =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb208-3"><a href="base.html#cb208-3"></a>                        <span class="dt">Valore =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;TRUE&quot;</span>,<span class="st">&quot;FALSE&quot;</span>)), </span>
<span id="cb208-4"><a href="base.html#cb208-4"></a>             <span class="dt">caption =</span> <span class="st">&quot;Tabella di verità dell&#39;operatore OR&quot;</span>,</span>
<span id="cb208-5"><a href="base.html#cb208-5"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb208-6"><a href="base.html#cb208-6"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab7">Table 4.4: </span>Tabella di verità dell’operatore OR</caption>
<thead>
<tr class="header">
<th align="left">Espressione1</th>
<th align="left">Espressione2</th>
<th align="left">Valore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Per capire l’utilità dell’Algebra di Boole in R possiamo usare alcuni semplici esempi:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="base.html#cb209-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb209-2"><a href="base.html#cb209-2"></a>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span></code></pre></div>
<pre><code>## [1] 9 4 6 7 3 3 1</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="base.html#cb211-1"></a>x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>]</span></code></pre></div>
<pre><code>## [1]  -7 -14</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="base.html#cb213-1"></a>x[x <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 3 3</code></pre>
<p>Dopo aver generato il vettore <em>x</em>, composto di 10 valori numerici, usiamo le parentesi <strong>quadre</strong> per racchiudere un’espressione che ci permetta di selezione, usando l’algebra di Boole, alcuni degli elementi di x. In questi esempi, estraiamo gli elementi di x che sono positivi, o negativi, o uguali al valore 3.
Si tratta ovviamente di esempi molto semplici. Ma la logica da utilizzare per combinazioni più complesse è esattamente la stessa… ma per applicarla dobbiamo fare conoscenza con la funzione <strong>which</strong>.</p>
<p>La funzione <strong>which</strong> serve per combinare più condizioni usando gli operatori di Boole.
Immaginiamo di voler estrarre da x, in un colpo solo, gli elementi maggiori di 3 o minori di -3.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="base.html#cb215-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb215-2"><a href="base.html#cb215-2"></a>x[<span class="kw">which</span>((x <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)<span class="op">|</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">-3</span>))]</span></code></pre></div>
<pre><code>## [1]   9   4   6  -7   7 -14</code></pre>
<p>Naturalmente dobbiamo prestare grande attenzione alla struttura annidata delle parentesi e alla sintassi.
Infatti, nel comando precedente, ci sono due condizioni che devono essere valutate, cioè <strong>(x &gt; 3)</strong> e <strong>(x &lt; -3)</strong>. Poichè esse sono collegate dall’operatore booleano OR (|), è sufficiente che una sola di esse sia soddisfatta.
<strong>which</strong> è, in effetti, una funzione estremamente utile e frequente, che ci permette di assemblare condizioni anche molto complesse.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="base.html#cb217-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>)</span>
<span id="cb217-2"><a href="base.html#cb217-2"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<p>In questo esempio abbiamo “rovesciato” la selezione precedente, e quindi abbiamo scelto di estrarre i valori compresi tra -3 e 3 ma con l’esclusione dello zero.
Si noti che le due condizioni <strong>((x &lt;= 3)&amp;(x &gt;= -3))</strong> sono racchiuse da una coppia di graffe e quindi il risultato di questa espressione viene prima calcolato e poi combinato con quello dell’espressione <strong>(x != 0)</strong>. Le due espressioni <strong>(x &lt;= 3)</strong> e <strong>(x &gt;= -3)</strong> hanno quindi la precedenza e un livello più basso, mentre il loro risultato è di pari livello rispetto a <strong>(x != 0)</strong>.
La funzione <strong>which</strong> ha anche una opzione molto importante, che si chiama <strong>arr.ind</strong> (contrazione di array indexes). Per assimilarla, facciamo un esempio riferito a una matrice</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="base.html#cb219-1"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">-7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">-14</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb219-2"><a href="base.html#cb219-2"></a></span>
<span id="cb219-3"><a href="base.html#cb219-3"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="base.html#cb221-1"></a>x[<span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">arr.ind =</span> T)]</span></code></pre></div>
<pre><code>## [1] 3 3 1</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="base.html#cb223-1"></a><span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 6 7 8</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="base.html#cb225-1"></a><span class="kw">which</span>(((x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>)<span class="op">&amp;</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span>))<span class="op">&amp;</span>(x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">arr.ind =</span> T)   </span></code></pre></div>
<pre><code>##      row col
## [1,]   1   2
## [2,]   2   2
## [3,]   3   2</code></pre>
<p>L’utilizzo dell’opzione <strong>arr.ind</strong> non cambia il risultato dell’indicizzazione di <em>x</em>, ma cambia <strong>la forma</strong> in cui la funzione <strong>which</strong> ci restituisce gli <strong>indici di posizione</strong> degli elementi di <em>x</em> che soddisfano la condizione specificata. Se <strong>arr.ind</strong> disattiva, <strong>which</strong> tratta tutti gli oggetti (anche le matrici) come dei vettori, e dunque il risultato che ci fornisce è vettoriale. Se *<strong>arr.ind</strong> è attiva e stiamo lavorando su una matrice, <strong>which</strong> ci restituisce delle coordinate in due dimensioni: riga e colonna degli elementi di <em>x</em> che soddisfano la condizione desiderata.</p>
</div>
<div id="luso-dellhelp" class="section level2">
<h2><span class="header-section-number">4.13</span> L’uso dell’Help</h2>
<p>Fino a questo punto, abbiamo <em>subdolamente</em> introdotto alcune funzioni di base di R (matrix, which, sum,…) illustrandone le principali caratteristiche. Queste e altre funzioni fanno parte del vocabolario di base che un neofita di R deve assimilare, ma ce ne sono tante altre che si aggiungono via via ed è evidente che dobbiamo capire come si fa ad apprendere il loro utilizzo (in maniera possibilmente rapida). La risposta è: <strong>usando l’help di R</strong>! L’Help di R è un interfaccia brutto e apparentemente antipatico. Però, a dispetto delle apparenze, è uno strumento estramemente versatile e completo, e quindi imparare a usarlo ci permette di procedere rapidamente con il nostro <em>self training</em>.</p>
<p><img src="Images/01-12.png" /></p>
<p>Per fare la sua conoscenza, proviamo a digitare da terminale il nome di una funzione preceduto dal punto interrogativo:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="base.html#cb227-1"></a>?sum</span>
<span id="cb227-2"><a href="base.html#cb227-2"></a>?which    </span>
<span id="cb227-3"><a href="base.html#cb227-3"></a>?matrix</span></code></pre></div>
<p>L’help di qualsiasi funzione di R è organizzato secondo le seguenti voci (per comodità ci riferiremo all’help della funzione <em>matrix</em>):</p>
<ol style="list-style-type: decimal">
<li>Il nome della funzione: <strong>matrix {base}</strong></li>
<li>Il titolo dell’help: <strong>Matrices</strong></li>
<li>Una breve e concisa (occhio ai termini usati) descrizione della funzione: <strong>Description</strong></li>
<li>Un esempio generico ma completo del suo utilizzo: <strong>Usage</strong></li>
<li>Una dettagliata descrizione degli argomenti necessari e delle opzioni: <strong>Arguments</strong></li>
<li>Una articolata descrizione di cosa fa la funzione: <strong>Details</strong></li>
<li>Alcune annotazioni: <strong>Note</strong></li>
<li>I riferimenti alla letteratura (soprattutto se si tratta di una metodo scientifico): <strong>References</strong></li>
<li>Un elenco delle funzioni che sono “apparentate” con la nostra funzione: <strong>See Also</strong></li>
<li>Una serie di esempi pratici: <strong>Examples</strong></li>
</ol>
<p>Il nome della funzione (1) è sempre associato al nome del pacchetto, riportato tra parentesi graffe. Per adesso abbiamo incontrato solo funzione del pacchetto <em>base</em>, ma via via ne useremo molte altre disponibili mediante pacchetti aggiuntivi.
Il titolo della funzione (2), da non confondere con il <strong>nome</strong> della funzione, è semplicemente una denominazione immediata ed esplicita di quello che la funzione serve a fare.
La descrizione (3) è una breve frase, basata sull’utilizzo di termini precisi e con un chiaro significato nel contesto di R, di come lavora la funzione e di quello che ci consente di fare.
La voce <strong>Usage</strong> (4) è probabilmente la più diretta, utile e efficare voce dell’help. Mano mano che si diventa esperti di R si impara a usare nuove funzioni scorrendo rapidamente il loro help e intuendone l’utilizzo proprio dalla voce usage. Essa ci indica immediatamente quali sono gli argomenti (gli input) necessari per far funzionare la funzione, ma ci dice anche si comporterà la funzione nel caso in cui non indichiamo esplicitamente alcuni argomenti. Ad esempio, nel caso della funzione matrix, ci dice che essa si aspetta 3 argomenti: <em>data</em>, <em>nrow</em> e <em>ncol</em>. Tuttavia, in assenza di indicazioni dell’utente, la funzione userà NA come valore di default dell’argomento <em>data</em>, e 1 come valore di <em>nrow</em> ed <em>ncol</em>. Vediamo tre esempi:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="base.html#cb228-1"></a><span class="kw">matrix</span>(,<span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   NA   NA   NA
## [2,]   NA   NA   NA
## [3,]   NA   NA   NA</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="base.html#cb230-1"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)</span></code></pre></div>
<pre><code>##       [,1]
##  [1,]    1
##  [2,]    2
##  [3,]    3
##  [4,]    4
##  [5,]    5
##  [6,]    6
##  [7,]    7
##  [8,]    8
##  [9,]    9</code></pre>
<p>Nel primo caso otteniamo una matrice di 3 righe e 3 colonne piena di NA. Nel secondo caso abbiamo assegnato a <em>data</em> il vettore 1:9, quindi la funzione deve disporre 9 valori in qualche modo…. ma, essendo prioritario l’argomento <em>nrow</em>, la funzione genera un vettore colonna.
Un aspetto importante è che ogni funzione di R si accontenta di avere i valori degli argomenti anche senza l’assegnazione al loro nome predefinito. Quindi se scriviamo:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="base.html#cb232-1"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    2    6   10
## [3,]    3    7   11
## [4,]    4    8   12</code></pre>
<p>R capirà che 1:9 è riferito a <em>data</em>, mentre 4 e 3 sono riferiti rispettivamente a <em>nrow</em> ed <em>ncol</em>. Quindi la voce usage ci dice anche in che ordine fornire gli argomenti alla funzione che ci interessa.
Se vogliamo fornirli in ordine differente, però, (come può capitare con funzioni che hanno tanti argomenti) possiamo farlo usando nomi e assegnazioni. Ad esempio:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="base.html#cb234-1"></a><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    2    6   10
## [3,]    3    7   11
## [4,]    4    8   12</code></pre>
<p>Ci fornisce lo stesso identico risultato di prima.
La voce <strong>Arguments</strong> (5), comunque, ci può tornare utile se non abbiamo subito chiara la natura degli argomenti necessari, ad esempio di quale classe (vettore? matrice? lista?) essi devono essere. Allo stesso tempo, questa voce dell’help ci spieg bene a cosa servono le opzioni.</p>
<p>La voce <strong>Details</strong> (6) ci illustra il razionale della funzione, cioè quali procedure ci sono alla sua base, ma ci indica anche cosa attenderci in casi “particolari”. Nel caso della funzione matrix, la voce Details ci spiega che, quando la dimensione dell’argomento <em>data</em> non corrisponde al numero di celle della matrice, R prova ad “adattare i dati”, ad esempio riciclando gli elementi di <em>data</em> se sono meno di quelli attesi. Vediamo un esempio:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="base.html#cb236-1"></a><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(data = 1:9, nrow = 4, ncol = 3): data length [9] is not a sub-
## multiple or multiple of the number of rows [4]</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    2    6    1
## [3,]    3    7    2
## [4,]    4    8    3</code></pre>
<p>In questo caso abbiamo generato una matrice di 4 righe e 3 colonne, e quindi di 12 elementi, ma abbiamo fornito un vettore di soli 9 elementi come argomento <em>data</em>. Come si può intuire, R ha ricominciato da capo e dopo il 9 ha usato i valori 1, 2 e 3.
Sulle voci <strong>Note</strong>, <strong>References</strong> e <strong>See Also</strong> non ci dilunghiamo perchè sono davvero molto intuitive.</p>
</div>
<div id="una-cassetta-degli-attrezzi-essenziali" class="section level2">
<h2><span class="header-section-number">4.14</span> Una cassetta degli attrezzi essenziali</h2>
<p>In questa sezione faremo conoscenza, anche mediante alcuni esempi, con una seria di funzioni del pacchetto <em>base</em> di R. Conoscerle è utile per due motivi:</p>
<ul>
<li>ci permette di avere gli strumenti di base per cominciare a usare sul serio R</li>
<li>ci allena ad apprendere in modo autonomo l’utilizzo di qualsiasi altra funzione.</li>
</ul>
<p>Nella figura seguente sono rappresentate alcune delle funzioni del pacchetto <em>base</em>, arbitrariamente raggruppate sulla base di 7 diverse tipologie (tratteremo a parte le principali funzioni per fare grafici):</p>
<ul>
<li>Ramo <span style="color:blue">Funzioni per generare oggetti</span></li>
<li>Ramo <span style="color:red">Funzioni per esplorare gli oggetti</span></li>
<li>Ramo <span style="color:LawnGreen">Funzioni per la combinazione di oggetti</span></li>
<li>Ramo <span style="color:DarkKhaki">Funzioni statistiche di base</span></li>
<li>Ramo <span style="color:DarkGreen">Funzioni per salvare i grafici</span></li>
<li>Ramo <span style="color:GoldenRod">Funzioni per leggere/salvare file di testo</span></li>
<li>Ramo <span style="color:darkgrey">Funzioni per leggere/salvare dati nel formato R</span></li>
</ul>
<p><img src="Images/01-13.png" />
Prendiamole in considerazione, illustrandone brevemente le caratteristiche e l’utilizzo.</p>
<div id="c" class="section level3">
<h3><span class="header-section-number">4.14.1</span> c</h3>
<p>E’ la funzione più semplice e infatti è una delle prima che abbiamo incontato. Gli input di questa funzione sono gli oggetti da unire per creare il vettore, e sono messi insieme nella stessa sequenza con cui vengono menzionati come argomenti.
Serve a generare dei vettori che avranno, però, tutti gli oggetti appartenenti alla stessa classe. Questo vuol dire che, se forniamo a <strong>c</strong> argomenti di classi diverse, alcuni di loro saranno <em>coerciti</em> a diventare di classi diverse. Questo avviene secondo una logica intuitiva: se mescolo numeri e caratteri, avrò un vettore di solo caratteri (perchè non avrebbe senso trasformare i valori <em>character</em> in <em>numeric</em>).</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="base.html#cb239-1"></a>vector_character =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb239-2"><a href="base.html#cb239-2"></a>vector_numeric =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb239-3"><a href="base.html#cb239-3"></a></span>
<span id="cb239-4"><a href="base.html#cb239-4"></a><span class="kw">c</span>(vector_numeric, vector_character)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;A&quot; &quot;B&quot;</code></pre>
<p>Invece ha senso convertire i livelli di un <em>factor</em> in una serie di valori ordinali</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="base.html#cb241-1"></a>vector_factor =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb241-2"><a href="base.html#cb241-2"></a>vector_numeric =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb241-3"><a href="base.html#cb241-3"></a></span>
<span id="cb241-4"><a href="base.html#cb241-4"></a><span class="kw">c</span>(vector_numeric, vector_factor)</span></code></pre></div>
<pre><code>## [1] 4 5 6 1 2</code></pre>
<p>Infine, un <em>factor</em> mescolato a un <em>character</em> sarà prima convertito in <em>numeric</em> e poi in un carattere.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="base.html#cb243-1"></a>vector_factor =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb243-2"><a href="base.html#cb243-2"></a>vector_character =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb243-3"><a href="base.html#cb243-3"></a></span>
<span id="cb243-4"><a href="base.html#cb243-4"></a><span class="kw">c</span>(vector_factor, vector_character)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;A&quot; &quot;B&quot;</code></pre>
</div>
<div id="numeric" class="section level3">
<h3><span class="header-section-number">4.14.2</span> numeric</h3>
<p>La funzione per creare vettore di numeri. L’argomento della funzione è la lunghezza del vettore che vogliamo generare. Indipendentemente dalla lunghezza, il vettore sarà costituito solo da zeri. Ha due cugini di cui <strong>as.numeric</strong> è spesso usato per coercire oggetti di classe diversa da <em>numeric</em> in vettori numerici. Se questa operazione non ha senso, la funzione <strong>as.numeric</strong> restituirà una serie di NA.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="base.html#cb245-1"></a><span class="kw">numeric</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="base.html#cb247-1"></a><span class="kw">numeric</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="base.html#cb249-1"></a>vector_factor =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb249-2"><a href="base.html#cb249-2"></a><span class="kw">as.numeric</span>(vector_factor)</span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="base.html#cb251-1"></a>vector_character =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb251-2"><a href="base.html#cb251-2"></a><span class="kw">as.numeric</span>(vector_character)</span></code></pre></div>
<pre><code>## Warning: si è prodotto un NA per coercizione</code></pre>
<pre><code>## [1] NA NA</code></pre>
</div>
<div id="character" class="section level3">
<h3><span class="header-section-number">4.14.3</span> character</h3>
<p>Questa funzione si comporta esattamente come la funzione <em>numeric</em>: il suo unico argomento è la lunghezza del vettore di caratteri da generare, che sarà formato da stringhe vuote.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="base.html#cb254-1"></a><span class="kw">character</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<p>La funzione con essa imparentata, <em>as.character</em>, trasforma tutto quello che le si da come argomento in una seguenza di stringhe.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="base.html#cb256-1"></a>vector_factor =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb256-2"><a href="base.html#cb256-2"></a>vector_numeric =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb256-3"><a href="base.html#cb256-3"></a></span>
<span id="cb256-4"><a href="base.html#cb256-4"></a><span class="kw">as.character</span>(vector_numeric)</span></code></pre></div>
<pre><code>## [1] &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="base.html#cb258-1"></a><span class="kw">as.character</span>(vector_factor)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot;</code></pre>
</div>
<div id="list" class="section level3">
<h3><span class="header-section-number">4.14.4</span> list</h3>
<p>Si tratta della funzione per assembrale delle liste, ed è molto semplice da usare: è sufficiente fornirle in input gli oggetti che formeranno gli elementi della lista. Si può decidere di nominarli oppure di non farlo, a seconda delle esigenze.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="base.html#cb260-1"></a>vector_factor =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb260-2"><a href="base.html#cb260-2"></a>vector_numeric =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb260-3"><a href="base.html#cb260-3"></a>vector_character =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb260-4"><a href="base.html#cb260-4"></a></span>
<span id="cb260-5"><a href="base.html#cb260-5"></a><span class="kw">list</span>(vector_factor, vector_numeric, vector_character)</span></code></pre></div>
<pre><code>## [[1]]
## [1] a b
## Levels: a b
## 
## [[2]]
## [1] 4 5 6
## 
## [[3]]
## [1] &quot;A&quot; &quot;B&quot;</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="base.html#cb262-1"></a><span class="kw">list</span>(<span class="dt">fattori =</span> vector_factor, </span>
<span id="cb262-2"><a href="base.html#cb262-2"></a>     <span class="dt">numeri =</span> vector_numeric, </span>
<span id="cb262-3"><a href="base.html#cb262-3"></a>     <span class="dt">caratteri =</span> vector_character)</span></code></pre></div>
<pre><code>## $fattori
## [1] a b
## Levels: a b
## 
## $numeri
## [1] 4 5 6
## 
## $caratteri
## [1] &quot;A&quot; &quot;B&quot;</code></pre>
</div>
<div id="matrix" class="section level3">
<h3><span class="header-section-number">4.14.5</span> matrix</h3>
<p>Abbiamo già incontrato questa funzione. Essa vuole come argomenti obbligati la geometria della matrice da generare, in termini di numero di righe e numero di colonne, e il contenuto della matrice stessa (a meno che non ci accontentiamo che sia piena di NA).
Come nel caso dei vettori, anche le matrice possono contenere solo oggetti che appartengono alla stessa classe.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="base.html#cb264-1"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="base.html#cb266-1"></a><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;f&quot;</span>,<span class="st">&quot;g&quot;</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;), 3, 3): data length [7]
## is not a sub-multiple or multiple of the number of rows [3]</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,] &quot;a&quot;  &quot;d&quot;  &quot;g&quot; 
## [2,] &quot;b&quot;  &quot;e&quot;  &quot;a&quot; 
## [3,] &quot;c&quot;  &quot;f&quot;  &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="base.html#cb269-1"></a><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, 1, 2, 3), 3, 3): data length [7] is not
## a sub-multiple or multiple of the number of rows [3]</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,] &quot;a&quot;  &quot;d&quot;  &quot;3&quot; 
## [2,] &quot;b&quot;  &quot;1&quot;  &quot;a&quot; 
## [3,] &quot;c&quot;  &quot;2&quot;  &quot;b&quot;</code></pre>
<p>Naturalmente sappiamo che dobbiamo prestare attenzione al <strong>modo</strong> in cui R riempirà la nostra matrice. Per questo dobbiamo ricordare che esiste la funzione <strong>byrow</strong> che ci permette di indicare se la matrice deve essere riempita per riga invece che per colonna.
Un altro aspetto da considerare è la <strong>coerenza</strong> tra le dimensioni dell’argomento <em>data</em> e la geometria della matrice definita dai valori degli argomenti <em>nrow</em> e <em>ncol</em>.
Se “i conti non tornano”, R cerca di farseli tornare ma ci avverte che qualcosa non va…</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="base.html#cb272-1"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Warning in matrix(1:9, 3, 4): data length [9] is not a sub-multiple or multiple
## of the number of columns [4]</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7    1
## [2,]    2    5    8    2
## [3,]    3    6    9    3</code></pre>
<p>In questo esempio, abbiamo messo R in imbarazzo dando alla funzione <em>matrix</em> argomenti discordanti: <em>data</em> è definito come un vettore di 9 elementi, ma i valori di <em>nrow</em> e <em>ncol</em> definiscono una matrice avente 12 celle!
Come si vede, R “ricicla” gli elementi di <em>data</em>, ripartendo dall’inizio del vettore, ma ci avvisa con un <em>warning</em>. Tuttavia…</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="base.html#cb275-1"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    1    2
## [2,]    2    1    2    1
## [3,]    1    2    1    2</code></pre>
<p>In questo caso R non ha protestato, perchè replicando gli elementi di <em>data</em> è riuscito a ottenere un numero di elementi coerente con la geometria della matrice.
Ovviamente questo è un caso particolare della regola generale:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="base.html#cb277-1"></a><span class="kw">matrix</span>(<span class="dv">100</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]  100  100  100  100
## [2,]  100  100  100  100
## [3,]  100  100  100  100</code></pre>
<p>In questo caso, avendo assegnato all’argomento <em>data</em> un singolo valore numerico, qualsiasi geometria della matrice andrà bene.</p>
</div>
<div id="array" class="section level3">
<h3><span class="header-section-number">4.14.6</span> array</h3>
<p>Questa funzione è la corrispondente di <em>matrix</em> per matrici a <em>n</em> dimensioni con <em>n</em> che appartiene a N+. A parte l’argomento <em>data</em>, che è identico a quello di <em>matrix</em>, la funzione <em>array</em> vuole un argomento <em>dim</em>, nella forma di un vettore numerico in cui ogni valore specifica il numero di elementi corrispondente alla n-esima dimensione. Dunque il numero di dimensioni dipende dalla lunghezza del vettore associato a <em>dim</em>. Ad esempio</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="base.html#cb279-1"></a><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6
## 
## , , 2
## 
##      [,1] [,2]
## [1,]    7   10
## [2,]    8   11
## [3,]    9   12
## 
## , , 3
## 
##      [,1] [,2]
## [1,]   13   16
## [2,]   14   17
## [3,]   15   18
## 
## , , 4
## 
##      [,1] [,2]
## [1,]   19   22
## [2,]   20   23
## [3,]   21   24</code></pre>
<p>E’ interessante fare la conoscenza con il modo, rozzo ma efficace, che R usa per mostrarci oggetti compessi come questo array a 3 dimensioni. Per orientarsi, si devono utilizzare gli indici, tra quadre, che ci indicano quale strato dell’array ci viene mostrato. Essendo alle prese con un array tridimensionale, ci servono 3 coordinate per identificare un suo elemento, e quindi tra le quadre (che servono per indicizzarlo) vediamo 2 virgole che separano 3 valori, siano essi presenti o meno.
Quindi la scrittura [,2,3] vuol dire prendi TUTTI gli elementi dell’array rispetto alla sua prima dimensione, solo il secondo rispetto alla seconda dimensione e solo il terzo rispetto alla terza dimensione. Chiaro no?</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="base.html#cb281-1"></a>a =<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb281-2"><a href="base.html#cb281-2"></a>a[,<span class="dv">2</span>,<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 16 17 18</code></pre>
</div>
<div id="data.frame" class="section level3">
<h3><span class="header-section-number">4.14.7</span> data.frame</h3>
<p>I data frame sono sicuramente gli oggetti più flessibili di R, e sono di gran lunga il tipo più usato per organizzare, gestire e analizzare dati biologici.
I data frame combinano la “rigidità” strutturale delle matrici (ogni riga di un data frame ha le stesse colonne di ogni altra, e viceversa per le colonne) con la flessibilità del poter incorporare dati <em>factor</em>, <em>numeric</em>, <em>character</em>, ecc.
Questo vuol dire che, generalmente, le colonne di un data frame contengono record (righe) omogenei e, quindi, ogni variabile (colonna) è formata da valori che appartengono alla stessa classe di R.
Questo, però, li rende oggetti non ideali per fare calcoli, come vedremo parlando delle funzioni matematico-statistiche.
Per fare pratica coi data frame introduciamo uno dei dataset nativi del pacchetto base di R, il data frame <strong>iris</strong></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="base.html#cb283-1"></a><span class="kw">data</span>(iris)</span>
<span id="cb283-2"><a href="base.html#cb283-2"></a>iris</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            5.1         3.5          1.4         0.2     setosa
## 2            4.9         3.0          1.4         0.2     setosa
## 3            4.7         3.2          1.3         0.2     setosa
## 4            4.6         3.1          1.5         0.2     setosa
## 5            5.0         3.6          1.4         0.2     setosa
## 6            5.4         3.9          1.7         0.4     setosa
## 7            4.6         3.4          1.4         0.3     setosa
## 8            5.0         3.4          1.5         0.2     setosa
## 9            4.4         2.9          1.4         0.2     setosa
## 10           4.9         3.1          1.5         0.1     setosa
## 11           5.4         3.7          1.5         0.2     setosa
## 12           4.8         3.4          1.6         0.2     setosa
## 13           4.8         3.0          1.4         0.1     setosa
## 14           4.3         3.0          1.1         0.1     setosa
## 15           5.8         4.0          1.2         0.2     setosa
## 16           5.7         4.4          1.5         0.4     setosa
## 17           5.4         3.9          1.3         0.4     setosa
## 18           5.1         3.5          1.4         0.3     setosa
## 19           5.7         3.8          1.7         0.3     setosa
## 20           5.1         3.8          1.5         0.3     setosa
## 21           5.4         3.4          1.7         0.2     setosa
## 22           5.1         3.7          1.5         0.4     setosa
## 23           4.6         3.6          1.0         0.2     setosa
## 24           5.1         3.3          1.7         0.5     setosa
## 25           4.8         3.4          1.9         0.2     setosa
## 26           5.0         3.0          1.6         0.2     setosa
## 27           5.0         3.4          1.6         0.4     setosa
## 28           5.2         3.5          1.5         0.2     setosa
## 29           5.2         3.4          1.4         0.2     setosa
## 30           4.7         3.2          1.6         0.2     setosa
## 31           4.8         3.1          1.6         0.2     setosa
## 32           5.4         3.4          1.5         0.4     setosa
## 33           5.2         4.1          1.5         0.1     setosa
## 34           5.5         4.2          1.4         0.2     setosa
## 35           4.9         3.1          1.5         0.2     setosa
## 36           5.0         3.2          1.2         0.2     setosa
## 37           5.5         3.5          1.3         0.2     setosa
## 38           4.9         3.6          1.4         0.1     setosa
## 39           4.4         3.0          1.3         0.2     setosa
## 40           5.1         3.4          1.5         0.2     setosa
## 41           5.0         3.5          1.3         0.3     setosa
## 42           4.5         2.3          1.3         0.3     setosa
## 43           4.4         3.2          1.3         0.2     setosa
## 44           5.0         3.5          1.6         0.6     setosa
## 45           5.1         3.8          1.9         0.4     setosa
## 46           4.8         3.0          1.4         0.3     setosa
## 47           5.1         3.8          1.6         0.2     setosa
## 48           4.6         3.2          1.4         0.2     setosa
## 49           5.3         3.7          1.5         0.2     setosa
## 50           5.0         3.3          1.4         0.2     setosa
## 51           7.0         3.2          4.7         1.4 versicolor
## 52           6.4         3.2          4.5         1.5 versicolor
## 53           6.9         3.1          4.9         1.5 versicolor
## 54           5.5         2.3          4.0         1.3 versicolor
## 55           6.5         2.8          4.6         1.5 versicolor
## 56           5.7         2.8          4.5         1.3 versicolor
## 57           6.3         3.3          4.7         1.6 versicolor
## 58           4.9         2.4          3.3         1.0 versicolor
## 59           6.6         2.9          4.6         1.3 versicolor
## 60           5.2         2.7          3.9         1.4 versicolor
## 61           5.0         2.0          3.5         1.0 versicolor
## 62           5.9         3.0          4.2         1.5 versicolor
## 63           6.0         2.2          4.0         1.0 versicolor
## 64           6.1         2.9          4.7         1.4 versicolor
## 65           5.6         2.9          3.6         1.3 versicolor
## 66           6.7         3.1          4.4         1.4 versicolor
## 67           5.6         3.0          4.5         1.5 versicolor
## 68           5.8         2.7          4.1         1.0 versicolor
## 69           6.2         2.2          4.5         1.5 versicolor
## 70           5.6         2.5          3.9         1.1 versicolor
## 71           5.9         3.2          4.8         1.8 versicolor
## 72           6.1         2.8          4.0         1.3 versicolor
## 73           6.3         2.5          4.9         1.5 versicolor
## 74           6.1         2.8          4.7         1.2 versicolor
## 75           6.4         2.9          4.3         1.3 versicolor
## 76           6.6         3.0          4.4         1.4 versicolor
## 77           6.8         2.8          4.8         1.4 versicolor
## 78           6.7         3.0          5.0         1.7 versicolor
## 79           6.0         2.9          4.5         1.5 versicolor
## 80           5.7         2.6          3.5         1.0 versicolor
## 81           5.5         2.4          3.8         1.1 versicolor
## 82           5.5         2.4          3.7         1.0 versicolor
## 83           5.8         2.7          3.9         1.2 versicolor
## 84           6.0         2.7          5.1         1.6 versicolor
## 85           5.4         3.0          4.5         1.5 versicolor
## 86           6.0         3.4          4.5         1.6 versicolor
## 87           6.7         3.1          4.7         1.5 versicolor
## 88           6.3         2.3          4.4         1.3 versicolor
## 89           5.6         3.0          4.1         1.3 versicolor
## 90           5.5         2.5          4.0         1.3 versicolor
## 91           5.5         2.6          4.4         1.2 versicolor
## 92           6.1         3.0          4.6         1.4 versicolor
## 93           5.8         2.6          4.0         1.2 versicolor
## 94           5.0         2.3          3.3         1.0 versicolor
## 95           5.6         2.7          4.2         1.3 versicolor
## 96           5.7         3.0          4.2         1.2 versicolor
## 97           5.7         2.9          4.2         1.3 versicolor
## 98           6.2         2.9          4.3         1.3 versicolor
## 99           5.1         2.5          3.0         1.1 versicolor
## 100          5.7         2.8          4.1         1.3 versicolor
## 101          6.3         3.3          6.0         2.5  virginica
## 102          5.8         2.7          5.1         1.9  virginica
## 103          7.1         3.0          5.9         2.1  virginica
## 104          6.3         2.9          5.6         1.8  virginica
## 105          6.5         3.0          5.8         2.2  virginica
## 106          7.6         3.0          6.6         2.1  virginica
## 107          4.9         2.5          4.5         1.7  virginica
## 108          7.3         2.9          6.3         1.8  virginica
## 109          6.7         2.5          5.8         1.8  virginica
## 110          7.2         3.6          6.1         2.5  virginica
## 111          6.5         3.2          5.1         2.0  virginica
## 112          6.4         2.7          5.3         1.9  virginica
## 113          6.8         3.0          5.5         2.1  virginica
## 114          5.7         2.5          5.0         2.0  virginica
## 115          5.8         2.8          5.1         2.4  virginica
## 116          6.4         3.2          5.3         2.3  virginica
## 117          6.5         3.0          5.5         1.8  virginica
## 118          7.7         3.8          6.7         2.2  virginica
## 119          7.7         2.6          6.9         2.3  virginica
## 120          6.0         2.2          5.0         1.5  virginica
## 121          6.9         3.2          5.7         2.3  virginica
## 122          5.6         2.8          4.9         2.0  virginica
## 123          7.7         2.8          6.7         2.0  virginica
## 124          6.3         2.7          4.9         1.8  virginica
## 125          6.7         3.3          5.7         2.1  virginica
## 126          7.2         3.2          6.0         1.8  virginica
## 127          6.2         2.8          4.8         1.8  virginica
## 128          6.1         3.0          4.9         1.8  virginica
## 129          6.4         2.8          5.6         2.1  virginica
## 130          7.2         3.0          5.8         1.6  virginica
## 131          7.4         2.8          6.1         1.9  virginica
## 132          7.9         3.8          6.4         2.0  virginica
## 133          6.4         2.8          5.6         2.2  virginica
## 134          6.3         2.8          5.1         1.5  virginica
## 135          6.1         2.6          5.6         1.4  virginica
## 136          7.7         3.0          6.1         2.3  virginica
## 137          6.3         3.4          5.6         2.4  virginica
## 138          6.4         3.1          5.5         1.8  virginica
## 139          6.0         3.0          4.8         1.8  virginica
## 140          6.9         3.1          5.4         2.1  virginica
## 141          6.7         3.1          5.6         2.4  virginica
## 142          6.9         3.1          5.1         2.3  virginica
## 143          5.8         2.7          5.1         1.9  virginica
## 144          6.8         3.2          5.9         2.3  virginica
## 145          6.7         3.3          5.7         2.5  virginica
## 146          6.7         3.0          5.2         2.3  virginica
## 147          6.3         2.5          5.0         1.9  virginica
## 148          6.5         3.0          5.2         2.0  virginica
## 149          6.2         3.4          5.4         2.3  virginica
## 150          5.9         3.0          5.1         1.8  virginica</code></pre>
<p>Iris è un famoso insieme di dati (Fisher’s or Anderson’s) che contiene biometrie di individui (fiori) di 3 specie del genere <em>Iris</em>.
Come si può notare, ogni colonna ha un nome che corrisponde alla biometria misurata, mentre l’ultima colonna è un factor con 3 livelli corrispondenti alle 3 specie.
Nel caso dei data frame, oltre alla normale indicizizzazione basata sulle parentesi quadre, possiamo disporre di un riferimento diretto alle colonne (variabili) mediante il simbolo <strong>$</strong>.
Ad esempio</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="base.html#cb285-1"></a>iris<span class="op">$</span>Sepal.Length</span></code></pre></div>
<pre><code>##   [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9 5.4 4.8 4.8 4.3 5.8 5.7 5.4 5.1
##  [19] 5.7 5.1 5.4 5.1 4.6 5.1 4.8 5.0 5.0 5.2 5.2 4.7 4.8 5.4 5.2 5.5 4.9 5.0
##  [37] 5.5 4.9 4.4 5.1 5.0 4.5 4.4 5.0 5.1 4.8 5.1 4.6 5.3 5.0 7.0 6.4 6.9 5.5
##  [55] 6.5 5.7 6.3 4.9 6.6 5.2 5.0 5.9 6.0 6.1 5.6 6.7 5.6 5.8 6.2 5.6 5.9 6.1
##  [73] 6.3 6.1 6.4 6.6 6.8 6.7 6.0 5.7 5.5 5.5 5.8 6.0 5.4 6.0 6.7 6.3 5.6 5.5
##  [91] 5.5 6.1 5.8 5.0 5.6 5.7 5.7 6.2 5.1 5.7 6.3 5.8 7.1 6.3 6.5 7.6 4.9 7.3
## [109] 6.7 7.2 6.5 6.4 6.8 5.7 5.8 6.4 6.5 7.7 7.7 6.0 6.9 5.6 7.7 6.3 6.7 7.2
## [127] 6.2 6.1 6.4 7.2 7.4 7.9 6.4 6.3 6.1 7.7 6.3 6.4 6.0 6.9 6.7 6.9 5.8 6.8
## [145] 6.7 6.7 6.3 6.5 6.2 5.9</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="base.html#cb287-1"></a>iris<span class="op">$</span>Species</span></code></pre></div>
<pre><code>##   [1] setosa     setosa     setosa     setosa     setosa     setosa    
##   [7] setosa     setosa     setosa     setosa     setosa     setosa    
##  [13] setosa     setosa     setosa     setosa     setosa     setosa    
##  [19] setosa     setosa     setosa     setosa     setosa     setosa    
##  [25] setosa     setosa     setosa     setosa     setosa     setosa    
##  [31] setosa     setosa     setosa     setosa     setosa     setosa    
##  [37] setosa     setosa     setosa     setosa     setosa     setosa    
##  [43] setosa     setosa     setosa     setosa     setosa     setosa    
##  [49] setosa     setosa     versicolor versicolor versicolor versicolor
##  [55] versicolor versicolor versicolor versicolor versicolor versicolor
##  [61] versicolor versicolor versicolor versicolor versicolor versicolor
##  [67] versicolor versicolor versicolor versicolor versicolor versicolor
##  [73] versicolor versicolor versicolor versicolor versicolor versicolor
##  [79] versicolor versicolor versicolor versicolor versicolor versicolor
##  [85] versicolor versicolor versicolor versicolor versicolor versicolor
##  [91] versicolor versicolor versicolor versicolor versicolor versicolor
##  [97] versicolor versicolor versicolor versicolor virginica  virginica 
## [103] virginica  virginica  virginica  virginica  virginica  virginica 
## [109] virginica  virginica  virginica  virginica  virginica  virginica 
## [115] virginica  virginica  virginica  virginica  virginica  virginica 
## [121] virginica  virginica  virginica  virginica  virginica  virginica 
## [127] virginica  virginica  virginica  virginica  virginica  virginica 
## [133] virginica  virginica  virginica  virginica  virginica  virginica 
## [139] virginica  virginica  virginica  virginica  virginica  virginica 
## [145] virginica  virginica  virginica  virginica  virginica  virginica 
## Levels: setosa versicolor virginica</code></pre>
<p>Quindi, usando il comando <em>class</em>, possiamo esaminare ogni variabile.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="base.html#cb289-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="base.html#cb291-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Sepal.Width)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="base.html#cb293-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Petal.Length)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="base.html#cb295-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Petal.Width)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="base.html#cb297-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>Esistono due modi in cui si può organizzare un data frame. Il primo, detto <strong>wide</strong>, contiene osservazioni ripetute di un soggetto in una singola riga, e ogni risposta è in una colonna separata. Il data frame iris è un esempio di data frame wide. Nel secondo tipo, detto <strong>long</strong>, ogni riga è combinazione di soggetto e risposta (variabile) su di esso osservata. Il data frame iris nel formato long ci appare così:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="base.html#cb299-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb299-2"><a href="base.html#cb299-2"></a>iris<span class="op">$</span>id =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">150</span></span>
<span id="cb299-3"><a href="base.html#cb299-3"></a>iris_long =<span class="st"> </span><span class="kw">melt</span>(iris, <span class="dt">id.vars =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: attributes are not identical across measure variables; they will be
## dropped</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="base.html#cb301-1"></a>iris_long</span></code></pre></div>
<pre><code>##      id     variable      value
## 1     1 Sepal.Length        5.1
## 2     2 Sepal.Length        4.9
## 3     3 Sepal.Length        4.7
## 4     4 Sepal.Length        4.6
## 5     5 Sepal.Length          5
## 6     6 Sepal.Length        5.4
## 7     7 Sepal.Length        4.6
## 8     8 Sepal.Length          5
## 9     9 Sepal.Length        4.4
## 10   10 Sepal.Length        4.9
## 11   11 Sepal.Length        5.4
## 12   12 Sepal.Length        4.8
## 13   13 Sepal.Length        4.8
## 14   14 Sepal.Length        4.3
## 15   15 Sepal.Length        5.8
## 16   16 Sepal.Length        5.7
## 17   17 Sepal.Length        5.4
## 18   18 Sepal.Length        5.1
## 19   19 Sepal.Length        5.7
## 20   20 Sepal.Length        5.1
## 21   21 Sepal.Length        5.4
## 22   22 Sepal.Length        5.1
## 23   23 Sepal.Length        4.6
## 24   24 Sepal.Length        5.1
## 25   25 Sepal.Length        4.8
## 26   26 Sepal.Length          5
## 27   27 Sepal.Length          5
## 28   28 Sepal.Length        5.2
## 29   29 Sepal.Length        5.2
## 30   30 Sepal.Length        4.7
## 31   31 Sepal.Length        4.8
## 32   32 Sepal.Length        5.4
## 33   33 Sepal.Length        5.2
## 34   34 Sepal.Length        5.5
## 35   35 Sepal.Length        4.9
## 36   36 Sepal.Length          5
## 37   37 Sepal.Length        5.5
## 38   38 Sepal.Length        4.9
## 39   39 Sepal.Length        4.4
## 40   40 Sepal.Length        5.1
## 41   41 Sepal.Length          5
## 42   42 Sepal.Length        4.5
## 43   43 Sepal.Length        4.4
## 44   44 Sepal.Length          5
## 45   45 Sepal.Length        5.1
## 46   46 Sepal.Length        4.8
## 47   47 Sepal.Length        5.1
## 48   48 Sepal.Length        4.6
## 49   49 Sepal.Length        5.3
## 50   50 Sepal.Length          5
## 51   51 Sepal.Length          7
## 52   52 Sepal.Length        6.4
## 53   53 Sepal.Length        6.9
## 54   54 Sepal.Length        5.5
## 55   55 Sepal.Length        6.5
## 56   56 Sepal.Length        5.7
## 57   57 Sepal.Length        6.3
## 58   58 Sepal.Length        4.9
## 59   59 Sepal.Length        6.6
## 60   60 Sepal.Length        5.2
## 61   61 Sepal.Length          5
## 62   62 Sepal.Length        5.9
## 63   63 Sepal.Length          6
## 64   64 Sepal.Length        6.1
## 65   65 Sepal.Length        5.6
## 66   66 Sepal.Length        6.7
## 67   67 Sepal.Length        5.6
## 68   68 Sepal.Length        5.8
## 69   69 Sepal.Length        6.2
## 70   70 Sepal.Length        5.6
## 71   71 Sepal.Length        5.9
## 72   72 Sepal.Length        6.1
## 73   73 Sepal.Length        6.3
## 74   74 Sepal.Length        6.1
## 75   75 Sepal.Length        6.4
## 76   76 Sepal.Length        6.6
## 77   77 Sepal.Length        6.8
## 78   78 Sepal.Length        6.7
## 79   79 Sepal.Length          6
## 80   80 Sepal.Length        5.7
## 81   81 Sepal.Length        5.5
## 82   82 Sepal.Length        5.5
## 83   83 Sepal.Length        5.8
## 84   84 Sepal.Length          6
## 85   85 Sepal.Length        5.4
## 86   86 Sepal.Length          6
## 87   87 Sepal.Length        6.7
## 88   88 Sepal.Length        6.3
## 89   89 Sepal.Length        5.6
## 90   90 Sepal.Length        5.5
## 91   91 Sepal.Length        5.5
## 92   92 Sepal.Length        6.1
## 93   93 Sepal.Length        5.8
## 94   94 Sepal.Length          5
## 95   95 Sepal.Length        5.6
## 96   96 Sepal.Length        5.7
## 97   97 Sepal.Length        5.7
## 98   98 Sepal.Length        6.2
## 99   99 Sepal.Length        5.1
## 100 100 Sepal.Length        5.7
## 101 101 Sepal.Length        6.3
## 102 102 Sepal.Length        5.8
## 103 103 Sepal.Length        7.1
## 104 104 Sepal.Length        6.3
## 105 105 Sepal.Length        6.5
## 106 106 Sepal.Length        7.6
## 107 107 Sepal.Length        4.9
## 108 108 Sepal.Length        7.3
## 109 109 Sepal.Length        6.7
## 110 110 Sepal.Length        7.2
## 111 111 Sepal.Length        6.5
## 112 112 Sepal.Length        6.4
## 113 113 Sepal.Length        6.8
## 114 114 Sepal.Length        5.7
## 115 115 Sepal.Length        5.8
## 116 116 Sepal.Length        6.4
## 117 117 Sepal.Length        6.5
## 118 118 Sepal.Length        7.7
## 119 119 Sepal.Length        7.7
## 120 120 Sepal.Length          6
## 121 121 Sepal.Length        6.9
## 122 122 Sepal.Length        5.6
## 123 123 Sepal.Length        7.7
## 124 124 Sepal.Length        6.3
## 125 125 Sepal.Length        6.7
## 126 126 Sepal.Length        7.2
## 127 127 Sepal.Length        6.2
## 128 128 Sepal.Length        6.1
## 129 129 Sepal.Length        6.4
## 130 130 Sepal.Length        7.2
## 131 131 Sepal.Length        7.4
## 132 132 Sepal.Length        7.9
## 133 133 Sepal.Length        6.4
## 134 134 Sepal.Length        6.3
## 135 135 Sepal.Length        6.1
## 136 136 Sepal.Length        7.7
## 137 137 Sepal.Length        6.3
## 138 138 Sepal.Length        6.4
## 139 139 Sepal.Length          6
## 140 140 Sepal.Length        6.9
## 141 141 Sepal.Length        6.7
## 142 142 Sepal.Length        6.9
## 143 143 Sepal.Length        5.8
## 144 144 Sepal.Length        6.8
## 145 145 Sepal.Length        6.7
## 146 146 Sepal.Length        6.7
## 147 147 Sepal.Length        6.3
## 148 148 Sepal.Length        6.5
## 149 149 Sepal.Length        6.2
## 150 150 Sepal.Length        5.9
## 151   1  Sepal.Width        3.5
## 152   2  Sepal.Width          3
## 153   3  Sepal.Width        3.2
## 154   4  Sepal.Width        3.1
## 155   5  Sepal.Width        3.6
## 156   6  Sepal.Width        3.9
## 157   7  Sepal.Width        3.4
## 158   8  Sepal.Width        3.4
## 159   9  Sepal.Width        2.9
## 160  10  Sepal.Width        3.1
## 161  11  Sepal.Width        3.7
## 162  12  Sepal.Width        3.4
## 163  13  Sepal.Width          3
## 164  14  Sepal.Width          3
## 165  15  Sepal.Width          4
## 166  16  Sepal.Width        4.4
## 167  17  Sepal.Width        3.9
## 168  18  Sepal.Width        3.5
## 169  19  Sepal.Width        3.8
## 170  20  Sepal.Width        3.8
## 171  21  Sepal.Width        3.4
## 172  22  Sepal.Width        3.7
## 173  23  Sepal.Width        3.6
## 174  24  Sepal.Width        3.3
## 175  25  Sepal.Width        3.4
## 176  26  Sepal.Width          3
## 177  27  Sepal.Width        3.4
## 178  28  Sepal.Width        3.5
## 179  29  Sepal.Width        3.4
## 180  30  Sepal.Width        3.2
## 181  31  Sepal.Width        3.1
## 182  32  Sepal.Width        3.4
## 183  33  Sepal.Width        4.1
## 184  34  Sepal.Width        4.2
## 185  35  Sepal.Width        3.1
## 186  36  Sepal.Width        3.2
## 187  37  Sepal.Width        3.5
## 188  38  Sepal.Width        3.6
## 189  39  Sepal.Width          3
## 190  40  Sepal.Width        3.4
## 191  41  Sepal.Width        3.5
## 192  42  Sepal.Width        2.3
## 193  43  Sepal.Width        3.2
## 194  44  Sepal.Width        3.5
## 195  45  Sepal.Width        3.8
## 196  46  Sepal.Width          3
## 197  47  Sepal.Width        3.8
## 198  48  Sepal.Width        3.2
## 199  49  Sepal.Width        3.7
## 200  50  Sepal.Width        3.3
## 201  51  Sepal.Width        3.2
## 202  52  Sepal.Width        3.2
## 203  53  Sepal.Width        3.1
## 204  54  Sepal.Width        2.3
## 205  55  Sepal.Width        2.8
## 206  56  Sepal.Width        2.8
## 207  57  Sepal.Width        3.3
## 208  58  Sepal.Width        2.4
## 209  59  Sepal.Width        2.9
## 210  60  Sepal.Width        2.7
## 211  61  Sepal.Width          2
## 212  62  Sepal.Width          3
## 213  63  Sepal.Width        2.2
## 214  64  Sepal.Width        2.9
## 215  65  Sepal.Width        2.9
## 216  66  Sepal.Width        3.1
## 217  67  Sepal.Width          3
## 218  68  Sepal.Width        2.7
## 219  69  Sepal.Width        2.2
## 220  70  Sepal.Width        2.5
## 221  71  Sepal.Width        3.2
## 222  72  Sepal.Width        2.8
## 223  73  Sepal.Width        2.5
## 224  74  Sepal.Width        2.8
## 225  75  Sepal.Width        2.9
## 226  76  Sepal.Width          3
## 227  77  Sepal.Width        2.8
## 228  78  Sepal.Width          3
## 229  79  Sepal.Width        2.9
## 230  80  Sepal.Width        2.6
## 231  81  Sepal.Width        2.4
## 232  82  Sepal.Width        2.4
## 233  83  Sepal.Width        2.7
## 234  84  Sepal.Width        2.7
## 235  85  Sepal.Width          3
## 236  86  Sepal.Width        3.4
## 237  87  Sepal.Width        3.1
## 238  88  Sepal.Width        2.3
## 239  89  Sepal.Width          3
## 240  90  Sepal.Width        2.5
## 241  91  Sepal.Width        2.6
## 242  92  Sepal.Width          3
## 243  93  Sepal.Width        2.6
## 244  94  Sepal.Width        2.3
## 245  95  Sepal.Width        2.7
## 246  96  Sepal.Width          3
## 247  97  Sepal.Width        2.9
## 248  98  Sepal.Width        2.9
## 249  99  Sepal.Width        2.5
## 250 100  Sepal.Width        2.8
## 251 101  Sepal.Width        3.3
## 252 102  Sepal.Width        2.7
## 253 103  Sepal.Width          3
## 254 104  Sepal.Width        2.9
## 255 105  Sepal.Width          3
## 256 106  Sepal.Width          3
## 257 107  Sepal.Width        2.5
## 258 108  Sepal.Width        2.9
## 259 109  Sepal.Width        2.5
## 260 110  Sepal.Width        3.6
## 261 111  Sepal.Width        3.2
## 262 112  Sepal.Width        2.7
## 263 113  Sepal.Width          3
## 264 114  Sepal.Width        2.5
## 265 115  Sepal.Width        2.8
## 266 116  Sepal.Width        3.2
## 267 117  Sepal.Width          3
## 268 118  Sepal.Width        3.8
## 269 119  Sepal.Width        2.6
## 270 120  Sepal.Width        2.2
## 271 121  Sepal.Width        3.2
## 272 122  Sepal.Width        2.8
## 273 123  Sepal.Width        2.8
## 274 124  Sepal.Width        2.7
## 275 125  Sepal.Width        3.3
## 276 126  Sepal.Width        3.2
## 277 127  Sepal.Width        2.8
## 278 128  Sepal.Width          3
## 279 129  Sepal.Width        2.8
## 280 130  Sepal.Width          3
## 281 131  Sepal.Width        2.8
## 282 132  Sepal.Width        3.8
## 283 133  Sepal.Width        2.8
## 284 134  Sepal.Width        2.8
## 285 135  Sepal.Width        2.6
## 286 136  Sepal.Width          3
## 287 137  Sepal.Width        3.4
## 288 138  Sepal.Width        3.1
## 289 139  Sepal.Width          3
## 290 140  Sepal.Width        3.1
## 291 141  Sepal.Width        3.1
## 292 142  Sepal.Width        3.1
## 293 143  Sepal.Width        2.7
## 294 144  Sepal.Width        3.2
## 295 145  Sepal.Width        3.3
## 296 146  Sepal.Width          3
## 297 147  Sepal.Width        2.5
## 298 148  Sepal.Width          3
## 299 149  Sepal.Width        3.4
## 300 150  Sepal.Width          3
## 301   1 Petal.Length        1.4
## 302   2 Petal.Length        1.4
## 303   3 Petal.Length        1.3
## 304   4 Petal.Length        1.5
## 305   5 Petal.Length        1.4
## 306   6 Petal.Length        1.7
## 307   7 Petal.Length        1.4
## 308   8 Petal.Length        1.5
## 309   9 Petal.Length        1.4
## 310  10 Petal.Length        1.5
## 311  11 Petal.Length        1.5
## 312  12 Petal.Length        1.6
## 313  13 Petal.Length        1.4
## 314  14 Petal.Length        1.1
## 315  15 Petal.Length        1.2
## 316  16 Petal.Length        1.5
## 317  17 Petal.Length        1.3
## 318  18 Petal.Length        1.4
## 319  19 Petal.Length        1.7
## 320  20 Petal.Length        1.5
## 321  21 Petal.Length        1.7
## 322  22 Petal.Length        1.5
## 323  23 Petal.Length          1
## 324  24 Petal.Length        1.7
## 325  25 Petal.Length        1.9
## 326  26 Petal.Length        1.6
## 327  27 Petal.Length        1.6
## 328  28 Petal.Length        1.5
## 329  29 Petal.Length        1.4
## 330  30 Petal.Length        1.6
## 331  31 Petal.Length        1.6
## 332  32 Petal.Length        1.5
## 333  33 Petal.Length        1.5
## 334  34 Petal.Length        1.4
## 335  35 Petal.Length        1.5
## 336  36 Petal.Length        1.2
## 337  37 Petal.Length        1.3
## 338  38 Petal.Length        1.4
## 339  39 Petal.Length        1.3
## 340  40 Petal.Length        1.5
## 341  41 Petal.Length        1.3
## 342  42 Petal.Length        1.3
## 343  43 Petal.Length        1.3
## 344  44 Petal.Length        1.6
## 345  45 Petal.Length        1.9
## 346  46 Petal.Length        1.4
## 347  47 Petal.Length        1.6
## 348  48 Petal.Length        1.4
## 349  49 Petal.Length        1.5
## 350  50 Petal.Length        1.4
## 351  51 Petal.Length        4.7
## 352  52 Petal.Length        4.5
## 353  53 Petal.Length        4.9
## 354  54 Petal.Length          4
## 355  55 Petal.Length        4.6
## 356  56 Petal.Length        4.5
## 357  57 Petal.Length        4.7
## 358  58 Petal.Length        3.3
## 359  59 Petal.Length        4.6
## 360  60 Petal.Length        3.9
## 361  61 Petal.Length        3.5
## 362  62 Petal.Length        4.2
## 363  63 Petal.Length          4
## 364  64 Petal.Length        4.7
## 365  65 Petal.Length        3.6
## 366  66 Petal.Length        4.4
## 367  67 Petal.Length        4.5
## 368  68 Petal.Length        4.1
## 369  69 Petal.Length        4.5
## 370  70 Petal.Length        3.9
## 371  71 Petal.Length        4.8
## 372  72 Petal.Length          4
## 373  73 Petal.Length        4.9
## 374  74 Petal.Length        4.7
## 375  75 Petal.Length        4.3
## 376  76 Petal.Length        4.4
## 377  77 Petal.Length        4.8
## 378  78 Petal.Length          5
## 379  79 Petal.Length        4.5
## 380  80 Petal.Length        3.5
## 381  81 Petal.Length        3.8
## 382  82 Petal.Length        3.7
## 383  83 Petal.Length        3.9
## 384  84 Petal.Length        5.1
## 385  85 Petal.Length        4.5
## 386  86 Petal.Length        4.5
## 387  87 Petal.Length        4.7
## 388  88 Petal.Length        4.4
## 389  89 Petal.Length        4.1
## 390  90 Petal.Length          4
## 391  91 Petal.Length        4.4
## 392  92 Petal.Length        4.6
## 393  93 Petal.Length          4
## 394  94 Petal.Length        3.3
## 395  95 Petal.Length        4.2
## 396  96 Petal.Length        4.2
## 397  97 Petal.Length        4.2
## 398  98 Petal.Length        4.3
## 399  99 Petal.Length          3
## 400 100 Petal.Length        4.1
## 401 101 Petal.Length          6
## 402 102 Petal.Length        5.1
## 403 103 Petal.Length        5.9
## 404 104 Petal.Length        5.6
## 405 105 Petal.Length        5.8
## 406 106 Petal.Length        6.6
## 407 107 Petal.Length        4.5
## 408 108 Petal.Length        6.3
## 409 109 Petal.Length        5.8
## 410 110 Petal.Length        6.1
## 411 111 Petal.Length        5.1
## 412 112 Petal.Length        5.3
## 413 113 Petal.Length        5.5
## 414 114 Petal.Length          5
## 415 115 Petal.Length        5.1
## 416 116 Petal.Length        5.3
## 417 117 Petal.Length        5.5
## 418 118 Petal.Length        6.7
## 419 119 Petal.Length        6.9
## 420 120 Petal.Length          5
## 421 121 Petal.Length        5.7
## 422 122 Petal.Length        4.9
## 423 123 Petal.Length        6.7
## 424 124 Petal.Length        4.9
## 425 125 Petal.Length        5.7
## 426 126 Petal.Length          6
## 427 127 Petal.Length        4.8
## 428 128 Petal.Length        4.9
## 429 129 Petal.Length        5.6
## 430 130 Petal.Length        5.8
## 431 131 Petal.Length        6.1
## 432 132 Petal.Length        6.4
## 433 133 Petal.Length        5.6
## 434 134 Petal.Length        5.1
## 435 135 Petal.Length        5.6
## 436 136 Petal.Length        6.1
## 437 137 Petal.Length        5.6
## 438 138 Petal.Length        5.5
## 439 139 Petal.Length        4.8
## 440 140 Petal.Length        5.4
## 441 141 Petal.Length        5.6
## 442 142 Petal.Length        5.1
## 443 143 Petal.Length        5.1
## 444 144 Petal.Length        5.9
## 445 145 Petal.Length        5.7
## 446 146 Petal.Length        5.2
## 447 147 Petal.Length          5
## 448 148 Petal.Length        5.2
## 449 149 Petal.Length        5.4
## 450 150 Petal.Length        5.1
## 451   1  Petal.Width        0.2
## 452   2  Petal.Width        0.2
## 453   3  Petal.Width        0.2
## 454   4  Petal.Width        0.2
## 455   5  Petal.Width        0.2
## 456   6  Petal.Width        0.4
## 457   7  Petal.Width        0.3
## 458   8  Petal.Width        0.2
## 459   9  Petal.Width        0.2
## 460  10  Petal.Width        0.1
## 461  11  Petal.Width        0.2
## 462  12  Petal.Width        0.2
## 463  13  Petal.Width        0.1
## 464  14  Petal.Width        0.1
## 465  15  Petal.Width        0.2
## 466  16  Petal.Width        0.4
## 467  17  Petal.Width        0.4
## 468  18  Petal.Width        0.3
## 469  19  Petal.Width        0.3
## 470  20  Petal.Width        0.3
## 471  21  Petal.Width        0.2
## 472  22  Petal.Width        0.4
## 473  23  Petal.Width        0.2
## 474  24  Petal.Width        0.5
## 475  25  Petal.Width        0.2
## 476  26  Petal.Width        0.2
## 477  27  Petal.Width        0.4
## 478  28  Petal.Width        0.2
## 479  29  Petal.Width        0.2
## 480  30  Petal.Width        0.2
## 481  31  Petal.Width        0.2
## 482  32  Petal.Width        0.4
## 483  33  Petal.Width        0.1
## 484  34  Petal.Width        0.2
## 485  35  Petal.Width        0.2
## 486  36  Petal.Width        0.2
## 487  37  Petal.Width        0.2
## 488  38  Petal.Width        0.1
## 489  39  Petal.Width        0.2
## 490  40  Petal.Width        0.2
## 491  41  Petal.Width        0.3
## 492  42  Petal.Width        0.3
## 493  43  Petal.Width        0.2
## 494  44  Petal.Width        0.6
## 495  45  Petal.Width        0.4
## 496  46  Petal.Width        0.3
## 497  47  Petal.Width        0.2
## 498  48  Petal.Width        0.2
## 499  49  Petal.Width        0.2
## 500  50  Petal.Width        0.2
## 501  51  Petal.Width        1.4
## 502  52  Petal.Width        1.5
## 503  53  Petal.Width        1.5
## 504  54  Petal.Width        1.3
## 505  55  Petal.Width        1.5
## 506  56  Petal.Width        1.3
## 507  57  Petal.Width        1.6
## 508  58  Petal.Width          1
## 509  59  Petal.Width        1.3
## 510  60  Petal.Width        1.4
## 511  61  Petal.Width          1
## 512  62  Petal.Width        1.5
## 513  63  Petal.Width          1
## 514  64  Petal.Width        1.4
## 515  65  Petal.Width        1.3
## 516  66  Petal.Width        1.4
## 517  67  Petal.Width        1.5
## 518  68  Petal.Width          1
## 519  69  Petal.Width        1.5
## 520  70  Petal.Width        1.1
## 521  71  Petal.Width        1.8
## 522  72  Petal.Width        1.3
## 523  73  Petal.Width        1.5
## 524  74  Petal.Width        1.2
## 525  75  Petal.Width        1.3
## 526  76  Petal.Width        1.4
## 527  77  Petal.Width        1.4
## 528  78  Petal.Width        1.7
## 529  79  Petal.Width        1.5
## 530  80  Petal.Width          1
## 531  81  Petal.Width        1.1
## 532  82  Petal.Width          1
## 533  83  Petal.Width        1.2
## 534  84  Petal.Width        1.6
## 535  85  Petal.Width        1.5
## 536  86  Petal.Width        1.6
## 537  87  Petal.Width        1.5
## 538  88  Petal.Width        1.3
## 539  89  Petal.Width        1.3
## 540  90  Petal.Width        1.3
## 541  91  Petal.Width        1.2
## 542  92  Petal.Width        1.4
## 543  93  Petal.Width        1.2
## 544  94  Petal.Width          1
## 545  95  Petal.Width        1.3
## 546  96  Petal.Width        1.2
## 547  97  Petal.Width        1.3
## 548  98  Petal.Width        1.3
## 549  99  Petal.Width        1.1
## 550 100  Petal.Width        1.3
## 551 101  Petal.Width        2.5
## 552 102  Petal.Width        1.9
## 553 103  Petal.Width        2.1
## 554 104  Petal.Width        1.8
## 555 105  Petal.Width        2.2
## 556 106  Petal.Width        2.1
## 557 107  Petal.Width        1.7
## 558 108  Petal.Width        1.8
## 559 109  Petal.Width        1.8
## 560 110  Petal.Width        2.5
## 561 111  Petal.Width          2
## 562 112  Petal.Width        1.9
## 563 113  Petal.Width        2.1
## 564 114  Petal.Width          2
## 565 115  Petal.Width        2.4
## 566 116  Petal.Width        2.3
## 567 117  Petal.Width        1.8
## 568 118  Petal.Width        2.2
## 569 119  Petal.Width        2.3
## 570 120  Petal.Width        1.5
## 571 121  Petal.Width        2.3
## 572 122  Petal.Width          2
## 573 123  Petal.Width          2
## 574 124  Petal.Width        1.8
## 575 125  Petal.Width        2.1
## 576 126  Petal.Width        1.8
## 577 127  Petal.Width        1.8
## 578 128  Petal.Width        1.8
## 579 129  Petal.Width        2.1
## 580 130  Petal.Width        1.6
## 581 131  Petal.Width        1.9
## 582 132  Petal.Width          2
## 583 133  Petal.Width        2.2
## 584 134  Petal.Width        1.5
## 585 135  Petal.Width        1.4
## 586 136  Petal.Width        2.3
## 587 137  Petal.Width        2.4
## 588 138  Petal.Width        1.8
## 589 139  Petal.Width        1.8
## 590 140  Petal.Width        2.1
## 591 141  Petal.Width        2.4
## 592 142  Petal.Width        2.3
## 593 143  Petal.Width        1.9
## 594 144  Petal.Width        2.3
## 595 145  Petal.Width        2.5
## 596 146  Petal.Width        2.3
## 597 147  Petal.Width        1.9
## 598 148  Petal.Width          2
## 599 149  Petal.Width        2.3
## 600 150  Petal.Width        1.8
## 601   1      Species     setosa
## 602   2      Species     setosa
## 603   3      Species     setosa
## 604   4      Species     setosa
## 605   5      Species     setosa
## 606   6      Species     setosa
## 607   7      Species     setosa
## 608   8      Species     setosa
## 609   9      Species     setosa
## 610  10      Species     setosa
## 611  11      Species     setosa
## 612  12      Species     setosa
## 613  13      Species     setosa
## 614  14      Species     setosa
## 615  15      Species     setosa
## 616  16      Species     setosa
## 617  17      Species     setosa
## 618  18      Species     setosa
## 619  19      Species     setosa
## 620  20      Species     setosa
## 621  21      Species     setosa
## 622  22      Species     setosa
## 623  23      Species     setosa
## 624  24      Species     setosa
## 625  25      Species     setosa
## 626  26      Species     setosa
## 627  27      Species     setosa
## 628  28      Species     setosa
## 629  29      Species     setosa
## 630  30      Species     setosa
## 631  31      Species     setosa
## 632  32      Species     setosa
## 633  33      Species     setosa
## 634  34      Species     setosa
## 635  35      Species     setosa
## 636  36      Species     setosa
## 637  37      Species     setosa
## 638  38      Species     setosa
## 639  39      Species     setosa
## 640  40      Species     setosa
## 641  41      Species     setosa
## 642  42      Species     setosa
## 643  43      Species     setosa
## 644  44      Species     setosa
## 645  45      Species     setosa
## 646  46      Species     setosa
## 647  47      Species     setosa
## 648  48      Species     setosa
## 649  49      Species     setosa
## 650  50      Species     setosa
## 651  51      Species versicolor
## 652  52      Species versicolor
## 653  53      Species versicolor
## 654  54      Species versicolor
## 655  55      Species versicolor
## 656  56      Species versicolor
## 657  57      Species versicolor
## 658  58      Species versicolor
## 659  59      Species versicolor
## 660  60      Species versicolor
## 661  61      Species versicolor
## 662  62      Species versicolor
## 663  63      Species versicolor
## 664  64      Species versicolor
## 665  65      Species versicolor
## 666  66      Species versicolor
## 667  67      Species versicolor
## 668  68      Species versicolor
## 669  69      Species versicolor
## 670  70      Species versicolor
## 671  71      Species versicolor
## 672  72      Species versicolor
## 673  73      Species versicolor
## 674  74      Species versicolor
## 675  75      Species versicolor
## 676  76      Species versicolor
## 677  77      Species versicolor
## 678  78      Species versicolor
## 679  79      Species versicolor
## 680  80      Species versicolor
## 681  81      Species versicolor
## 682  82      Species versicolor
## 683  83      Species versicolor
## 684  84      Species versicolor
## 685  85      Species versicolor
## 686  86      Species versicolor
## 687  87      Species versicolor
## 688  88      Species versicolor
## 689  89      Species versicolor
## 690  90      Species versicolor
## 691  91      Species versicolor
## 692  92      Species versicolor
## 693  93      Species versicolor
## 694  94      Species versicolor
## 695  95      Species versicolor
## 696  96      Species versicolor
## 697  97      Species versicolor
## 698  98      Species versicolor
## 699  99      Species versicolor
## 700 100      Species versicolor
## 701 101      Species  virginica
## 702 102      Species  virginica
## 703 103      Species  virginica
## 704 104      Species  virginica
## 705 105      Species  virginica
## 706 106      Species  virginica
## 707 107      Species  virginica
## 708 108      Species  virginica
## 709 109      Species  virginica
## 710 110      Species  virginica
## 711 111      Species  virginica
## 712 112      Species  virginica
## 713 113      Species  virginica
## 714 114      Species  virginica
## 715 115      Species  virginica
## 716 116      Species  virginica
## 717 117      Species  virginica
## 718 118      Species  virginica
## 719 119      Species  virginica
## 720 120      Species  virginica
## 721 121      Species  virginica
## 722 122      Species  virginica
## 723 123      Species  virginica
## 724 124      Species  virginica
## 725 125      Species  virginica
## 726 126      Species  virginica
## 727 127      Species  virginica
## 728 128      Species  virginica
## 729 129      Species  virginica
## 730 130      Species  virginica
## 731 131      Species  virginica
## 732 132      Species  virginica
## 733 133      Species  virginica
## 734 134      Species  virginica
## 735 135      Species  virginica
## 736 136      Species  virginica
## 737 137      Species  virginica
## 738 138      Species  virginica
## 739 139      Species  virginica
## 740 140      Species  virginica
## 741 141      Species  virginica
## 742 142      Species  virginica
## 743 143      Species  virginica
## 744 144      Species  virginica
## 745 145      Species  virginica
## 746 146      Species  virginica
## 747 147      Species  virginica
## 748 148      Species  virginica
## 749 149      Species  virginica
## 750 150      Species  virginica</code></pre>
<p>Quindi ogni soggetto (identificato dal campo id, inserito apposta) avrà dati in più righe, e precisamente nel campo <em>value</em>, mentre la colonna <em>variable</em> specifica a quale variabile è riferito il valore di <em>value</em>.
Il lettore attento noterà che siamo passati dal formato <strong>wide</strong> al formato <strong>long</strong> usando funzioni non sono nel pacchetto <em>base</em> di R ma del pacchetto <strong>reshape2</strong>, ma per ora sorvoleremo (e il lettore ci perdonerà) e torneremo su questo punto più avanti.
Intanto ragioniamo sul fatto che il formato <strong>wide</strong> è più familiare (praticamente è una tabella) e semplice da compilare, ma il formato <strong>long</strong> è molto più efficiente e sicuro. Per comprendere il perchè di questa affermazione prendiamo il caso di un grande dataset che debba essere continuamente aggiornato, magari con osservazioni (nuove righe) non omogee rispetto alle precedenti (ad esempio abbiamo misurato una nuova biometria rispetto a quelle precedenti). Si può capire facilmente che sarebbe molto più facile aggiungere questa nuova osservazione al data frame <strong>long</strong>, poichè dovremmo specificare i valori solo per il nuovo record. Se invece dovessimo aggiungere la nuova osservazione al data frame <strong>wide</strong>, e ci trovassimo ad aver misurato una nuova biometria, sarebbe necessario modificare <strong>tutti</strong> i record precedenti aggiungendo un NA nella nuova colonna per la nuova biometria.</p>
<p>La funzione <strong>data.frame</strong> permette di generare questo genere di oggetti da qualsiasi tipo di dato. Leggendo il suo help, noteremo che alla voce usage compaiono tre puntini al posto degli argomenti, e per il resto ci sono solo opzioni.</p>
</div>
<div id="vector" class="section level3">
<h3><span class="header-section-number">4.14.8</span> vector</h3>
<p>Dopo aver descritto le funzioni specifiche per generare vettori di varie classi, vediamo la funzione generica <strong>vector</strong> che serve a generare vettori di qualunque tipo.
In effetti, vector ha come argomenti <strong>mode</strong>, cioè la classe del vettore da generare, e <strong>length</strong> che ha lo stesso significato visto per <em>numeric</em> e <em>character</em>.</p>
</div>
<div id="rep" class="section level3">
<h3><span class="header-section-number">4.14.9</span> rep</h3>
<p>Anche questa funzione serve per generare vettori, ma questa volta usando la replicazione di elementi forniti dall’utente. <strong>rep</strong> vuole due argomenti, il primo dei quali (<strong>x</strong>) corrisponde gli elementi da replicare, mentre il secondo può essere <strong>times</strong>, cioè il numero di volte che <strong>x</strong> (in blocco) deve essere replicato, oppure <strong>length.out</strong>, cioè la lunghezza del vettore che si vuole ottenere. Vediamo degli esempi:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="base.html#cb303-1"></a><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="base.html#cb305-1"></a><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="dt">times =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="base.html#cb307-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">times =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 1 2 1 2</code></pre>
<p>Nel primo caso abbiamo replicato un numero, nel secondo una lettera, nel terzo un vettore</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="base.html#cb309-1"></a><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 1 1 1</code></pre>
<p>In questo caso, invece, abbiamo fissato la lunghezza del vettore.</p>
</div>
<div id="seq" class="section level3">
<h3><span class="header-section-number">4.14.10</span> seq</h3>
<p>Questa funzione serve a generare sequenze regolari di valori numerici. I suoi argomenti sono <strong>from</strong> (cioè il punto di partenza della serie regolare - il suo minimo insomma), <strong>to</strong> (il suo massimo, che però può non coincidere con il punto finale della serie generata) e, a scelta, <strong>by</strong> (il passo della sequenza) o <strong>length.out</strong> (la lunghezza del vettore). Vediamo alcuni esempi:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="base.html#cb311-1"></a><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="base.html#cb313-1"></a><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="base.html#cb315-1"></a><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">length.out =</span> <span class="dv">11</span>)</span></code></pre></div>
<pre><code>##  [1]  1.0  1.9  2.8  3.7  4.6  5.5  6.4  7.3  8.2  9.1 10.0</code></pre>
<p>Il primo esempio è molto semplice: generiamo una sequenza da 1 a 10 con passo 1.
Il secondo, in cui partiamo da 1 e “puntiamo” a 10 ma con passo 2, R si ferma a 9 poichè aggiungere un altro passo significherebbe ottenere 11 e quindi superare il massimo fissato (10). Nel terzo esempio abbiamo ottenuto un vettore con estremi coincidenti con i valori di <em>from</em> e <em>to</em> ma con un intervallo decimale poichè abbiamo fissato il numero di elementi del vettore e, quindi, R ha calcolato il passo corrispondente per arrivare da 1 a 10 con 10 passi.</p>
<p>A questo punto, passiamo alle funzioni per esplorare gli oggetti.</p>
</div>
<div id="head-e-tail" class="section level3">
<h3><span class="header-section-number">4.14.11</span> head e tail</h3>
<p>Queste due funzioni sono molto utili per avere una visione parziale di diversi oggetti, come per esempio i data frame. Nello specifico, <strong>head</strong> permette di visualizzare dal terminale la <em>testa</em>, cioè le prime righe del data frame, mentre <strong>tail</strong> permette di visualizzare la <em>coda</em>. Entrambi i comandi vogliono un argomento obbligato, <em>x</em>, cioè l’oggetto di cui si vuola visualizzare le prime o le ultime <em>n</em> righe, dove <em>n</em> è un argomento opzionale, fissato come valore di <em>default</em> a 6.
Modificando questo parametro, si possono visualizzare le prime (o le ultime) 10, 20, 30 righe.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="base.html#cb317-1"></a><span class="kw">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species id
## 1          5.1         3.5          1.4         0.2  setosa  1
## 2          4.9         3.0          1.4         0.2  setosa  2
## 3          4.7         3.2          1.3         0.2  setosa  3
## 4          4.6         3.1          1.5         0.2  setosa  4
## 5          5.0         3.6          1.4         0.2  setosa  5
## 6          5.4         3.9          1.7         0.4  setosa  6</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="base.html#cb319-1"></a><span class="kw">head</span>(iris, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species id
## 1           5.1         3.5          1.4         0.2  setosa  1
## 2           4.9         3.0          1.4         0.2  setosa  2
## 3           4.7         3.2          1.3         0.2  setosa  3
## 4           4.6         3.1          1.5         0.2  setosa  4
## 5           5.0         3.6          1.4         0.2  setosa  5
## 6           5.4         3.9          1.7         0.4  setosa  6
## 7           4.6         3.4          1.4         0.3  setosa  7
## 8           5.0         3.4          1.5         0.2  setosa  8
## 9           4.4         2.9          1.4         0.2  setosa  9
## 10          4.9         3.1          1.5         0.1  setosa 10</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="base.html#cb321-1"></a><span class="kw">tail</span>(iris)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species  id
## 145          6.7         3.3          5.7         2.5 virginica 145
## 146          6.7         3.0          5.2         2.3 virginica 146
## 147          6.3         2.5          5.0         1.9 virginica 147
## 148          6.5         3.0          5.2         2.0 virginica 148
## 149          6.2         3.4          5.4         2.3 virginica 149
## 150          5.9         3.0          5.1         1.8 virginica 150</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="base.html#cb323-1"></a><span class="kw">tail</span>(iris, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species  id
## 141          6.7         3.1          5.6         2.4 virginica 141
## 142          6.9         3.1          5.1         2.3 virginica 142
## 143          5.8         2.7          5.1         1.9 virginica 143
## 144          6.8         3.2          5.9         2.3 virginica 144
## 145          6.7         3.3          5.7         2.5 virginica 145
## 146          6.7         3.0          5.2         2.3 virginica 146
## 147          6.3         2.5          5.0         1.9 virginica 147
## 148          6.5         3.0          5.2         2.0 virginica 148
## 149          6.2         3.4          5.4         2.3 virginica 149
## 150          5.9         3.0          5.1         1.8 virginica 150</code></pre>
</div>
<div id="nrow-ncol-dim-e-length" class="section level3">
<h3><span class="header-section-number">4.14.12</span> nrow, ncol, dim e length</h3>
<p>Facciamo finta di essere alle prese con un data frame che non conosciamo. Probabilmente una delle prime cose da fare è indagare la geometria del data frame, cioè capire quante righe e quante osservazioni ci sono.
La funzione <em>nrow</em> ci fornisce il numero di righe, <em>ncol</em> ci fornisce il numero di colonne. <em>dim</em> e li fornisce entrambi. Nel caso degli <em>array</em>, <em>dim</em> ci restituisce tutte le dimensioni dell’ <em>array</em> stesso.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="base.html#cb325-1"></a><span class="kw">nrow</span>(iris)</span></code></pre></div>
<pre><code>## [1] 150</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="base.html#cb327-1"></a><span class="kw">ncol</span>(iris)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="base.html#cb329-1"></a><span class="kw">dim</span>(iris)</span></code></pre></div>
<pre><code>## [1] 150   6</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="base.html#cb331-1"></a>a =<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">18</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb331-2"><a href="base.html#cb331-2"></a><span class="kw">dim</span>(a)</span></code></pre></div>
<pre><code>## [1] 3 3 2</code></pre>
<p><strong>length</strong> ci fornisce il numero di elementi che caratterizzano un vettore, ma si applica a qualsiasi oggetto di R, che come sappiamo è sempre visto da R come una struttura vettoriale.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="base.html#cb333-1"></a><span class="kw">length</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] 150</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="base.html#cb335-1"></a><span class="kw">length</span>(iris)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
</div>
<div id="str" class="section level3">
<h3><span class="header-section-number">4.14.13</span> str</h3>
<p>A parte le dimensioni, è importante conoscere la <em>struttura</em> dei dati, cioè le classi delle colonne del data frame (o di qualsiasi altro oggetto). Vediamo un esempio:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="base.html#cb337-1"></a><span class="kw">str</span>(iris)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  6 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ id          : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<p>Come possiamo vedere, R ci dice le dimensioni ma, ma anche la classe di ogni singola colonna/variabile.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="base.html#cb339-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb339-2"><a href="base.html#cb339-2"></a></span>
<span id="cb339-3"><a href="base.html#cb339-3"></a><span class="kw">str</span>(m)</span></code></pre></div>
<pre><code>##  int [1:3, 1:3] 1 2 3 4 5 6 7 8 9</code></pre>
</div>
<div id="class" class="section level3">
<h3><span class="header-section-number">4.14.14</span> class</h3>
<p>Questa funzione, che abbiamo già incontrato, ci dice a quale classe specifica appartiene un dato oggetto.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="base.html#cb341-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="base.html#cb343-1"></a><span class="kw">class</span>(iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="base.html#cb345-1"></a><span class="kw">class</span>(iris)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
</div>
<div id="unique" class="section level3">
<h3><span class="header-section-number">4.14.15</span> unique</h3>
<p>Questa funzione ci permette di estrarre i valori <strong>univoci</strong> di qualsiasi oggetto, cioè tutti i valori che ricorrono almeno una volta. Vediamo degli esempi:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="base.html#cb347-1"></a><span class="kw">unique</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>##  [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.4 4.8 4.3 5.8 5.7 5.2 5.5 4.5 5.3 7.0 6.4 6.9 6.5
## [20] 6.3 6.6 5.9 6.0 6.1 5.6 6.7 6.2 6.8 7.1 7.6 7.3 7.2 7.7 7.4 7.9</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="base.html#cb349-1"></a><span class="kw">unique</span>(iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## [1] setosa     versicolor virginica 
## Levels: setosa versicolor virginica</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="base.html#cb351-1"></a><span class="kw">unique</span>(iris)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species  id
## 1            5.1         3.5          1.4         0.2     setosa   1
## 2            4.9         3.0          1.4         0.2     setosa   2
## 3            4.7         3.2          1.3         0.2     setosa   3
## 4            4.6         3.1          1.5         0.2     setosa   4
## 5            5.0         3.6          1.4         0.2     setosa   5
## 6            5.4         3.9          1.7         0.4     setosa   6
## 7            4.6         3.4          1.4         0.3     setosa   7
## 8            5.0         3.4          1.5         0.2     setosa   8
## 9            4.4         2.9          1.4         0.2     setosa   9
## 10           4.9         3.1          1.5         0.1     setosa  10
## 11           5.4         3.7          1.5         0.2     setosa  11
## 12           4.8         3.4          1.6         0.2     setosa  12
## 13           4.8         3.0          1.4         0.1     setosa  13
## 14           4.3         3.0          1.1         0.1     setosa  14
## 15           5.8         4.0          1.2         0.2     setosa  15
## 16           5.7         4.4          1.5         0.4     setosa  16
## 17           5.4         3.9          1.3         0.4     setosa  17
## 18           5.1         3.5          1.4         0.3     setosa  18
## 19           5.7         3.8          1.7         0.3     setosa  19
## 20           5.1         3.8          1.5         0.3     setosa  20
## 21           5.4         3.4          1.7         0.2     setosa  21
## 22           5.1         3.7          1.5         0.4     setosa  22
## 23           4.6         3.6          1.0         0.2     setosa  23
## 24           5.1         3.3          1.7         0.5     setosa  24
## 25           4.8         3.4          1.9         0.2     setosa  25
## 26           5.0         3.0          1.6         0.2     setosa  26
## 27           5.0         3.4          1.6         0.4     setosa  27
## 28           5.2         3.5          1.5         0.2     setosa  28
## 29           5.2         3.4          1.4         0.2     setosa  29
## 30           4.7         3.2          1.6         0.2     setosa  30
## 31           4.8         3.1          1.6         0.2     setosa  31
## 32           5.4         3.4          1.5         0.4     setosa  32
## 33           5.2         4.1          1.5         0.1     setosa  33
## 34           5.5         4.2          1.4         0.2     setosa  34
## 35           4.9         3.1          1.5         0.2     setosa  35
## 36           5.0         3.2          1.2         0.2     setosa  36
## 37           5.5         3.5          1.3         0.2     setosa  37
## 38           4.9         3.6          1.4         0.1     setosa  38
## 39           4.4         3.0          1.3         0.2     setosa  39
## 40           5.1         3.4          1.5         0.2     setosa  40
## 41           5.0         3.5          1.3         0.3     setosa  41
## 42           4.5         2.3          1.3         0.3     setosa  42
## 43           4.4         3.2          1.3         0.2     setosa  43
## 44           5.0         3.5          1.6         0.6     setosa  44
## 45           5.1         3.8          1.9         0.4     setosa  45
## 46           4.8         3.0          1.4         0.3     setosa  46
## 47           5.1         3.8          1.6         0.2     setosa  47
## 48           4.6         3.2          1.4         0.2     setosa  48
## 49           5.3         3.7          1.5         0.2     setosa  49
## 50           5.0         3.3          1.4         0.2     setosa  50
## 51           7.0         3.2          4.7         1.4 versicolor  51
## 52           6.4         3.2          4.5         1.5 versicolor  52
## 53           6.9         3.1          4.9         1.5 versicolor  53
## 54           5.5         2.3          4.0         1.3 versicolor  54
## 55           6.5         2.8          4.6         1.5 versicolor  55
## 56           5.7         2.8          4.5         1.3 versicolor  56
## 57           6.3         3.3          4.7         1.6 versicolor  57
## 58           4.9         2.4          3.3         1.0 versicolor  58
## 59           6.6         2.9          4.6         1.3 versicolor  59
## 60           5.2         2.7          3.9         1.4 versicolor  60
## 61           5.0         2.0          3.5         1.0 versicolor  61
## 62           5.9         3.0          4.2         1.5 versicolor  62
## 63           6.0         2.2          4.0         1.0 versicolor  63
## 64           6.1         2.9          4.7         1.4 versicolor  64
## 65           5.6         2.9          3.6         1.3 versicolor  65
## 66           6.7         3.1          4.4         1.4 versicolor  66
## 67           5.6         3.0          4.5         1.5 versicolor  67
## 68           5.8         2.7          4.1         1.0 versicolor  68
## 69           6.2         2.2          4.5         1.5 versicolor  69
## 70           5.6         2.5          3.9         1.1 versicolor  70
## 71           5.9         3.2          4.8         1.8 versicolor  71
## 72           6.1         2.8          4.0         1.3 versicolor  72
## 73           6.3         2.5          4.9         1.5 versicolor  73
## 74           6.1         2.8          4.7         1.2 versicolor  74
## 75           6.4         2.9          4.3         1.3 versicolor  75
## 76           6.6         3.0          4.4         1.4 versicolor  76
## 77           6.8         2.8          4.8         1.4 versicolor  77
## 78           6.7         3.0          5.0         1.7 versicolor  78
## 79           6.0         2.9          4.5         1.5 versicolor  79
## 80           5.7         2.6          3.5         1.0 versicolor  80
## 81           5.5         2.4          3.8         1.1 versicolor  81
## 82           5.5         2.4          3.7         1.0 versicolor  82
## 83           5.8         2.7          3.9         1.2 versicolor  83
## 84           6.0         2.7          5.1         1.6 versicolor  84
## 85           5.4         3.0          4.5         1.5 versicolor  85
## 86           6.0         3.4          4.5         1.6 versicolor  86
## 87           6.7         3.1          4.7         1.5 versicolor  87
## 88           6.3         2.3          4.4         1.3 versicolor  88
## 89           5.6         3.0          4.1         1.3 versicolor  89
## 90           5.5         2.5          4.0         1.3 versicolor  90
## 91           5.5         2.6          4.4         1.2 versicolor  91
## 92           6.1         3.0          4.6         1.4 versicolor  92
## 93           5.8         2.6          4.0         1.2 versicolor  93
## 94           5.0         2.3          3.3         1.0 versicolor  94
## 95           5.6         2.7          4.2         1.3 versicolor  95
## 96           5.7         3.0          4.2         1.2 versicolor  96
## 97           5.7         2.9          4.2         1.3 versicolor  97
## 98           6.2         2.9          4.3         1.3 versicolor  98
## 99           5.1         2.5          3.0         1.1 versicolor  99
## 100          5.7         2.8          4.1         1.3 versicolor 100
## 101          6.3         3.3          6.0         2.5  virginica 101
## 102          5.8         2.7          5.1         1.9  virginica 102
## 103          7.1         3.0          5.9         2.1  virginica 103
## 104          6.3         2.9          5.6         1.8  virginica 104
## 105          6.5         3.0          5.8         2.2  virginica 105
## 106          7.6         3.0          6.6         2.1  virginica 106
## 107          4.9         2.5          4.5         1.7  virginica 107
## 108          7.3         2.9          6.3         1.8  virginica 108
## 109          6.7         2.5          5.8         1.8  virginica 109
## 110          7.2         3.6          6.1         2.5  virginica 110
## 111          6.5         3.2          5.1         2.0  virginica 111
## 112          6.4         2.7          5.3         1.9  virginica 112
## 113          6.8         3.0          5.5         2.1  virginica 113
## 114          5.7         2.5          5.0         2.0  virginica 114
## 115          5.8         2.8          5.1         2.4  virginica 115
## 116          6.4         3.2          5.3         2.3  virginica 116
## 117          6.5         3.0          5.5         1.8  virginica 117
## 118          7.7         3.8          6.7         2.2  virginica 118
## 119          7.7         2.6          6.9         2.3  virginica 119
## 120          6.0         2.2          5.0         1.5  virginica 120
## 121          6.9         3.2          5.7         2.3  virginica 121
## 122          5.6         2.8          4.9         2.0  virginica 122
## 123          7.7         2.8          6.7         2.0  virginica 123
## 124          6.3         2.7          4.9         1.8  virginica 124
## 125          6.7         3.3          5.7         2.1  virginica 125
## 126          7.2         3.2          6.0         1.8  virginica 126
## 127          6.2         2.8          4.8         1.8  virginica 127
## 128          6.1         3.0          4.9         1.8  virginica 128
## 129          6.4         2.8          5.6         2.1  virginica 129
## 130          7.2         3.0          5.8         1.6  virginica 130
## 131          7.4         2.8          6.1         1.9  virginica 131
## 132          7.9         3.8          6.4         2.0  virginica 132
## 133          6.4         2.8          5.6         2.2  virginica 133
## 134          6.3         2.8          5.1         1.5  virginica 134
## 135          6.1         2.6          5.6         1.4  virginica 135
## 136          7.7         3.0          6.1         2.3  virginica 136
## 137          6.3         3.4          5.6         2.4  virginica 137
## 138          6.4         3.1          5.5         1.8  virginica 138
## 139          6.0         3.0          4.8         1.8  virginica 139
## 140          6.9         3.1          5.4         2.1  virginica 140
## 141          6.7         3.1          5.6         2.4  virginica 141
## 142          6.9         3.1          5.1         2.3  virginica 142
## 143          5.8         2.7          5.1         1.9  virginica 143
## 144          6.8         3.2          5.9         2.3  virginica 144
## 145          6.7         3.3          5.7         2.5  virginica 145
## 146          6.7         3.0          5.2         2.3  virginica 146
## 147          6.3         2.5          5.0         1.9  virginica 147
## 148          6.5         3.0          5.2         2.0  virginica 148
## 149          6.2         3.4          5.4         2.3  virginica 149
## 150          5.9         3.0          5.1         1.8  virginica 150</code></pre>
<p>Nell’ultimo esempio abbiamo usato la funzione <strong>unique</strong> sull’intero data frame. R non ha fatto altro che interpretare le righe (cioè le osservazioni) come unità costitutive del data frame e quindi ha restituito un oggetto con struttura analoga al data frame di partenza ma aventi un numero di righe inferiore se ci fossero individui (righe) perfettamente uguali, cosa che per iris non succede. Ma proviamo a truccare i dati e usiamo <strong>dim</strong> per vedere cosa succede.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="base.html#cb353-1"></a><span class="kw">dim</span>(iris)</span></code></pre></div>
<pre><code>## [1] 150   6</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="base.html#cb355-1"></a><span class="kw">dim</span>(<span class="kw">unique</span>(iris))</span></code></pre></div>
<pre><code>## [1] 150   6</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="base.html#cb357-1"></a>iris[<span class="dv">2</span>,] =<span class="st"> </span>iris[<span class="dv">5</span>,]</span>
<span id="cb357-2"><a href="base.html#cb357-2"></a></span>
<span id="cb357-3"><a href="base.html#cb357-3"></a><span class="kw">dim</span>(<span class="kw">unique</span>(iris))</span></code></pre></div>
<pre><code>## [1] 149   6</code></pre>
<p>Abbiamo sovrascritto la seconda riga di iris ponendola uguale alla quinta, e infatti adesso il numero di righe univoche è 149.</p>
</div>
<div id="table" class="section level3">
<h3><span class="header-section-number">4.14.16</span> table</h3>
<p>Continuando ad approfondire, potremmo volevo capire quale è il numero di osservazioni per ciascuna combinazione di variabili. Nel caso di <em>iris</em>, abbiamo visto come usare <strong>unique</strong> per capire, ad esempio, quali specie del genere iris sono contenute nel data frame.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="base.html#cb359-1"></a><span class="kw">unique</span>(iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## [1] setosa     versicolor virginica 
## Levels: setosa versicolor virginica</code></pre>
<p>Adesso, vediamo come <strong>table</strong> ci fornisce il numero di occorrenze per ogni specie.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="base.html#cb361-1"></a><span class="kw">table</span>(iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50</code></pre>
<p>Gli oggetti che restituisce questa funzione sono delle <strong>tabelle</strong> che corrispondono a vettori nel caso in cui siano stati generati da un vettore (una singola variabile).</p>
<p>Quella dell’esempio è una <strong>tabella di contingenza</strong> per la variabile specie, ma possiamo ottenere tabella combinando più variabili, dandole come argomento a <strong>table</strong> e separandolo, come sempre, con le virgole.
Vediamo un esempio intuitivo.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="base.html#cb363-1"></a>iris<span class="op">$</span>color =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dv">75</span>),</span>
<span id="cb363-2"><a href="base.html#cb363-2"></a>                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span>
<span id="cb363-3"><a href="base.html#cb363-3"></a>  </span>
<span id="cb363-4"><a href="base.html#cb363-4"></a><span class="kw">table</span>(iris<span class="op">$</span>color, iris<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>##       
##        setosa versicolor virginica
##   red      25         25        25
##   blue     25         25        25</code></pre>
<p>In questo caso abbiamo generato una nuova colonna di iris, chiamata <strong>color</strong>, e contenente valori casuali di rosso e di blu.</p>
</div>
<div id="rev-sort-e-order" class="section level3">
<h3><span class="header-section-number">4.14.17</span> rev, sort e order</h3>
<p><strong>rev</strong> è una funzione di semplicissimo utilizzo ci permette di <em>rovesciare</em> dei vettori.
Ad esempio:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="base.html#cb365-1"></a>x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb365-2"><a href="base.html#cb365-2"></a><span class="kw">rev</span>(x)</span></code></pre></div>
<pre><code>##  [1] 10  9  8  7  6  5  4  3  2  1</code></pre>
<p><strong>sort</strong> ci permette, invece, di <em>ordinare</em> un vettore rispetto ai valori dei suoi elementi. Ha un’opzione, <strong>decreasing</strong>, che ci consente di scegliere tra ordine <em>crescente</em>, impostato come default, e <em>decrescente</em>.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="base.html#cb367-1"></a>x =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb367-2"><a href="base.html#cb367-2"></a></span>
<span id="cb367-3"><a href="base.html#cb367-3"></a><span class="kw">sort</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1 21 34 42 48 54 70 93 94 98</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="base.html#cb369-1"></a><span class="kw">sort</span>(x, <span class="dt">decreasing =</span> T)</span></code></pre></div>
<pre><code>##  [1] 98 94 93 70 54 48 42 34 21  1</code></pre>
<p><strong>order</strong>, infine, ci permette di estrarre gli indici di posizione ordinati degli elementi di un oggetto.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="base.html#cb371-1"></a>x =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb371-2"><a href="base.html#cb371-2"></a></span>
<span id="cb371-3"><a href="base.html#cb371-3"></a>x</span></code></pre></div>
<pre><code>##  [1] 51 69 90 35 72 79 11 76 13 43</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="base.html#cb373-1"></a><span class="kw">sort</span>(x)</span></code></pre></div>
<pre><code>##  [1] 11 13 35 43 51 69 72 76 79 90</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="base.html#cb375-1"></a><span class="kw">order</span>(x)</span></code></pre></div>
<pre><code>##  [1]  7  9  4 10  1  2  5  8  6  3</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="base.html#cb377-1"></a><span class="kw">order</span>(x, <span class="dt">decreasing =</span> T)</span></code></pre></div>
<pre><code>##  [1]  3  6  8  5  2  1 10  4  9  7</code></pre>
<p>Passiamo ora a un gruppo di funzione utili per combinare tra loro diversi oggetti.</p>
</div>
<div id="sample" class="section level3">
<h3><span class="header-section-number">4.14.18</span> sample</h3>
<p>Più che per la combinazione, <strong>sample</strong> serve per la ri-combinazione: mediante questa funzione è possibile generare un nuovo vettore <em>campionando</em> (<em>sampling</em>) gli elementi di un altro vettore. Gli argomenti da fornire a questa funzione sono:</p>
<ol style="list-style-type: decimal">
<li><strong>x</strong>, cioè l’insieme dei dati da cui estrarre i valori campionati. Generalmente è un vettore numerico ma può essere anche di altro tipo</li>
<li><strong>size</strong>, cioè il numero di osservazioni che vogliamo estrarre. Qui può nascere un problema. Di <em>default</em>, <strong>sample</strong> si comporta come il croupier nella tombola: ogni elemento estratto da <strong>x</strong> viene rimosso da <strong>x</strong>, per cui <strong>x</strong> non può contenere un numero di elementi minore del valore di <strong>size</strong>…. a meno che….</li>
<li><strong>replace</strong> (o <strong>rep</strong>) è l’opzione che, se impostata come TRUE, autorizza R a ricampionare gli stessi elementi di <strong>x</strong>, senza rimuovere i valori estratti</li>
<li>Sempre per <em>default</em>, la funzione <strong>sample</strong> estrae “a caso”gli elementi di <strong>x</strong> assegnando a ciascuno di essi la stessa probabilità di estrazione. Mediante l’argomento <strong>prob</strong> è possibile però indicare a R un valori di probabilità per ogni elemento di <strong>x</strong>.</li>
</ol>
<p>Esaminiamo alcuni esempi:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="base.html#cb379-1"></a>x =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb379-2"><a href="base.html#cb379-2"></a>y =<span class="st"> </span><span class="kw">sample</span>(x, <span class="dv">3</span>)</span>
<span id="cb379-3"><a href="base.html#cb379-3"></a>y</span></code></pre></div>
<pre><code>## [1] 4 6 2</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="base.html#cb381-1"></a>y =<span class="st"> </span><span class="kw">sample</span>(x, <span class="dv">20</span>, <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb381-2"><a href="base.html#cb381-2"></a>y</span></code></pre></div>
<pre><code>##  [1]  2  6  9 10  7 10  9 10 10  2  1 10  9  9  6  3  7  1  5  3</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="base.html#cb383-1"></a>y =<span class="st"> </span><span class="kw">sample</span>(x, <span class="dv">30</span>, <span class="dt">rep =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="fl">0.1</span>, <span class="dv">9</span>)))</span>
<span id="cb383-2"><a href="base.html#cb383-2"></a>y</span></code></pre></div>
<pre><code>##  [1]  1  1  1  1  5  1  1  2  5  1  1  3  3  1  1  5  1  1 10  1  1  4  1  6  1
## [26]  1  1  1  4  8</code></pre>
<p>Dunque, nei primi due esempi abbiamo visto come usare l’opzione <strong>rep</strong>, nell’ultimo esempio possiamo notare come le probabilità di estrazione, fortemente sbilanciate a favore del valore 1, si riflettono sulla composizione del campione estratto.</p>
</div>
<div id="cbind-e-rbind" class="section level3">
<h3><span class="header-section-number">4.14.19</span> cbind e rbind</h3>
<p>Queste due funzioni ci consentono di “incollare” insieme vettori, matrici o data frame. In particolare <strong>cbind</strong> (column bind) permette di incollare colonne, mentre <strong>rbind</strong> permette di incollare righe. Il vincolo principale di queste operazioni è legato alla coerenza della geometria, degli attributi e anche dei nomi. Ad esempio, posso incollare insieme righe di due data frame se esse sono omogenee rispetto alle colonne</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="base.html#cb385-1"></a><span class="kw">data</span>(iris)</span>
<span id="cb385-2"><a href="base.html#cb385-2"></a>small_iris =<span class="st"> </span><span class="kw">rbind</span>(iris[<span class="dv">1</span>,], iris[<span class="dv">51</span>,], iris[<span class="dv">150</span>,])</span>
<span id="cb385-3"><a href="base.html#cb385-3"></a>small_iris</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            5.1         3.5          1.4         0.2     setosa
## 51           7.0         3.2          4.7         1.4 versicolor
## 150          5.9         3.0          5.1         1.8  virginica</code></pre>
</div>
<div id="which" class="section level3">
<h3><span class="header-section-number">4.14.20</span> which</h3>
<p>Abbiamo già parlato di questa funzione in precedenza (Sezione 4.12 a proposito dell’Algebra di Boole).</p>
</div>
<div id="match" class="section level3">
<h3><span class="header-section-number">4.14.21</span> match</h3>
<p>Si tratta di una funzione molto utile per associare vettori diversi. Nello specifico, <strong>match</strong> individua tutti gli elementi del vettore <strong>x</strong> (primo argomento) che corrispondono a elementi del vettore <strong>table</strong> (secondo argomento). Vediamo due esempi</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="base.html#cb387-1"></a>v1 =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;A&quot;</span>)</span>
<span id="cb387-2"><a href="base.html#cb387-2"></a>v2 =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb387-3"><a href="base.html#cb387-3"></a></span>
<span id="cb387-4"><a href="base.html#cb387-4"></a><span class="kw">match</span>(<span class="dt">x =</span> v1, <span class="dt">table =</span> v2)</span></code></pre></div>
<pre><code>## [1] 1 2 2 3 1</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="base.html#cb389-1"></a><span class="kw">match</span>(<span class="dt">x =</span> v2, <span class="dt">table =</span> v1)</span></code></pre></div>
<pre><code>## [1]  1  2  4 NA NA NA NA</code></pre>
<p>Abbiamo generato due vettori, <em>v1</em> e <em>v2</em>, il primo dei quali contiene meno valori univoci e alcune duplicazioni rispetto al secondo.
Quando abbiamo confrontato il primo vettore usando come riferimento (<strong>table</strong>) il secondo, otteniamo dei valori numerici che altro non sono se non gli indici di posizione degli elementi di <em>v1</em> rispetto a <em>v2</em>. Viceversa, abbiamo ottenuto 3 valori numerici e 4 NA poichè gli ultimi 4 elementi di <em>v2</em> non hanno riscontro in <em>v1</em>.</p>
</div>
<div id="intersect-setdiff-e-union" class="section level3">
<h3><span class="header-section-number">4.14.22</span> intersect, setdiff, e union</h3>
<p>Con questa triade di funzioni facciamo capolino nel salotto di <strong>George Boole</strong>. Come suggeriscono i loro nomi, <strong>intersect</strong> serve a fare intersezioni, <strong>union</strong> a fare unioni e <strong>setdiff</strong> calcolare la differenza simmetrica (insieme complementare).
Ad esempio:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="base.html#cb391-1"></a>v1 =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;H&quot;</span>)</span>
<span id="cb391-2"><a href="base.html#cb391-2"></a>v2 =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb391-3"><a href="base.html#cb391-3"></a></span>
<span id="cb391-4"><a href="base.html#cb391-4"></a><span class="kw">intersect</span>(v1, v2)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot;</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="base.html#cb393-1"></a><span class="kw">union</span>(v1, v2)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;H&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot;</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="base.html#cb395-1"></a><span class="kw">setdiff</span>(v1, v2)</span></code></pre></div>
<pre><code>## [1] &quot;H&quot;</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="base.html#cb397-1"></a><span class="kw">setdiff</span>(v2, v1)</span></code></pre></div>
<pre><code>## [1] &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot;</code></pre>
<p>I primi due esempi sono immediati. Gli altri due meritano di essere guardati meglio: a seconda dell’ordine con cui forniamo gli argomenti otteniamo delle differenze simmetriche diverse. In particolare, otteniamo gli elementi del primo insieme che non sono comuni al secondo.
Il limite di queste funzioni è che sono tutte capaci di operare solo su 2 argomenti alla volta.</p>
</div>
<div id="merge" class="section level3">
<h3><span class="header-section-number">4.14.23</span> merge</h3>
<p>Chiunque abbiamo “risistemato” dei dati con un foglio di calcolo tipo excel sa bene come va a finire quando dobbiamo appaiare degli insiemi di dati che “si parlano” tra loro mediante una o più colonne ma differiscono per altre. Un gran pasticcio, che diventa ingestibile quando i dataset sono grandi e articolati.
La funzione <strong>merge</strong> serve proprio per fondere due data frame che abbiano in comune delle colonne (usate come riferimento).
Ad esempio:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="base.html#cb399-1"></a><span class="kw">data</span>(iris)</span>
<span id="cb399-2"><a href="base.html#cb399-2"></a>iris<span class="op">$</span>id =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">150</span></span>
<span id="cb399-3"><a href="base.html#cb399-3"></a></span>
<span id="cb399-4"><a href="base.html#cb399-4"></a>iris_c =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">150</span>,<span class="dv">150</span>),</span>
<span id="cb399-5"><a href="base.html#cb399-5"></a>                    <span class="dt">color =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dv">75</span>),</span>
<span id="cb399-6"><a href="base.html#cb399-6"></a>                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)))</span>
<span id="cb399-7"><a href="base.html#cb399-7"></a></span>
<span id="cb399-8"><a href="base.html#cb399-8"></a><span class="kw">head</span>(iris_c)</span></code></pre></div>
<pre><code>##    id color
## 1 122   red
## 2  35  blue
## 3  18   red
## 4  57  blue
## 5  40   red
## 6  13  blue</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="base.html#cb401-1"></a>iris_full =<span class="st"> </span><span class="kw">merge</span>(iris, iris_c)</span>
<span id="cb401-2"><a href="base.html#cb401-2"></a></span>
<span id="cb401-3"><a href="base.html#cb401-3"></a><span class="kw">head</span>(iris_full)</span></code></pre></div>
<pre><code>##   id Sepal.Length Sepal.Width Petal.Length Petal.Width Species color
## 1  1          5.1         3.5          1.4         0.2  setosa   red
## 2  2          4.9         3.0          1.4         0.2  setosa   red
## 3  3          4.7         3.2          1.3         0.2  setosa  blue
## 4  4          4.6         3.1          1.5         0.2  setosa   red
## 5  5          5.0         3.6          1.4         0.2  setosa   red
## 6  6          5.4         3.9          1.7         0.4  setosa  blue</code></pre>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">4.14.24</span> apply</h3>
<p>Il prossimo gruppo da esaminare è quello delle funzioni statistiche di base.</p>
</div>
<div id="min-max-range" class="section level3">
<h3><span class="header-section-number">4.14.25</span> min, max, range</h3>
</div>
<div id="summary" class="section level3">
<h3><span class="header-section-number">4.14.26</span> summary</h3>
</div>
<div id="cumsum" class="section level3">
<h3><span class="header-section-number">4.14.27</span> cumsum</h3>
</div>
<div id="median" class="section level3">
<h3><span class="header-section-number">4.14.28</span> median</h3>
</div>
<div id="quantile" class="section level3">
<h3><span class="header-section-number">4.14.29</span> quantile</h3>
</div>
<div id="mean" class="section level3">
<h3><span class="header-section-number">4.14.30</span> mean</h3>
</div>
<div id="sd" class="section level3">
<h3><span class="header-section-number">4.14.31</span> sd</h3>
</div>
<div id="runif" class="section level3">
<h3><span class="header-section-number">4.14.32</span> runif</h3>
</div>
<div id="rnorm" class="section level3">
<h3><span class="header-section-number">4.14.33</span> rnorm</h3>
</div>
<div id="weighted.mean" class="section level3">
<h3><span class="header-section-number">4.14.34</span> weighted.mean</h3>
</div>
<div id="read.table" class="section level3">
<h3><span class="header-section-number">4.14.35</span> read.table</h3>
</div>
<div id="write.table" class="section level3">
<h3><span class="header-section-number">4.14.36</span> write.table</h3>
</div>
<div id="read.csv" class="section level3">
<h3><span class="header-section-number">4.14.37</span> read.csv</h3>
</div>
<div id="write.csv" class="section level3">
<h3><span class="header-section-number">4.14.38</span> write.csv</h3>
</div>
<div id="readrds" class="section level3">
<h3><span class="header-section-number">4.14.39</span> readRDS</h3>
</div>
<div id="saverds" class="section level3">
<h3><span class="header-section-number">4.14.40</span> saveRDS</h3>
</div>
<div id="jpeg-bmp-png-tiff" class="section level3">
<h3><span class="header-section-number">4.14.41</span> jpeg, bmp, png, tiff</h3>
<p><img src="Images/01-14.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Autori.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gen.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Libro_MIR.pdf", "Libro_MIR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
